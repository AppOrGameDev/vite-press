var vr=Object.defineProperty;var Br=(s,t,e)=>t in s?vr(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var n=(s,t,e)=>(Br(s,typeof t!="symbol"?t+"":t,e),e);import{j as ie,b as Gt,e as Ke,k as nt,l as ot,c as ti,h as Es,A as br,B as F,I as de,n as rt,u as A,q as ae,E as gi,a8 as As,D as Pr,F as ci,Q as wr,T as Tr,J as di,_ as Pe,a9 as Ir,x as mi,s as Fs,a0 as Vr,aa as we,ab as Ds,O as Xe,ac as Rr,ad as Lr,ae as Er,af as Ar,ag as Fr,ah as Dr,ai as kr,aj as zr,ak as Nr,al as Or,L as Ur,am as jr,an as Yr,ao as Xr}from"./chunks/framework.80c433a6.js";import{u as Hr}from"./chunks/useObserver.0f160736.js";import{u as Gr}from"./chunks/useNamespace.75a6a06b.js";import{t as _i}from"./chunks/theme.80bfc8c6.js";const Wr=["data-src"],qr="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjgzMzY1OTQ3ODcwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI5NTkiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTAgMGgxMDI0djEwMjRIMHoiIGZpbGw9IiNGNkY2RjYiIHAtaWQ9IjI5NjAiPjwvcGF0aD48cGF0aCBkPSJNNjk1Ljc2MjI4NiAxOTkuOTI2ODU3Yzc1LjQwMTE0MyAwIDEzNi41MzAyODYgNjEuMTI5MTQzIDEzNi41MzAyODUgMTM2LjUzMDI4NnYzNTEuMDg1NzE0YzAgNzUuNDAxMTQzLTYxLjEyOTE0MyAxMzYuNTMwMjg2LTEzNi41MzAyODUgMTM2LjUzMDI4NmgtMzUxLjA4NTcxNWMtNzUuNDEwMjg2IDAtMTM2LjUzMDI4Ni02MS4xMjkxNDMtMTM2LjUzMDI4NS0xMzYuNTMwMjg2VjMzNi40NTcxNDNjMC03NS40MDExNDMgNjEuMTItMTM2LjUzMDI4NiAxMzYuNTMwMjg1LTEzNi41MzAyODZ6TTI0Ny4xNDk3MTQgNDMxLjEwNFY2ODcuNTQyODU3YzAgNTMuODYwNTcxIDQzLjY2NjI4NiA5Ny41MjY4NTcgOTcuNTI2ODU3IDk3LjUyNjg1N2gyMzguNDM2NTcyQzU3My42NDExNDMgNjAwLjQxMTQyOSA0MzAuNDY0IDQ1MC4wMDIyODYgMjQ3LjE0OTcxNCA0MzEuMTA0ek02OTUuNzcxNDI5IDIzOC45MzAyODZoLTM1MS4wODU3MTVjLTUzLjg2MDU3MSAwLTk3LjUyNjg1NyA0My42NjYyODYtOTcuNTI2ODU3IDk3LjUyNjg1N3Y2NS4yNDM0MjhjMTk5LjU3MDI4NiAxOS4wODExNDMgMzU1LjcwMjg1NyAxODIuNjI4NTcxIDM2NS4yNTcxNDMgMzgzLjM2aDgzLjM1NTQyOWM1My44NTE0MjkgMCA5Ny41MjY4NTctNDMuNjU3MTQzIDk3LjUyNjg1Ny05Ny41MTc3MTRWNTg1LjE0Mjg1N2MtNTUuMzg3NDI5LTUyLjgtMTQzLjEwNC01Mi4wMDQ1NzEtMTk3LjUyMjI4NiAyLjQwNDU3MmExNC42Mjg1NzEgMTQuNjI4NTcxIDAgMSAxLTIwLjY4MTE0My0yMC42ODExNDNjNTkuMzgyODU3LTU5LjM5MiAxNTEuNjUyNTcxLTY1Ljg2NTE0MyAyMTguMjAzNDI5LTE5LjQxOTQyOVYzMzYuNDU3MTQzYzAtNTMuODYwNTcxLTQzLjY2NjI4Ni05Ny41MjY4NTctOTcuNTI2ODU3LTk3LjUyNjg1N3ogbS01OC41MTQyODYgNjguMjY5NzE0YTQ4Ljc1ODg1NyA0OC43NTg4NTcgMCAxIDEgMCA5Ny41MjY4NTcgNDguNzU4ODU3IDQ4Ljc1ODg1NyAwIDAgMSAwLTk3LjUyNjg1N3ogbTAgMTkuNTAxNzE0YTI5LjI1NzE0MyAyOS4yNTcxNDMgMCAxIDAgMCA1OC41MTQyODYgMjkuMjU3MTQzIDI5LjI1NzE0MyAwIDAgMCAwLTU4LjUxNDI4NnoiIGZpbGw9IiNEMEQwRDAiIHAtaWQ9IjI5NjEiPjwvcGF0aD48L3N2Zz4=",He=ie({__name:"ImageLazyLoad",props:{src:{}},setup(s){const t=Gt(null);return Ke(()=>{const e=Hr();t.value&&(e==null||e.observe(t.value))}),(e,i)=>(nt(),ot("img",{ref_key:"imgRef",ref:t,"data-src":e.src,src:qr,alt:""},null,8,Wr))}}),$r=({src:s,filename:t})=>{const e=document.createElement("a");e.download=t??`vite-press_${Date.now()}.${s.split(".").pop()}`,e.setAttribute("href",s),e.setAttribute("style","display: none;"),document.body.appendChild(e),e.click(),document.body.removeChild(e)},Zr={mounted(s,{value:t}){s.addEventListener("click",()=>$r(t))}},K={close:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M556.8 512L832 236.8c12.8-12.8 12.8-32 0-44.8-12.8-12.8-32-12.8-44.8 0L512 467.2l-275.2-277.333333c-12.8-12.8-32-12.8-44.8 0-12.8 12.8-12.8 32 0 44.8l275.2 277.333333-277.333333 275.2c-12.8 12.8-12.8 32 0 44.8 6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333L512 556.8 787.2 832c6.4 6.4 14.933333 8.533333 23.466667 8.533333s17.066667-2.133333 23.466666-8.533333c12.8-12.8 12.8-32 0-44.8L556.8 512z" fill="currentColor"></path></svg>',left:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M384 512L731.733333 202.666667c17.066667-14.933333 19.2-42.666667 4.266667-59.733334-14.933333-17.066667-42.666667-19.2-59.733333-4.266666l-384 341.333333c-10.666667 8.533333-14.933333 19.2-14.933334 32s4.266667 23.466667 14.933334 32l384 341.333333c8.533333 6.4 19.2 10.666667 27.733333 10.666667 12.8 0 23.466667-4.266667 32-14.933333 14.933333-17.066667 14.933333-44.8-4.266667-59.733334L384 512z" fill="currentColor"></path></svg>',right:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M731.733333 480l-384-341.333333c-17.066667-14.933333-44.8-14.933333-59.733333 4.266666-14.933333 17.066667-14.933333 44.8 4.266667 59.733334L640 512 292.266667 821.333333c-17.066667 14.933333-19.2 42.666667-4.266667 59.733334 8.533333 8.533333 19.2 14.933333 32 14.933333 10.666667 0 19.2-4.266667 27.733333-10.666667l384-341.333333c8.533333-8.533333 14.933333-19.2 14.933334-32s-4.266667-23.466667-14.933334-32z" fill="currentColor"></path></svg>',zoomOut:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M945.066667 898.133333l-189.866667-189.866666c55.466667-64 87.466667-149.333333 87.466667-241.066667 0-204.8-168.533333-373.333333-373.333334-373.333333S96 264.533333 96 469.333333 264.533333 842.666667 469.333333 842.666667c91.733333 0 174.933333-34.133333 241.066667-87.466667l189.866667 189.866667c6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333c8.533333-12.8 8.533333-34.133333-2.133333-46.933334zM469.333333 778.666667C298.666667 778.666667 160 640 160 469.333333S298.666667 160 469.333333 160 778.666667 298.666667 778.666667 469.333333 640 778.666667 469.333333 778.666667z" fill="currentColor"></path><path d="M597.333333 437.333333H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h256c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z" fill="currentColor"></path></svg>',zoomIn:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M945.066667 898.133333l-189.866667-189.866666c55.466667-64 87.466667-149.333333 87.466667-241.066667 0-204.8-168.533333-373.333333-373.333334-373.333333S96 264.533333 96 469.333333 264.533333 842.666667 469.333333 842.666667c91.733333 0 174.933333-34.133333 241.066667-87.466667l189.866667 189.866667c6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333c8.533333-12.8 8.533333-34.133333-2.133333-46.933334zM469.333333 778.666667C298.666667 778.666667 160 640 160 469.333333S298.666667 160 469.333333 160 778.666667 298.666667 778.666667 469.333333 640 778.666667 469.333333 778.666667z" fill="currentColor"></path><path d="M597.333333 437.333333h-96V341.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v96H341.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h96V597.333333c0 17.066667 14.933333 32 32 32s32-14.933333 32-32v-96H597.333333c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z" fill="currentColor"></path></svg>',reset:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M149.333333 394.666667c17.066667 0 32-14.933333 32-32v-136.533334l187.733334 187.733334c6.4 6.4 14.933333 8.533333 23.466666 8.533333s17.066667-2.133333 23.466667-8.533333c12.8-12.8 12.8-32 0-44.8l-187.733333-187.733334H362.666667c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32H149.333333c-4.266667 0-8.533333 0-10.666666 2.133334-8.533333 4.266667-14.933333 10.666667-19.2 17.066666-2.133333 4.266667-2.133333 8.533333-2.133334 12.8v213.333334c0 17.066667 14.933333 32 32 32zM874.666667 629.333333c-17.066667 0-32 14.933333-32 32v136.533334L642.133333 597.333333c-12.8-12.8-32-12.8-44.8 0s-12.8 32 0 44.8l200.533334 200.533334H661.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h213.333334c4.266667 0 8.533333 0 10.666666-2.133334 8.533333-4.266667 14.933333-8.533333 17.066667-17.066666 2.133333-4.266667 2.133333-8.533333 2.133333-10.666667V661.333333c2.133333-17.066667-12.8-32-29.866666-32zM381.866667 595.2l-200.533334 200.533333V661.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v213.333334c0 4.266667 0 8.533333 2.133334 10.666666 4.266667 8.533333 8.533333 14.933333 17.066666 17.066667 4.266667 2.133333 8.533333 2.133333 10.666667 2.133333h213.333333c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32h-136.533333l200.533333-200.533333c12.8-12.8 12.8-32 0-44.8s-29.866667-10.666667-42.666666 0zM904.533333 138.666667c0-2.133333 0-2.133333 0 0-4.266667-8.533333-10.666667-14.933333-17.066666-17.066667-4.266667-2.133333-8.533333-2.133333-10.666667-2.133333H661.333333c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h136.533334l-187.733334 187.733333c-12.8 12.8-12.8 32 0 44.8 6.4 6.4 14.933333 8.533333 23.466667 8.533333s17.066667-2.133333 23.466667-8.533333l187.733333-187.733333V362.666667c0 17.066667 14.933333 32 32 32s32-14.933333 32-32V149.333333c-2.133333-4.266667-2.133333-8.533333-4.266667-10.666666z" fill="currentColor"></path></svg>',rotate:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M992 158.912V371.2a12.8 12.8 0 0 1-12.8 12.8h-212.288a12.8 12.8 0 0 1-9.088-21.824L970.24 149.76a12.8 12.8 0 0 1 21.824 9.088z" fill="currentColor"></path><path d="M926.912 270.464A480 480 0 0 0 32 512a32 32 0 0 0 64 0 416 416 0 0 1 775.616-209.28 32 32 0 0 0 55.296-32.256zM44.48 621.312c5.248 22.4 12.032 44.224 20.352 65.536a32 32 0 1 0 59.584-23.36 412.544 412.544 0 0 1-17.6-56.704 32 32 0 0 0-62.336 14.528z m88.832 185.6c14.08 18.048 29.44 35.072 45.888 50.944a32 32 0 1 0 44.352-46.08 418.56 418.56 0 0 1-39.808-44.16 32 32 0 1 0-50.432 39.36z m158.08 131.52c20.352 10.496 41.408 19.584 63.04 27.136a32 32 0 0 0 21.056-60.48 413.376 413.376 0 0 1-54.592-23.488 32 32 0 0 0-29.44 56.832z m205.184 53.312l14.592 0.256c18.816 0 36.8-0.96 54.656-3.008a32 32 0 1 0-7.04-63.616c-10.368 1.216-20.8 1.92-31.36 2.368l-16.192 0.256-12.672-0.192a32 32 0 1 0-1.984 64z m202.752-37.696c21.12-8.96 41.472-19.392 61.056-31.232a32 32 0 1 0-33.152-54.72c-16.96 10.24-34.624 19.328-52.928 27.072a32 32 0 0 0 24.96 58.88z" fill="currentColor"></path><path d="M370.368 384c-32.64 0-59.712 9.92-81.792 30.208-22.016 19.84-32.576 44.8-32.576 75.904 0 30.144 9.152 54.72 28.032 73.728 19.264 19.392 45.44 29.312 77.568 29.312 17.024 0 32.128-3.456 45.44-9.472 13.824-6.912 25.728-16.832 34.944-30.208h1.856l0.448 5.632c0 29.76-6.912 54.784-19.776 74.624-13.76 20.672-31.68 31.488-54.144 31.488-33.088 0-53.312-15.104-59.712-44.864h-48.64c8.192 55.616 44.032 83.648 107.84 83.648 37.696 0 67.52-16 90.048-47.04 21.568-31.04 32.64-71.552 32.64-121.6 0-47.424-10.624-84.096-30.848-110.4C440.576 397.44 410.304 384 370.368 384z m1.792 38.784c19.328 0 35.392 6.08 47.744 18.112 11.968 11.648 18.368 27.648 18.368 47.872 0 19.84-5.952 36.288-17.92 48.32-11.904 12.096-28.416 18.112-48.64 18.112-20.672 0-36.736-6.016-48.192-18.112-12.416-11.648-18.368-27.136-18.368-46.976s5.952-35.84 18.368-48.32c11.904-12.928 28.48-19.008 48.64-19.008zM649.6 384c-38.592 0-68.48 15.104-89.6 45.696-19.2 28.032-28.864 65.984-28.864 114.304 0 47.872 9.6 85.824 28.928 114.304 21.12 30.144 50.944 45.696 89.536 45.696s68.416-15.552 89.536-45.696C758.336 629.76 768 591.36 768 544c0-47.872-9.6-85.824-28.928-114.304-21.12-30.592-50.944-45.696-89.6-45.696z m0 39.68c26.624 0 45.888 13.824 56.96 41.856 7.808 18.944 11.904 45.248 11.904 78.464 0 32.768-4.096 59.072-11.904 78.464-11.072 27.648-30.336 41.856-56.96 41.856-27.072 0-45.952-14.208-56.96-41.856-8.256-19.392-11.904-45.696-11.904-78.464 0-33.216 3.648-59.52 11.904-78.464 11.008-28.032 29.888-41.856 56.96-41.856z" fill="currentColor"></path></svg>',best:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M970.837333 919.850667l-205.696-205.653334A382.421333 382.421333 0 0 0 853.333333 469.333333a384 384 0 0 0-384-384 384 384 0 0 0-384 384 384 384 0 0 0 384 384 382.421333 382.421333 0 0 0 244.906667-88.192l205.653333 205.653334a36.053333 36.053333 0 0 0 50.986667 0 36.266667 36.266667 0 0 0-0.042667-50.944z m-380.117333-162.986667c-38.4 16.256-79.189333 24.448-121.386667 24.448a311.296 311.296 0 0 1-220.586666-91.392A311.296 311.296 0 0 1 157.312 469.333333 311.296 311.296 0 0 1 248.746667 248.746667 311.296 311.296 0 0 1 469.333333 157.354667a311.296 311.296 0 0 1 220.586667 91.392A311.296 311.296 0 0 1 781.354667 469.333333a311.296 311.296 0 0 1-91.392 220.586667 310.186667 310.186667 0 0 1-99.242667 66.901333z" fill="currentColor"></path><path d="M280.490667 597.333333v-35.541333h47.488V422.016h-40.021334v-27.178667c22.101333-4.181333 37.333333-9.856 51.370667-18.517333h32.554667v185.472h41.514666V597.333333H280.490667z m199.808-109.312c-15.530667 0-27.178667-12.245333-27.178667-28.373333 0-16.426667 11.648-28.672 27.178667-28.672 15.829333 0 27.477333 12.245333 27.477333 28.672 0 16.128-11.648 28.373333-27.477333 28.373333z m0 113.493334c-15.530667 0-27.178667-12.544-27.178667-28.672 0-16.128 11.648-28.672 27.178667-28.672 15.829333 0 27.477333 12.544 27.477333 28.672 0 16.128-11.648 28.672-27.477333 28.672zM553.472 597.333333v-35.541333h47.488V422.016h-40.021333v-27.178667c22.101333-4.181333 37.333333-9.856 51.370666-18.517333h32.554667v185.472h41.514667V597.333333h-132.906667z" fill="currentColor"></path></svg>',download:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M896 672c-17.066667 0-32 14.933333-32 32v128c0 6.4-4.266667 10.666667-10.666667 10.666667H170.666667c-6.4 0-10.666667-4.266667-10.666667-10.666667v-128c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v128c0 40.533333 34.133333 74.666667 74.666667 74.666667h682.666666c40.533333 0 74.666667-34.133333 74.666667-74.666667v-128c0-17.066667-14.933333-32-32-32z" fill="currentColor"></path><path d="M488.533333 727.466667c6.4 6.4 14.933333 8.533333 23.466667 8.533333s17.066667-2.133333 23.466667-8.533333l213.333333-213.333334c12.8-12.8 12.8-32 0-44.8-12.8-12.8-32-12.8-44.8 0l-157.866667 157.866667V170.666667c0-17.066667-14.933333-32-32-32s-34.133333 14.933333-34.133333 32v456.533333L322.133333 469.333333c-12.8-12.8-32-12.8-44.8 0-12.8 12.8-12.8 32 0 44.8l211.2 213.333334z" fill="currentColor"></path></svg>',modular:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M405.333333 458.666667H149.333333c-29.866667 0-53.333333-23.466667-53.333333-53.333334V149.333333c0-29.866667 23.466667-53.333333 53.333333-53.333333h256c29.866667 0 53.333333 23.466667 53.333334 53.333333v256c0 29.866667-23.466667 53.333333-53.333334 53.333334z m-245.333333-64h234.666667v-234.666667h-234.666667v234.666667zM874.666667 458.666667H618.666667c-29.866667 0-53.333333-23.466667-53.333334-53.333334V149.333333c0-29.866667 23.466667-53.333333 53.333334-53.333333h256c29.866667 0 53.333333 23.466667 53.333333 53.333333v256c0 29.866667-23.466667 53.333333-53.333333 53.333334z m-245.333334-64h234.666667v-234.666667h-234.666667v234.666667zM874.666667 928H618.666667c-29.866667 0-53.333333-23.466667-53.333334-53.333333V618.666667c0-29.866667 23.466667-53.333333 53.333334-53.333334h256c29.866667 0 53.333333 23.466667 53.333333 53.333334v256c0 29.866667-23.466667 53.333333-53.333333 53.333333z m-245.333334-64h234.666667v-234.666667h-234.666667v234.666667zM405.333333 928H149.333333c-29.866667 0-53.333333-23.466667-53.333333-53.333333V618.666667c0-29.866667 23.466667-53.333333 53.333333-53.333334h256c29.866667 0 53.333333 23.466667 53.333334 53.333334v256c0 29.866667-23.466667 53.333333-53.333334 53.333333z m-245.333333-64h234.666667v-234.666667h-234.666667v234.666667z" fill="currentColor"></path></svg>'};class Jr{constructor(t,e){n(this,"el");n(this,"oTransformX",0);n(this,"oTransformY",0);n(this,"transformX");n(this,"transformY");n(this,"zoom");n(this,"rotate");n(this,"STEP",.25);n(this,"MIN_SCALE",.2);n(this,"MAX_SCALE",2.5);n(this,"TRANSFORM_X",0);n(this,"TRANSFORM_Y",0);n(this,"ZOOM",1);n(this,"ROTATE",0);n(this,"callback");this.el=t,this.transformX=(e==null?void 0:e.transformX)||this.TRANSFORM_X,this.transformY=(e==null?void 0:e.transformY)||this.TRANSFORM_Y,this.zoom=(e==null?void 0:e.zoom)||this.ZOOM,this.rotate=(e==null?void 0:e.rotate)||this.ROTATE,this.callback=e==null?void 0:e.callback,this.handleDefaultDraggable(),this.onDraggable(),this.onMouseWheel()}handleDefaultDraggable(){document.body.ondragstart=t=>(t.returnValue=!1,t.preventDefault(),!1)}onDraggable(){this.el.onmousedown=t=>{const e=t.clientX,i=t.clientY;document.onmousemove=r=>{const a=r.clientX-e,l=r.clientY-i;this.transformX=this.oTransformX+a,this.transformY=this.oTransformY+l,this.el.style.cursor="grabbing",this.setPosition()}},document.onmouseup=()=>{document.onmousemove=null,this.oTransformX=this.transformX,this.oTransformY=this.transformY,this.el.style.cursor="grab"}}onMouseWheel(){const t=this.throttle(this.setMouseWheel,100);this.el.onwheel=e=>{const i=e.deltaY||e.detail;t(i)}}throttle(t,e){let i=null;return(...r)=>{i||(i=setTimeout(()=>{i=null,t.apply(this,r)},e))}}setMouseWheel(t){if(t<0){if(this.zoom>=this.MAX_SCALE){this.el.style.cursor="not-allowed";return}this.el.style.cursor="zoom-in",this.setZoomIn(this.STEP)}else{if(this.zoom<=this.MIN_SCALE){this.el.style.cursor="not-allowed";return}this.el.style.cursor="zoom-out",this.setZoomOut(this.STEP)}this.setPosition()}setZoomIn(t=this.STEP){var e;this.zoom=Math.min(this.MAX_SCALE,this.zoom+t),this.setPosition(),(e=this.callback)==null||e.call(this,this.zoom)}setZoomOut(t=this.STEP){var e;this.zoom=Math.max(this.MIN_SCALE,this.zoom-t),this.setPosition(),(e=this.callback)==null||e.call(this,this.zoom)}setZoomBest(){var d;const t=this.rotate/.25%2===0,{clientWidth:e,clientHeight:i}=this.el,{clientWidth:r=0,clientHeight:a=0}=this.el.parentElement||{},l=(..._)=>[Math.min(..._),Math.max(..._)],[o,h]=l(e,i),[u,g]=l(r-32,a-32),m=+(r/a).toFixed(4),p=+(t?e/i:i/e).toFixed(4),c=m>1&&p>1?m>p?u/o:g/h:m<p?p>1?1:u/o:m>1?u/h:u/o;this.transformX=this.TRANSFORM_X,this.transformY=this.TRANSFORM_Y,this.zoom=Math.min(this.MAX_SCALE,c),this.setPosition(),(d=this.callback)==null||d.call(this,this.zoom)}setZoomOriginal(){this.reset(),this.setPosition()}setRotate(){this.rotate+=.25,this.setPosition()}reset(){var t;this.transformX=this.TRANSFORM_X,this.transformY=this.TRANSFORM_Y,this.oTransformX=this.transformX,this.oTransformY=this.transformY,this.zoom=this.ZOOM,(t=this.callback)==null||t.call(this,this.zoom)}setPosition(){this.el.style.transform=`translate(${this.transformX}px, ${this.transformY}px) scale(${this.zoom}) rotate(${this.rotate}turn)`}}const Qr=["disabled","innerHTML"],Kr=["disabled","innerHTML"],ta=["innerHTML"],ea=["disabled","innerHTML"],ia=["disabled","innerHTML"],sa=["innerHTML"],ra=["innerHTML"],aa=["innerHTML"],na=["innerHTML"],oa=["innerHTML"],la=["onClick"],ha=ie({__name:"image-preview",props:{url:{type:String,default:"",required:!0},previewUrlList:{type:Array,default:()=>[],required:!0},zIndex:{type:Number,required:!1},backDropZIndex:{type:Number,required:!1}},setup(s){const t=s,e=Gr("image-preview");let i=null;const r=Gt(0),a=ti(()=>t.previewUrlList[r.value]),l=Gt(1),o=t.zIndex?{zIndex:t.zIndex}:{},h=t.backDropZIndex?{zIndex:t.backDropZIndex}:{},u=()=>{const R=document.querySelector(`.${e.e("main-image")}`);i=new Jr(R,{callback:ct=>{l.value=ct}})},g=()=>{r.value=t.previewUrlList.findIndex(R=>R===t.url)},m=()=>{r.value=r.value<=0?t.previewUrlList.length-1:r.value-1,i==null||i.setZoomOriginal()},p=()=>{r.value=r.value>=t.previewUrlList.length-1?0:r.value+1,i==null||i.setZoomOriginal()},c=()=>Bt.close(),d=()=>i==null?void 0:i.setZoomIn(),_=()=>i==null?void 0:i.setZoomOut(),f=()=>i==null?void 0:i.setRotate(),b=()=>i==null?void 0:i.setZoomBest(),y=()=>i==null?void 0:i.setZoomOriginal(),B=R=>{R.defaultPrevented||(R.code==="Escape"?c():R.code==="ArrowLeft"?m():R.code==="ArrowRight"&&p())},T=()=>document.addEventListener("keydown",B,!1),S=()=>document.removeEventListener("keydown",B,!1),x=R=>{r.value=R},V=Gt(!1),Y=()=>{V.value=!V.value};return Es(()=>{g(),u(),T()}),br(()=>{S()}),(R,ct)=>{var st,St;return nt(),ot(ci,null,[F("div",{class:rt(A(e).b()),style:di(A(o))},[de(He,{class:rt(A(e).e("main-image")),src:a.value,alt:""},null,8,["class","src"]),F("div",{class:rt(A(e).e("toolbar"))},[F("div",{class:rt(A(e).e("toolbar-left"))},[F("button",{disabled:r.value===0,onClick:m,innerHTML:A(K).left},null,8,Qr),F("button",null,[F("span",null,ae(r.value+1)+"/"+ae(t.previewUrlList.length),1)]),F("button",{disabled:r.value===((st=t.previewUrlList)==null?void 0:st.length)-1,onClick:p,innerHTML:A(K).right},null,8,Kr),((St=t.previewUrlList)==null?void 0:St.length)>2?(nt(),ot("button",{key:0,onClick:Y},[F("i",{innerHTML:A(K).modular},null,8,ta)])):gi("",!0)],2),F("div",{class:rt(A(e).e("toolbar-middle"))},[F("button",{disabled:l.value>=2.5,onClick:d,innerHTML:A(K).zoomIn},null,8,ea),F("button",null,[F("span",null,ae(Math.round(l.value*100))+"%",1)]),F("button",{disabled:l.value<=.2,onClick:_,innerHTML:A(K).zoomOut},null,8,ia),F("button",{onClick:f,innerHTML:A(K).rotate},null,8,sa),F("button",{onClick:y,innerHTML:A(K).best},null,8,ra),F("button",{onClick:b,innerHTML:A(K).reset},null,8,aa),As(F("button",{innerHTML:A(K).download},null,8,na),[[A(Zr),{src:a.value}]])],2),F("div",{class:rt(A(e).e("toolbar-right"))},[F("button",{onClick:c,innerHTML:A(K).close},null,8,oa)],2)],2),de(Tr,{name:"thumbnail"},{default:Pr(()=>[V.value?(nt(),ot("div",{key:0,class:rt(A(e).e("thumbnail"))},[(nt(!0),ot(ci,null,wr(t.previewUrlList,(ui,Le)=>(nt(),ot("div",{key:ui,class:rt([A(e).e("thumbnail-item"),Le===r.value?"active":""]),onClick:Xo=>x(Le)},[de(He,{src:ui},null,8,["src"]),F("span",null,ae(Le+1),1)],10,la))),128))],2)):gi("",!0)]),_:1})],6),F("div",{class:rt(A(e).e("bg")),style:di(A(h))},null,6)],64)}}});const ua=Pe(ha,[["__scopeId","data-v-57a592c3"]]),ga=s=>Ir(ua,s);class Bt{static open(t){this.$body=document.body,this.$div=document.createElement("div"),this.$div.setAttribute("id",this.$id),this.$overflow=this.$body.style.overflow,this.$body.appendChild(this.$div),ga(t).mount(this.$div),this.$body.style.setProperty("overflow","hidden","important")}static close(){var e,i;(e=this.$body)==null||e.style.setProperty("overflow",this.$overflow),this.$overflow="";const t=this.$div??document.getElementById(this.$id);t&&((i=this.$body)==null||i.removeChild(t)),this.$body=null,this.$div=null}}n(Bt,"$body",null),n(Bt,"$div",null),n(Bt,"$id","vite-press__image-preview"),n(Bt,"$overflow","");const ks=s=>{Bt.open({url:s.url,previewUrlList:s.previewUrlList,zIndex:s.zIndex,backDropZIndex:s.backDropZIndex})},pi=()=>{Bt.close()},zs=s=>{let t=null;return s.scopeSelector&&(t=document.querySelector(s.scopeSelector)),[...(t||s).querySelectorAll("img")].map(i=>i.getAttribute("data-src")||i.getAttribute("src")||"")},Ns=s=>{var i;s.stopPropagation();const t=s.currentTarget,e=s.target;if(((i=e==null?void 0:e.nodeName)==null?void 0:i.toLowerCase())==="img"){const r=zs(t),a=e.getAttribute("src");ks({url:a,previewUrlList:r,zIndex:t==null?void 0:t.zIndex,backDropZIndex:t==null?void 0:t.backDropZIndex})}},Ee=s=>{s.addEventListener("click",Ns)},ca=s=>{s.removeEventListener("click",Ns)},da={mounted(s,t){if(!(t!=null&&t.value))return Ee(s);const{custom:e,disableDefault:i,scopeSelector:r}=t.value;s.scopeSelector=r,e&&(e.open=()=>{const a=zs(s);ks({url:a==null?void 0:a[0],previewUrlList:a,zIndex:s==null?void 0:s.zIndex,backDropZIndex:s==null?void 0:s.backDropZIndex})},e.close=()=>pi()),!i&&Ee(s)},unmounted(){pi()},updated(s,t){var e,i;if(s.zIndex=(e=t.value)==null?void 0:e.zIndex,s.backDropZIndex=(i=t.value)==null?void 0:i.backDropZIndex,t.value){const{value:{disableDefault:r},oldValue:a}=t,{disableDefault:l}=a||{};r!==l&&(r?ca(s):Ee(s))}}},ma={class:"image-preview"},_a=ie({__name:"ImagePreview",props:{src:{}},setup(s){const t=da;return(e,i)=>As((nt(),ot("div",ma,[de(He,{src:e.src},null,8,["src"])])),[[A(t),{scopeSelector:".VPDoc .main"}]])}});const pa=Pe(_a,[["__scopeId","data-v-0452ff21"]]);var Ge=(s=>(s[s.Max=2]="Max",s[s.Min=.8]="Min",s))(Ge||{}),me=(s=>(s[s.Left=-1]="Left",s[s.Right=1]="Right",s[s.Bottom=-1]="Bottom",s[s.Top=1]="Top",s))(me||{}),Ht=(s=>(s[s.Left=-2]="Left",s[s.Right=2]="Right",s[s.Bottom=-2]="Bottom",s[s.Top=2]="Top",s))(Ht||{}),Et=(s=>(s.Idle="Idle",s.TapBody="TapBody",s.TapLeft="TapLeft",s.TapRight="TapRight",s.Tap="Tap",s))(Et||{}),D=(s=>(s.Head="Head",s.Body="Body",s.Left="Left",s.Right="Right",s.Other="Other",s))(D||{}),ut=(s=>(s[s.None=0]="None",s[s.Idle=1]="Idle",s[s.Normal=2]="Normal",s[s.Force=3]="Force",s))(ut||{});const bt=globalThis.document||{},j={canvas:{width:280,height:360},scale:1,debug:!1,target:bt.body,source:{path:"",models:[]},cubismCorePath:"/live2d/core/live2dCubismCore.min.js"},fa=s=>{j.target=bt.body,Object.keys(s).forEach(t=>{j.hasOwnProperty(t)&&(j[t]=s[t])})},ve=class{constructor(t=0){n(this,"_ptr");n(this,"_size");n(this,"_capacity");t<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(t),this._capacity=t,this._size=0)}at(t){return this._ptr[t]}set(t,e){this._ptr[t]=e}get(t=0){const e=new Array;for(let i=t;i<this._size;i++)e.push(this._ptr[i]);return e}pushBack(t){this._size>=this._capacity&&this.prepareCapacity(this._capacity==0?ve.s_defaultSize:this._capacity*2),this._ptr[this._size++]=t}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(t,e){this._size<t&&this.prepareCapacity(t);for(let i=0;i<t;i++)this._ptr[i]=e;this._size=t}resize(t,e=null){this.updateSize(t,e,!0)}updateSize(t,e=null,i=!0){if(this._size<t)if(this.prepareCapacity(t),i)for(let r=this._size;r<t;r++)typeof e=="function"?this._ptr[r]=JSON.parse(JSON.stringify(new e)):this._ptr[r]=e;else for(let r=this._size;r<t;r++)this._ptr[r]=e;else{const r=this._size-t;this._ptr.splice(this._size-r,r)}this._size=t}insert(t,e,i){let r=t._index;const a=e._index,l=i._index,o=l-a;this.prepareCapacity(this._size+o);const h=this._size-r;if(h>0)for(let u=0;u<h;u++)this._ptr.splice(r+u,0,null);for(let u=a;u<l;u++,r++)this._ptr[r]=e._vector._ptr[u];this._size=this._size+o}remove(t){return t<0||this._size<=t?!1:(this._ptr.splice(t,1),--this._size,!0)}erase(t){const e=t._index;return e<0||this._size<=e?t:(this._ptr.splice(e,1),--this._size,new _e(this,e))}prepareCapacity(t){t>this._capacity&&(this._capacity==0?(this._ptr=new Array(t),this._capacity=t):(this._ptr.length=t,this._capacity=t))}begin(){return this._size==0?this.end():new _e(this,0)}end(){return new _e(this,this._size)}getOffset(t){const e=new ve;return e._ptr=this.get(t),e._size=this.get(t).length,e._capacity=this.get(t).length,e}};let v=ve;n(v,"s_defaultSize",10);let _e=class We{constructor(t,e){n(this,"_index");n(this,"_vector");this._vector=t??null,this._index=e??0}set(t){return this._index=t._index,this._vector=t._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new We(this._vector,this._index++)}decrement(){return new We(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(t){return this._index=t._index,this._vector=t._vector,this}notEqual(t){return this._index!=t._index||this._vector!=t._vector}};var fi;(s=>{s.csmVector=v,s.iterator=_e})(fi||(fi={}));class ${constructor(t){n(this,"s");this.s=t}append(t,e){return this.s+=e!==void 0?t.substr(0,e):t,this}expansion(t,e){for(let i=0;i<t;i++)this.append(e);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(t){return this.s<t.s}isGreat(t){return this.s>t.s}isEqual(t){return this.s==t}isEmpty(){return this.s.length==0}}var yi;(s=>{s.csmString=$})(yi||(yi={}));class qt{constructor(t){n(this,"_id");if(typeof t=="string"){this._id=new $(t);return}this._id=t}getString(){return this._id}isEqual(t){return typeof t=="string"?this._id.isEqual(t):t instanceof $?this._id.isEqual(t.s):t instanceof qt?this._id.isEqual(t._id.s):!1}isNotEqual(t){return typeof t=="string"?!this._id.isEqual(t):t instanceof $?!this._id.isEqual(t.s):t instanceof qt?!this._id.isEqual(t._id.s):!1}}var xi;(s=>{s.CubismId=qt})(xi||(xi={}));class Os{constructor(){n(this,"_ids");this._ids=new v}release(){for(let t=0;t<this._ids.getSize();++t)this._ids.set(t,void 0);this._ids=null}registerIds(t){for(let e=0;e<t.length;e++)this.registerId(t[e])}registerId(t){let e=null;if(typeof t=="string"){if((e=this.findId(t))!=null)return e;e=new qt(t),this._ids.pushBack(e)}else return this.registerId(t.s);return e}getId(t){return this.registerId(t)}isExist(t){return typeof t=="string"?this.findId(t)!=null:this.isExist(t.s)}findId(t){for(let e=0;e<this._ids.getSize();++e)if(this._ids.at(e).getString().isEqual(t))return this._ids.at(e);return null}}var Si;(s=>{s.CubismIdManager=Os})(Si||(Si={}));class k{constructor(){n(this,"_tr");this._tr=new Float32Array(16),this.loadIdentity()}static multiply(t,e,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a=4;for(let l=0;l<a;++l)for(let o=0;o<a;++o)for(let h=0;h<a;++h)r[o+l*4]+=t[h+l*4]*e[o+h*4];for(let l=0;l<16;++l)i[l]=r[l]}loadIdentity(){const t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(t)}setMatrix(t){for(let e=0;e<16;++e)this._tr[e]=t[e]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(t){return this._tr[0]*t+this._tr[12]}transformY(t){return this._tr[5]*t+this._tr[13]}invertTransformX(t){return(t-this._tr[12])/this._tr[0]}invertTransformY(t){return(t-this._tr[13])/this._tr[5]}translateRelative(t,e){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]);k.multiply(i,this._tr,this._tr)}translate(t,e){this._tr[12]=t,this._tr[13]=e}translateX(t){this._tr[12]=t}translateY(t){this._tr[13]=t}scaleRelative(t,e){const i=new Float32Array([t,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1]);k.multiply(i,this._tr,this._tr)}scale(t,e){this._tr[0]=t,this._tr[5]=e}multiplyByMatrix(t){k.multiply(t.getArray(),this._tr,this._tr)}clone(){const t=new k;for(let e=0;e<this._tr.length;e++)t._tr[e]=this._tr[e];return t}}var Ci;(s=>{s.CubismMatrix44=k})(Ci||(Ci={}));class se{constructor(){n(this,"_mvpMatrix4x4");n(this,"_modelColor");n(this,"_isCulling");n(this,"_isPremultipliedAlpha");n(this,"_anisotropy");n(this,"_model");n(this,"_useHighPrecisionMask");this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisotropy=0,this._model=null,this._modelColor=new gt,this._useHighPrecisionMask=!1,this._mvpMatrix4x4=new k,this._mvpMatrix4x4.loadIdentity()}static create(){return null}static delete(t){}initialize(t){this._model=t}drawModel(){this.getModel()!=null&&(this.saveProfile(),this.doDrawModel(),this.restoreProfile())}setMvpMatrix(t){this._mvpMatrix4x4.setMatrix(t.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(t,e,i,r){t<0?t=0:t>1&&(t=1),e<0?e=0:e>1&&(e=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.R=t,this._modelColor.G=e,this._modelColor.B=i,this._modelColor.A=r}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}setIsPremultipliedAlpha(t){this._isPremultipliedAlpha=t}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(t){this._isCulling=t}isCulling(){return this._isCulling}setAnisotropy(t){this._anisotropy=t}getAnisotropy(){return this._anisotropy}getModel(){return this._model}useHighPrecisionMask(t){this._useHighPrecisionMask=t}isUsingHighPrecisionMask(){return this._useHighPrecisionMask}}n(se,"staticRelease");var it=(s=>(s[s.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",s[s.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",s[s.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative",s))(it||{});class gt{constructor(){n(this,"R");n(this,"G");n(this,"B");n(this,"A");this.R=1,this.G=1,this.B=1,this.A=1}}var Mi;(s=>{s.CubismBlendMode=it,s.CubismRenderer=se,s.CubismTextureColor=gt})(Mi||(Mi={}));const ya=(s,t,e)=>{Us.print(s,"[CSM]"+t,e)},ne=(s,t,e)=>{ya(s,t+`
`,e)},et=s=>{console.assert(s)};let $t,lt,yt,X;$t=(s,...t)=>{ne(At.LogLevel_Debug,"[D]"+s,t)},lt=(s,...t)=>{ne(At.LogLevel_Info,"[I]"+s,t)},yt=(s,...t)=>{ne(At.LogLevel_Warning,"[W]"+s,t)},X=(s,...t)=>{ne(At.LogLevel_Error,"[E]"+s,t)};class Us{static print(t,e,i){if(t<L.getLoggingLevel())return;const r=L.coreLogFunction;if(!r)return;const a=e.replace(/\{(\d+)\}/g,(l,o)=>i[o]);r(a)}static dumpBytes(t,e,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(t,`
`):r%8==0&&r>0&&this.print(t,"  "),this.print(t,"{0} ",[e[r]&255]);this.print(t,`
`)}constructor(){}}var vi;(s=>{s.CubismDebug=Us})(vi||(vi={}));class js{constructor(t,e){n(this,"first");n(this,"second");this.first=t??null,this.second=e??null}}const Be=class{constructor(t){n(this,"_keyValues");n(this,"_dummyValue");n(this,"_size");t!=null?t<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(t),this._size=t):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(t){this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new js(t),this._size+=1}getValue(t){let e=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==t){e=i;break}return e>=0?this._keyValues[e].second:(this.appendKey(t),this._keyValues[this._size-1].second)}setValue(t,e){let i=-1;for(let r=0;r<this._size;r++)if(this._keyValues[r].first==t){i=r;break}i>=0?this._keyValues[i].second=e:(this.appendKey(t),this._keyValues[this._size-1].second=e)}isExist(t){for(let e=0;e<this._size;e++)if(this._keyValues[e].first==t)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(t,e){t>this._keyValues.length&&(this._keyValues.length==0?(!e&&t<Be.DefaultSize&&(t=Be.DefaultSize),this._keyValues.length=t):(!e&&t<this._keyValues.length*2&&(t=this._keyValues.length*2),this._keyValues.length=t))}begin(){return new Pt(this,0)}end(){return new Pt(this,this._size)}erase(t){const e=t._index;return e<0||this._size<=e?t:(this._keyValues.splice(e,1),--this._size,new Pt(this,e))}dumpAsInt(){for(let t=0;t<this._size;t++)$t("{0} ,",this._keyValues[t]),$t(`
`)}};let H=Be;n(H,"DefaultSize",10);class Pt{constructor(t,e){n(this,"_index");n(this,"_map");this._map=t??new H,this._index=e??0}set(t){return this._index=t._index,this._map=t._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new Pt(this._map,this._index++)}decrement(){const t=new Pt(this._map,this._index);return this._map=t._map,this._index=t._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(t){return this._index!=t._index||this._map!=t._map}}var Bi;(s=>{s.csmMap=H,s.csmPair=js,s.iterator=Pt})(Bi||(Bi={}));class fe{static parseJsonObject(t,e){return Object.keys(t).forEach(i=>{typeof t[i]=="boolean"?e.put(i,new W(t[i])):typeof t[i]=="string"?e.put(i,new Ot(t[i])):typeof t[i]=="number"?e.put(i,new xe(t[i])):t[i]instanceof Array?e.put(i,fe.parseJsonArray(t[i])):t[i]instanceof Object?e.put(i,fe.parseJsonObject(t[i],new Dt)):t[i]==null?e.put(i,new Ft):e.put(i,t[i])}),e}static parseJsonArray(t){const e=new ei;return Object.keys(t).forEach(i=>{const r=Number(i);if(typeof r=="number")typeof t[r]=="boolean"?e.add(new W(t[r])):typeof t[r]=="string"?e.add(new Ot(t[r])):typeof t[r]=="number"?e.add(new xe(t[r])):t[i]instanceof Array?e.add(this.parseJsonArray(t[i])):t[i]instanceof Object?e.add(this.parseJsonObject(t[i],new Dt)):t[i]==null?e.add(new Ft):e.add(t[i]);else if(t[i]instanceof Array)e.add(this.parseJsonArray(t[i]));else if(t[i]instanceof Object)e.add(this.parseJsonObject(t[i],new Dt));else if(t[i]==null)e.add(new Ft);else for(let a=0;a<t[i].length;a++)e.add(t[i][a])}),e}}const ye="Error: type mismatch",xa="Error: index out of bounds";var O;let U=(O=class{constructor(){n(this,"_stringBuffer")}getRawString(t,e){return this.getString(t,e)}toInt(t=0){return t}toFloat(t=0){return t}toBoolean(t=!1){return t}getSize(){return 0}getArray(t=null){return t}getVector(t=new v){return t}getMap(t){return t}getValueByIndex(t){return O.errorValue.setErrorNotForClientCall(ye)}getValueByString(t){return O.nullValue.setErrorNotForClientCall(ye)}getKeys(){return O.s_dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(t){return!1}isStatic(){return!1}setErrorNotForClientCall(t){return Zt.errorValue}static staticInitializeNotForClientCall(){W.trueValue=new W(!0),W.falseValue=new W(!1),O.errorValue=new Zt("ERROR",!0),O.nullValue=new Ft,O.s_dummyKeys=new v}static staticReleaseNotForClientCall(){W.trueValue=null,W.falseValue=null,O.errorValue=null,O.nullValue=null,O.s_dummyKeys=null}},n(O,"s_dummyKeys"),n(O,"errorValue"),n(O,"nullValue"),O);class z{constructor(t,e){n(this,"_parseCallback",fe.parseJsonObject);n(this,"_error");n(this,"_lineCount");n(this,"_root");this._error=null,this._lineCount=0,this._root=null,t!=null&&this.parseBytes(t,e,this._parseCallback)}static create(t,e){const i=new z;return i.parseBytes(t,e,i._parseCallback)?i:(z.delete(i),null)}static delete(t){}getRoot(){return this._root}static arrayBufferToString(t){const e=new Uint8Array(t);let i="";for(let r=0,a=e.length;r<a;++r)i+="%"+this.pad(e[r].toString(16));return i=decodeURIComponent(i),i}static pad(t){return t.length<2?"0"+t:t}parseBytes(t,e,i){const r=new Array(1),a=z.arrayBufferToString(t);if(i==null?this._root=this.parseValue(a,e,0,r):this._root=i(JSON.parse(a),new Dt),this._error){let l="\0";return l="Json parse error : @line "+(this._lineCount+1)+`
`,this._root=new Ot(l),lt("{0}",this._root.getRawString()),!1}else if(this._root==null)return this._root=new Zt(new $(this._error),!1),!1;return!0}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(t,e,i,r){if(this._error)return null;let a=null,l=i,o;for(;l<e;l++)switch(t[l]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const h=new Array(1);return o=Sa(t.slice(l),h),r[0]=t.indexOf(h[0]),new xe(o)}case'"':return new Ot(this.parseString(t,e,l+1,r));case"[":return a=this.parseArray(t,e,l+1,r),a;case"{":return a=this.parseObject(t,e,l+1,r),a;case"n":return l+3<e?(a=new Ft,r[0]=l+4):this._error="parse null",a;case"t":return l+3<e?(a=W.trueValue,r[0]=l+4):this._error="parse true",a;case"f":return l+4<e?(a=W.falseValue,r[0]=l+5):this._error="illegal ',' position",a;case",":return this._error="illegal ',' position",null;case"]":return r[0]=l,null;case`
`:this._lineCount++}return this._error="illegal end of value",null}parseString(t,e,i,r){if(this._error)return null;let a=i,l,o;const h=new $("");let u=i;for(;a<e;a++)switch(l=t[a],l){case'"':return r[0]=a+1,h.append(t.slice(u),a-u),h.s;case"//":if(a++,a-1>u&&h.append(t.slice(u),a-u),u=a+1,a<e)switch(o=t[a],o){case"\\":h.expansion(1,"\\");break;case'"':h.expansion(1,'"');break;case"/":h.expansion(1,"/");break;case"b":h.expansion(1,"\b");break;case"f":h.expansion(1,"\f");break;case"n":h.expansion(1,`
`);break;case"r":h.expansion(1,"\r");break;case"t":h.expansion(1,"	");break;case"u":this._error="parse string/unicord escape not supported";break}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(t,e,i,r){if(this._error)return null;const a=new Dt;let l="",o=i,h="";const u=Array(1);let g=!1;for(;o<e;o++){t:for(;o<e;o++)switch(h=t[o],h){case'"':if(l=this.parseString(t,e,o+1,u),this._error)return null;o=u[0],g=!0;break t;case"}":return r[0]=o+1,a;case":":this._error="illegal ':' position";break;case`
`:this._lineCount++}if(!g)return this._error="key not found",null;g=!1;t:for(;o<e;o++)switch(h=t[o],h){case":":g=!0,o++;break t;case"}":this._error="illegal '}' position";break;case`
`:this._lineCount++}if(!g)return this._error="':' not found",null;const m=this.parseValue(t,e,o,u);if(this._error)return null;o=u[0],a.put(l,m);t:for(;o<e;o++)switch(h=t[o],h){case",":break t;case"}":return r[0]=o+1,a;case`
`:this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(t,e,i,r){if(this._error)return null;let a=new ei,l=i,o;const h=new Array(1);for(;l<e;l++){const u=this.parseValue(t,e,l,h);if(this._error)return null;l=h[0],u&&a.add(u);t:for(;l<e;l++)switch(o=t[l],o){case",":break t;case"]":return r[0]=l+1,a;case`
`:++this._lineCount}}return a=void 0,this._error="illegal end of parseObject",null}}class xe extends U{constructor(e){super();n(this,"_value");this._value=e}isFloat(){return!0}getString(e,i){const r="\0";return this._value=parseFloat(r),this._stringBuffer=r,this._stringBuffer}toInt(e=0){return parseInt(this._value.toString())}toFloat(e=0){return this._value}equals(e){return typeof e=="number"?Math.round(e)?!1:e==this._value:!1}}class W extends U{constructor(e){super();n(this,"_boolValue");this._boolValue=e}isBool(){return!0}toBoolean(e=!1){return this._boolValue}getString(e,i){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(e){return typeof e=="boolean"?e==this._boolValue:!1}isStatic(){return!0}}n(W,"trueValue"),n(W,"falseValue");class Ot extends U{constructor(t){super(),typeof t=="string"&&(this._stringBuffer=t),t instanceof $&&(this._stringBuffer=t.s)}isString(){return!0}getString(t,e){return this._stringBuffer}equals(t){return typeof t=="string"?this._stringBuffer==t:t instanceof $?this._stringBuffer==t.s:!1}}class Zt extends Ot{constructor(e,i){var t=(...args)=>{super(...args);n(this,"_isStatic")};t(e),this._isStatic=i}isStatic(){return this._isStatic}setErrorNotForClientCall(e){return this._stringBuffer=e,this}isError(){return!0}}class Ft extends U{isNull(){return!0}getString(t,e){return this._stringBuffer}isStatic(){return!0}setErrorNotForClientCall(t){return this._stringBuffer=t,Zt.nullValue}constructor(){super(),this._stringBuffer="NullValue"}}class ei extends U{constructor(){super();n(this,"_array");this._array=new v}release(){for(let e=this._array.begin();e.notEqual(this._array.end());e.preIncrement()){let i=e.ptr();i&&!i.isStatic()&&(i=void 0,i=null)}}isArray(){return!0}getValueByIndex(e){return e<0||this._array.getSize()<=e?U.errorValue.setErrorNotForClientCall(xa):this._array.at(e)??U.nullValue}getValueByString(e){return U.errorValue.setErrorNotForClientCall(ye)}getString(e,i){const r=i+`[
`;for(let a=this._array.begin();a.notEqual(this._array.end());a.increment()){const l=a.ptr();this._stringBuffer+=i+""+l.getString(i+" ")+`
`}return this._stringBuffer=r+i+`]
`,this._stringBuffer}add(e){this._array.pushBack(e)}getVector(e=null){return this._array}getSize(){return this._array.getSize()}}class Dt extends U{constructor(){super();n(this,"_map");n(this,"_keys");this._map=new H}release(){const e=this._map.begin();for(;e.notEqual(this._map.end());){let i=e.ptr().second;i&&!i.isStatic()&&(i=void 0,i=null),e.preIncrement()}}isMap(){return!0}getValueByString(e){if(e instanceof $)return this._map.getValue(e.s)??U.nullValue;for(let i=this._map.begin();i.notEqual(this._map.end());i.preIncrement())if(i.ptr().first==e)return i.ptr().second==null?U.nullValue:i.ptr().second;return U.nullValue}getValueByIndex(e){return U.errorValue.setErrorNotForClientCall(ye)}getString(e,i){this._stringBuffer=i+`{
`;const r=this._map.begin();for(;r.notEqual(this._map.end());){const a=r.ptr().first,l=r.ptr().second;this._stringBuffer+=i+" "+a+" : "+l.getString(i+"   ")+` 
`,r.preIncrement()}return this._stringBuffer+=i+`}
`,this._stringBuffer}getMap(e){return this._map}put(e,i){this._map.setValue(e,i)}getKeys(){if(!this._keys){this._keys=new v;const e=this._map.begin();for(;e.notEqual(this._map.end());){const i=e.ptr().first;this._keys.pushBack(i),e.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}var bi;(s=>{s.CubismJson=z,s.JsonArray=ei,s.JsonBoolean=W,s.JsonError=Zt,s.JsonFloat=xe,s.JsonMap=Dt,s.JsonNullvalue=Ft,s.JsonString=Ot,s.Value=U})(bi||(bi={}));function Sa(s,t){let e=0;for(let r=1;;r++){const a=s.slice(r-1,r);if(a=="e"||a=="-"||a=="E")continue;const l=s.substring(0,r),o=Number(l);if(isNaN(o))break;e=r}let i=parseFloat(s);return isNaN(i)&&(i=NaN),t[0]=s.slice(e),i}let Z=!1,wt=!1,Tt=null,jt=null;const xt=Object.freeze({vertexOffset:0,vertexStep:2});function Ca(s){}class L{static startUp(t=null){if(Z)return lt("CubismFramework.startUp() is already done."),Z;if(Tt=t,Tt!=null&&Live2DCubismCore.Logging.csmSetLogFunction(Tt.logFunction),Z=!0,Z){const e=Live2DCubismCore.Version.csmGetVersion(),i=(e&4278190080)>>24,r=(e&16711680)>>16,a=e&65535,l=e;lt("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+i).slice(-2),("00"+r).slice(-2),("0000"+a).slice(-4),l)}return lt("CubismFramework.startUp() is complete."),Z}static cleanUp(){Z=!1,wt=!1,Tt=null,jt=null}static initialize(t=0){if(et(Z),!Z){yt("CubismFramework is not started.");return}if(wt){yt("CubismFramework.initialize() skipped, already initialized.");return}U.staticInitializeNotForClientCall(),jt=new Os,Live2DCubismCore.Memory.initializeAmountOfMemory(t),wt=!0,lt("CubismFramework.initialize() is complete.")}static dispose(){if(et(Z),!Z){yt("CubismFramework is not started.");return}if(!wt){yt("CubismFramework.dispose() skipped, not initialized.");return}U.staticReleaseNotForClientCall(),jt.release(),jt=null,se.staticRelease(),wt=!1,lt("CubismFramework.dispose() is complete.")}static isStarted(){return Z}static isInitialized(){return wt}static coreLogFunction(t){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(t)}static getLoggingLevel(){return Tt!=null?Tt.loggingLevel:5}static getIdManager(){return jt}constructor(){}}class Ma{constructor(){n(this,"logFunction");n(this,"loggingLevel")}}var At=(s=>(s[s.LogLevel_Verbose=0]="LogLevel_Verbose",s[s.LogLevel_Debug=1]="LogLevel_Debug",s[s.LogLevel_Info=2]="LogLevel_Info",s[s.LogLevel_Warning=3]="LogLevel_Warning",s[s.LogLevel_Error=4]="LogLevel_Error",s[s.LogLevel_Off=5]="LogLevel_Off",s))(At||{}),Pi;(s=>{s.Constant=xt,s.csmDelete=Ca,s.CubismFramework=L})(Pi||(Pi={}));function Ys(s,t){for(var e=0,i=s.length-1;i>=0;i--){var r=s[i];r==="."?s.splice(i,1):r===".."?(s.splice(i,1),e++):e&&(s.splice(i,1),e--)}if(t)for(;e--;e)s.unshift("..");return s}var va=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,ii=function(s){return va.exec(s).slice(1)};function qe(){for(var s="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var i=e>=0?arguments[e]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");i&&(s=i+"/"+s,t=i.charAt(0)==="/")}return s=Ys(si(s.split("/"),function(r){return!!r}),!t).join("/"),(t?"/":"")+s||"."}function Xs(s){var t=Hs(s),e=Ra(s,-1)==="/";return s=Ys(si(s.split("/"),function(i){return!!i}),!t).join("/"),!s&&!t&&(s="."),s&&e&&(s+="/"),(t?"/":"")+s}function Hs(s){return s.charAt(0)==="/"}function Ba(){var s=Array.prototype.slice.call(arguments,0);return Xs(si(s,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function ba(s,t){s=qe(s).substr(1),t=qe(t).substr(1);function e(u){for(var g=0;g<u.length&&u[g]==="";g++);for(var m=u.length-1;m>=0&&u[m]==="";m--);return g>m?[]:u.slice(g,m-g+1)}for(var i=e(s.split("/")),r=e(t.split("/")),a=Math.min(i.length,r.length),l=a,o=0;o<a;o++)if(i[o]!==r[o]){l=o;break}for(var h=[],o=l;o<i.length;o++)h.push("..");return h=h.concat(r.slice(l)),h.join("/")}var Pa="/",wa=":";function Ta(s){var t=ii(s),e=t[0],i=t[1];return!e&&!i?".":(i&&(i=i.substr(0,i.length-1)),e+i)}function Ia(s,t){var e=ii(s)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function Va(s){return ii(s)[3]}var tt={extname:Va,basename:Ia,dirname:Ta,sep:Pa,delimiter:wa,relative:ba,join:Ba,isAbsolute:Hs,normalize:Xs,resolve:qe};function si(s,t){if(s.filter)return s.filter(t);for(var e=[],i=0;i<s.length;i++)t(s[i],i,s)&&e.push(s[i]);return e}var Ra="ab".substr(-1)==="b"?function(s,t,e){return s.substr(t,e)}:function(s,t,e){return t<0&&(t=s.length+t),s.substr(t,e)};const C=Object.freeze({HitAreaPrefix:"HitArea",HitAreaHead:"Head",HitAreaBody:"Body",PartsIdCore:"Parts01Core",PartsArmPrefix:"Parts01Arm_",PartsArmLPrefix:"Parts01ArmL_",PartsArmRPrefix:"Parts01ArmR_",ParamAngleX:"ParamAngleX",ParamAngleY:"ParamAngleY",ParamAngleZ:"ParamAngleZ",ParamEyeLOpen:"ParamEyeLOpen",ParamEyeLSmile:"ParamEyeLSmile",ParamEyeROpen:"ParamEyeROpen",ParamEyeRSmile:"ParamEyeRSmile",ParamEyeBallX:"ParamEyeBallX",ParamEyeBallY:"ParamEyeBallY",ParamEyeBallForm:"ParamEyeBallForm",ParamBrowLY:"ParamBrowLY",ParamBrowRY:"ParamBrowRY",ParamBrowLX:"ParamBrowLX",ParamBrowRX:"ParamBrowRX",ParamBrowLAngle:"ParamBrowLAngle",ParamBrowRAngle:"ParamBrowRAngle",ParamBrowLForm:"ParamBrowLForm",ParamBrowRForm:"ParamBrowRForm",ParamMouthForm:"ParamMouthForm",ParamMouthOpenY:"ParamMouthOpenY",ParamCheek:"ParamCheek",ParamBodyAngleX:"ParamBodyAngleX",ParamBodyAngleY:"ParamBodyAngleY",ParamBodyAngleZ:"ParamBodyAngleZ",ParamBreath:"ParamBreath",ParamArmLA:"ParamArmLA",ParamArmRA:"ParamArmRA",ParamArmLB:"ParamArmLB",ParamArmRB:"ParamArmRB",ParamHandL:"ParamHandL",ParamHandR:"ParamHandR",ParamHairFront:"ParamHairFront",ParamHairSide:"ParamHairSide",ParamHairBack:"ParamHairBack",ParamHairFluffy:"ParamHairFluffy",ParamShoulderY:"ParamShoulderY",ParamBustX:"ParamBustX",ParamBustY:"ParamBustY",ParamBaseX:"ParamBaseX",ParamBaseY:"ParamBaseY",ParamNONE:"NONE:"});var wi;(s=>{s.HitAreaBody=C.HitAreaBody,s.HitAreaHead=C.HitAreaHead,s.HitAreaPrefix=C.HitAreaPrefix,s.ParamAngleX=C.ParamAngleX,s.ParamAngleY=C.ParamAngleY,s.ParamAngleZ=C.ParamAngleZ,s.ParamArmLA=C.ParamArmLA,s.ParamArmLB=C.ParamArmLB,s.ParamArmRA=C.ParamArmRA,s.ParamArmRB=C.ParamArmRB,s.ParamBaseX=C.ParamBaseX,s.ParamBaseY=C.ParamBaseY,s.ParamBodyAngleX=C.ParamBodyAngleX,s.ParamBodyAngleY=C.ParamBodyAngleY,s.ParamBodyAngleZ=C.ParamBodyAngleZ,s.ParamBreath=C.ParamBreath,s.ParamBrowLAngle=C.ParamBrowLAngle,s.ParamBrowLForm=C.ParamBrowLForm,s.ParamBrowLX=C.ParamBrowLX,s.ParamBrowLY=C.ParamBrowLY,s.ParamBrowRAngle=C.ParamBrowRAngle,s.ParamBrowRForm=C.ParamBrowRForm,s.ParamBrowRX=C.ParamBrowRX,s.ParamBrowRY=C.ParamBrowRY,s.ParamBustX=C.ParamBustX,s.ParamBustY=C.ParamBustY,s.ParamCheek=C.ParamCheek,s.ParamEyeBallForm=C.ParamEyeBallForm,s.ParamEyeBallX=C.ParamEyeBallX,s.ParamEyeBallY=C.ParamEyeBallY,s.ParamEyeLOpen=C.ParamEyeLOpen,s.ParamEyeLSmile=C.ParamEyeLSmile,s.ParamEyeROpen=C.ParamEyeROpen,s.ParamEyeRSmile=C.ParamEyeRSmile,s.ParamHairBack=C.ParamHairBack,s.ParamHairFluffy=C.ParamHairFluffy,s.ParamHairFront=C.ParamHairFront,s.ParamHairSide=C.ParamHairSide,s.ParamHandL=C.ParamHandL,s.ParamHandR=C.ParamHandR,s.ParamMouthForm=C.ParamMouthForm,s.ParamMouthOpenY=C.ParamMouthOpenY,s.ParamNONE=C.ParamNONE,s.ParamShoulderY=C.ParamShoulderY,s.PartsArmLPrefix=C.PartsArmLPrefix,s.PartsArmPrefix=C.PartsArmPrefix,s.PartsArmRPrefix=C.PartsArmRPrefix,s.PartsIdCore=C.PartsIdCore})(wi||(wi={}));class Gs{}var Ti;(s=>{s.ICubismModelSetting=Gs})(Ti||(Ti={}));const dt="FileReferences",La="Groups",Ea="Layout",Aa="HitAreas",Fa="Moc",Da="Textures",ka="Physics",za="Pose",Na="Expressions",Oa="Motions",Ii="UserData",mt="Name",Vi="File",Ua="Id",oe="Ids",Ri="Sound",Li="FadeInTime",Ei="FadeOutTime",Ae="LipSync",Fe="EyeBlink";class Ws extends Gs{constructor(e,i){super();n(this,"_json");n(this,"_jsonValue");this._json=z.create(e,i),this._json&&(this._jsonValue=new v,this._jsonValue.pushBack(this._json.getRoot().getValueByString(La)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(dt).getValueByString(Fa)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(dt).getValueByString(Oa)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(dt).getValueByString(Na)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(dt).getValueByString(Da)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(dt).getValueByString(ka)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(dt).getValueByString(za)),this._jsonValue.pushBack(this._json.getRoot().getValueByString(Aa)))}release(){z.delete(this._json),this._jsonValue=null}GetJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(1).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(4).getSize():0}getTextureDirectory(){const e=this._jsonValue.at(4).getValueByIndex(0).getRawString().split("/"),i=e.length-1;let r="";for(let a=0;a<i;a++)r+=e[a],a<i-1&&(r+="/");return r}getTextureFileName(e){return this._jsonValue.at(4).getValueByIndex(e).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(7).getSize():0}getHitAreaId(e){return L.getIdManager().getId(this._jsonValue.at(7).getValueByIndex(e).getValueByString(Ua).getRawString())}getHitAreaName(e){return this._jsonValue.at(7).getValueByIndex(e).getValueByString(mt).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(5).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(6).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(3).getSize():0}getExpressionName(e){return this._jsonValue.at(3).getValueByIndex(e).getValueByString(mt).getRawString()}getExpressionFileName(e){return this._jsonValue.at(3).getValueByIndex(e).getValueByString(Vi).getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(2).getKeys().getSize():0}getMotionGroupName(e){return this.isExistMotionGroups()?this._jsonValue.at(2).getKeys().at(e):null}getMotionCount(e){return this.isExistMotionGroupName(e)?this._jsonValue.at(2).getValueByString(e).getSize():0}getMotionFileName(e,i){return this.isExistMotionGroupName(e)?this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Vi).getRawString():""}getMotionSoundFileName(e,i){return this.isExistMotionSoundFile(e,i)?this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Ri).getRawString():""}getMotionFadeInTimeValue(e,i){return this.isExistMotionFadeIn(e,i)?this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Li).toFloat():-1}getMotionFadeOutTimeValue(e,i){return this.isExistMotionFadeOut(e,i)?this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Ei).toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this._json.getRoot().getValueByString(dt).getValueByString(Ii).getRawString():""}getLayoutMap(e){const i=this._json.getRoot().getValueByString(Ea).getMap();if(i==null)return!1;let r=!1;for(const a=i.begin();a.notEqual(i.end());a.preIncrement())e.setValue(a.ptr().first,a.ptr().second.toFloat()),r=!0;return r}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let e=0;for(let i=0;i<this._jsonValue.at(0).getSize();i++){const r=this._jsonValue.at(0).getValueByIndex(i);if(!(r.isNull()||r.isError())&&r.getValueByString(mt).getRawString()==Fe){e=r.getValueByString(oe).getVector().getSize();break}}return e}getEyeBlinkParameterId(e){if(!this.isExistEyeBlinkParameters())return null;for(let i=0;i<this._jsonValue.at(0).getSize();i++){const r=this._jsonValue.at(0).getValueByIndex(i);if(!(r.isNull()||r.isError())&&r.getValueByString(mt).getRawString()==Fe)return L.getIdManager().getId(r.getValueByString(oe).getValueByIndex(e).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let e=0;for(let i=0;i<this._jsonValue.at(0).getSize();i++){const r=this._jsonValue.at(0).getValueByIndex(i);if(!(r.isNull()||r.isError())&&r.getValueByString(mt).getRawString()==Ae){e=r.getValueByString(oe).getVector().getSize();break}}return e}getLipSyncParameterId(e){if(!this.isExistLipSyncParameters())return null;for(let i=0;i<this._jsonValue.at(0).getSize();i++){const r=this._jsonValue.at(0).getValueByIndex(i);if(!(r.isNull()||r.isError())&&r.getValueByString(mt).getRawString()==Ae)return L.getIdManager().getId(r.getValueByString(oe).getValueByIndex(e).getRawString())}return null}isExistModelFile(){const e=this._jsonValue.at(1);return!e.isNull()&&!e.isError()}isExistTextureFiles(){const e=this._jsonValue.at(4);return!e.isNull()&&!e.isError()}isExistHitAreas(){const e=this._jsonValue.at(7);return!e.isNull()&&!e.isError()}isExistPhysicsFile(){const e=this._jsonValue.at(5);return!e.isNull()&&!e.isError()}isExistPoseFile(){const e=this._jsonValue.at(6);return!e.isNull()&&!e.isError()}isExistExpressionFile(){const e=this._jsonValue.at(3);return!e.isNull()&&!e.isError()}isExistMotionGroups(){const e=this._jsonValue.at(2);return!e.isNull()&&!e.isError()}isExistMotionGroupName(e){const i=this._jsonValue.at(2).getValueByString(e);return!i.isNull()&&!i.isError()}isExistMotionSoundFile(e,i){const r=this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Ri);return!r.isNull()&&!r.isError()}isExistMotionFadeIn(e,i){const r=this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Li);return!r.isNull()&&!r.isError()}isExistMotionFadeOut(e,i){const r=this._jsonValue.at(2).getValueByString(e).getValueByIndex(i).getValueByString(Ei);return!r.isNull()&&!r.isError()}isExistUserDataFile(){const e=this._json.getRoot().getValueByString(dt).getValueByString(Ii);return!e.isNull()&&!e.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(0).isNull()||this._jsonValue.at(0).isError())return!1;for(let e=0;e<this._jsonValue.at(0).getSize();++e)if(this._jsonValue.at(0).getValueByIndex(e).getValueByString(mt).getRawString()==Fe)return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(0).isNull()||this._jsonValue.at(0).isError())return!1;for(let e=0;e<this._jsonValue.at(0).getSize();++e)if(this._jsonValue.at(0).getValueByIndex(e).getValueByString(mt).getRawString()==Ae)return!0;return!1}}var Ai;(s=>{s.CubismModelSettingJson=Ws})(Ai||(Ai={}));class re{constructor(){n(this,"_breathParameters");n(this,"_currentTime");this._currentTime=0}static create(){return new re}static delete(t){}setParameters(t){this._breathParameters=t}getParameters(){return this._breathParameters}updateParameters(t,e){this._currentTime+=e;const i=this._currentTime*2*3.14159;for(let r=0;r<this._breathParameters.getSize();++r){const a=this._breathParameters.at(r);t.addParameterValueById(a.parameterId,a.offset+a.peak*Math.sin(i/a.cycle),a.weight)}}}class Rt{constructor(t,e,i,r,a){n(this,"parameterId");n(this,"offset");n(this,"peak");n(this,"cycle");n(this,"weight");this.parameterId=t??null,this.offset=e??0,this.peak=i??0,this.cycle=r??0,this.weight=a??0}}var Fi;(s=>{s.BreathParameterData=Rt,s.CubismBreath=re})(Fi||(Fi={}));const be=class{constructor(t){n(this,"_blinkingState");n(this,"_parameterIds");n(this,"_nextBlinkingTime");n(this,"_stateStartTimeSeconds");n(this,"_blinkingIntervalSeconds");n(this,"_closingSeconds");n(this,"_closedSeconds");n(this,"_openingSeconds");n(this,"_userTimeSeconds");if(this._blinkingState=0,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new v,t!=null)for(let e=0;e<t.getEyeBlinkParameterCount();++e)this._parameterIds.pushBack(t.getEyeBlinkParameterId(e))}static create(t=null){return new be(t)}static delete(t){}setBlinkingInterval(t){this._blinkingIntervalSeconds=t}setBlinkingSetting(t,e,i){this._closingSeconds=t,this._closedSeconds=e,this._openingSeconds=i}setParameterIds(t){this._parameterIds=t}getParameterIds(){return this._parameterIds}updateParameters(t,e){this._userTimeSeconds+=e;let i,r=0;switch(this._blinkingState){case 2:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,r>=1&&(r=1,this._blinkingState=3,this._stateStartTimeSeconds=this._userTimeSeconds),i=1-r;break;case 3:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,r>=1&&(this._blinkingState=4,this._stateStartTimeSeconds=this._userTimeSeconds),i=0;break;case 4:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,r>=1&&(r=1,this._blinkingState=1,this._nextBlinkingTime=this.determinNextBlinkingTiming()),i=r;break;case 1:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=2,this._stateStartTimeSeconds=this._userTimeSeconds),i=1;break;case 0:default:this._blinkingState=1,this._nextBlinkingTime=this.determinNextBlinkingTiming(),i=1;break}be.CloseIfZero||(i=-i);for(let a=0;a<this._parameterIds.getSize();++a)t.setParameterValueById(this._parameterIds.at(a),i)}determinNextBlinkingTiming(){const t=Math.random();return this._userTimeSeconds+t*(2*this._blinkingIntervalSeconds-1)}};let kt=be;n(kt,"CloseIfZero",!0);var qs=(s=>(s[s.EyeState_First=0]="EyeState_First",s[s.EyeState_Interval=1]="EyeState_Interval",s[s.EyeState_Closing=2]="EyeState_Closing",s[s.EyeState_Closed=3]="EyeState_Closed",s[s.EyeState_Opening=4]="EyeState_Opening",s))(qs||{}),Di;(s=>{s.CubismEyeBlink=kt,s.EyeState=qs})(Di||(Di={}));const ja=.001,De=.5,ki="FadeInTime",zi="Link",Ya="Groups",Xa="Id";class Jt{constructor(){n(this,"_partGroups");n(this,"_partGroupCounts");n(this,"_fadeTimeSeconds");n(this,"_lastModel");this._fadeTimeSeconds=De,this._lastModel=null,this._partGroups=new v,this._partGroupCounts=new v}static create(t,e){const i=new Jt,r=z.create(t,e),a=r.getRoot();a.getValueByString(ki).isNull()||(i._fadeTimeSeconds=a.getValueByString(ki).toFloat(De),i._fadeTimeSeconds<=0&&(i._fadeTimeSeconds=De));const l=a.getValueByString(Ya),o=l.getSize();for(let h=0;h<o;++h){const u=l.getValueByIndex(h),g=u.getSize();let m=0;for(let p=0;p<g;++p){const c=u.getValueByIndex(p),d=new Qt,_=L.getIdManager().getId(c.getValueByString(Xa).getRawString());if(d.partId=_,!c.getValueByString(zi).isNull()){const f=c.getValueByString(zi),b=f.getSize();for(let y=0;y<b;++y){const B=new Qt,T=L.getIdManager().getId(f.getValueByIndex(y).getString());B.partId=T,d.link.pushBack(B)}}i._partGroups.pushBack(d.clone()),++m}i._partGroupCounts.pushBack(m)}return z.delete(r),i}static delete(t){}updateParameters(t,e){t!=this._lastModel&&this.reset(t),this._lastModel=t,e<0&&(e=0);let i=0;for(let r=0;r<this._partGroupCounts.getSize();r++){const a=this._partGroupCounts.at(r);this.doFade(t,e,i,a),i+=a}this.copyPartOpacities(t)}reset(t){let e=0;for(let i=0;i<this._partGroupCounts.getSize();++i){const r=this._partGroupCounts.at(i);for(let a=e;a<e+r;++a){this._partGroups.at(a).initialize(t);const l=this._partGroups.at(a).partIndex,o=this._partGroups.at(a).parameterIndex;if(!(l<0)){t.setPartOpacityByIndex(l,a==e?1:0),t.setParameterValueByIndex(o,a==e?1:0);for(let h=0;h<this._partGroups.at(a).link.getSize();++h)this._partGroups.at(a).link.at(h).initialize(t)}}e+=r}}copyPartOpacities(t){for(let e=0;e<this._partGroups.getSize();++e){const i=this._partGroups.at(e);if(i.link.getSize()==0)continue;const r=this._partGroups.at(e).partIndex,a=t.getPartOpacityByIndex(r);for(let l=0;l<i.link.getSize();++l){const o=i.link.at(l).partIndex;o<0||t.setPartOpacityByIndex(o,a)}}}doFade(t,e,i,r){let a=-1,l=1;const o=.5,h=.15;for(let u=i;u<i+r;++u){const g=this._partGroups.at(u).partIndex,m=this._partGroups.at(u).parameterIndex;if(t.getParameterValueByIndex(m)>ja){if(a>=0)break;a=u,l=t.getPartOpacityByIndex(g),l+=e/this._fadeTimeSeconds,l>1&&(l=1)}}a<0&&(a=0,l=1);for(let u=i;u<i+r;++u){const g=this._partGroups.at(u).partIndex;if(a==u)t.setPartOpacityByIndex(g,l);else{let m=t.getPartOpacityByIndex(g),p;l<o?p=l*(o-1)/o+1:p=(1-l)*o/(1-o),(1-p)*(1-l)>h&&(p=1-h/(1-l)),m>p&&(m=p),t.setPartOpacityByIndex(g,m)}}}}class Qt{constructor(t){n(this,"partId");n(this,"parameterIndex");n(this,"partIndex");n(this,"link");if(this.parameterIndex=0,this.partIndex=0,this.link=new v,t!=null){this.partId=t.partId;for(const e=t.link.begin();e.notEqual(t.link.end());e.preIncrement())this.link.pushBack(e.ptr().clone())}}assignment(t){this.partId=t.partId;for(const e=t.link.begin();e.notEqual(t.link.end());e.preIncrement())this.link.pushBack(e.ptr().clone());return this}initialize(t){this.parameterIndex=t.getParameterIndex(this.partId),this.partIndex=t.getPartIndex(this.partId),t.setParameterValueByIndex(this.parameterIndex,1)}clone(){const t=new Qt;t.partId=this.partId,t.parameterIndex=this.parameterIndex,t.partIndex=this.partIndex,t.link=new v;for(let e=this.link.begin();e.notEqual(this.link.end());e.increment())t.link.pushBack(e.ptr().clone());return t}}var Ni;(s=>{s.CubismPose=Jt,s.PartData=Qt})(Ni||(Ni={}));class $s extends k{constructor(e,i){super();n(this,"_width");n(this,"_height");this._width=e!==void 0?e:0,this._height=i!==void 0?i:0,this.setHeight(2)}setWidth(e){const i=e/this._width,r=i;this.scale(i,r)}setHeight(e){const i=e/this._height,r=i;this.scale(i,r)}setPosition(e,i){this.translate(e,i)}setCenterPosition(e,i){this.centerX(e),this.centerY(i)}top(e){this.setY(e)}bottom(e){const i=this._height*this.getScaleY();this.translateY(e-i)}left(e){this.setX(e)}right(e){const i=this._width*this.getScaleX();this.translateX(e-i)}centerX(e){const i=this._width*this.getScaleX();this.translateX(e-i/2)}setX(e){this.translateX(e)}centerY(e){const i=this._height*this.getScaleY();this.translateY(e-i/2)}setY(e){this.translateY(e)}setupFromLayout(e){const i="width",r="height",a="x",l="y",o="center_x",h="center_y",u="top",g="bottom",m="left",p="right";for(const c=e.begin();c.notEqual(e.end());c.preIncrement()){const d=c.ptr().first,_=c.ptr().second;d==i?this.setWidth(_):d==r&&this.setHeight(_)}for(const c=e.begin();c.notEqual(e.end());c.preIncrement()){const d=c.ptr().first,_=c.ptr().second;d==a?this.setX(_):d==l?this.setY(_):d==o?this.centerX(_):d==h?this.centerY(_):d==u?this.top(_):d==g?this.bottom(_):d==m?this.left(_):d==p&&this.right(_)}}}var Oi;(s=>{s.CubismModelMatrix=$s})(Oi||(Oi={}));class M{constructor(t,e){this.x=t,this.y=e,this.x=t??0,this.y=e??0}add(t){const e=new M(0,0);return e.x=this.x+t.x,e.y=this.y+t.y,e}substract(t){const e=new M(0,0);return e.x=this.x-t.x,e.y=this.y-t.y,e}multiply(t){const e=new M(0,0);return e.x=this.x*t.x,e.y=this.y*t.y,e}multiplyByScaler(t){return this.multiply(new M(t,t))}division(t){const e=new M(0,0);return e.x=this.x/t.x,e.y=this.y/t.y,e}divisionByScalar(t){return this.division(new M(t,t))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))}dot(t){return this.x*t.x+this.y*t.y}normalize(){const t=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/t,this.y=this.y/t}isEqual(t){return this.x==t.x&&this.y==t.y}isNotEqual(t){return!this.isEqual(t)}}var Ui;(s=>{s.CubismVector2=M})(Ui||(Ui={}));const Wt=class{static range(t,e,i){return t<e?t=e:t>i&&(t=i),t}static sin(t){return Math.sin(t)}static cos(t){return Math.cos(t)}static abs(t){return Math.abs(t)}static sqrt(t){return Math.sqrt(t)}static cbrt(t){if(t===0)return t;let e=t;const i=e<0;i&&(e=-e);let r;return e===1/0?r=1/0:(r=Math.exp(Math.log(e)/3),r=(e/(r*r)+2*r)/3),i?-r:r}static getEasingSine(t){return t<0?0:t>1?1:.5-.5*this.cos(t*Math.PI)}static max(t,e){return t>e?t:e}static min(t,e){return t>e?e:t}static degreesToRadian(t){return t/180*Math.PI}static radianToDegrees(t){return t*180/Math.PI}static directionToRadian(t,e){const i=Math.atan2(e.y,e.x),r=Math.atan2(t.y,t.x);let a=i-r;for(;a<-Math.PI;)a+=Math.PI*2;for(;a>Math.PI;)a-=Math.PI*2;return a}static directionToDegrees(t,e){const i=this.directionToRadian(t,e);let r=this.radianToDegrees(i);return e.x-t.x>0&&(r=-r),r}static radianToDirection(t){const e=new M;return e.x=this.sin(t),e.y=this.cos(t),e}static quadraticEquation(t,e,i){return this.abs(t)<Wt.Epsilon?this.abs(e)<Wt.Epsilon?-i:-i/e:-(e+this.sqrt(e*e-4*t*i))/(2*t)}static cardanoAlgorithmForBezier(t,e,i,r){if(this.sqrt(t)<Wt.Epsilon)return this.range(this.quadraticEquation(e,i,r),0,1);const a=e/t,l=i/t,o=r/t,h=(3*l-a*a)/3,u=h/3,g=(2*a*a*a-9*a*l+27*o)/27,m=g/2,p=m*m+u*u*u,c=.5,d=c+.01;if(p<0){const B=-h/3,T=B*B*B,S=this.sqrt(T),x=-g/(2*S),V=this.range(x,-1,1),Y=Math.acos(V),R=2*this.cbrt(S),ct=R*this.cos(Y/3)-a/3;if(this.abs(ct-c)<d)return this.range(ct,0,1);const st=R*this.cos((Y+2*Math.PI)/3)-a/3;if(this.abs(st-c)<d)return this.range(st,0,1);const St=R*this.cos((Y+4*Math.PI)/3)-a/3;return this.range(St,0,1)}if(p==0){let B;m<0?B=this.cbrt(-m):B=-this.cbrt(m);const T=2*B-a/3;if(this.abs(T-c)<d)return this.range(T,0,1);const S=-B-a/3;return this.range(S,0,1)}const _=this.sqrt(p),f=this.cbrt(_-m),b=this.cbrt(_+m),y=f-b-a/3;return this.range(y,0,1)}constructor(){}};let P=Wt;n(P,"Epsilon",1e-5);var ji;(s=>{s.CubismMath=P})(ji||(ji={}));const ke=30,Yi=.01;class Zs{constructor(){n(this,"_faceTargetX");n(this,"_faceTargetY");n(this,"_faceX");n(this,"_faceY");n(this,"_faceVX");n(this,"_faceVY");n(this,"_lastTimeSeconds");n(this,"_userTimeSeconds");this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(t){this._userTimeSeconds+=t;const e=40/10*1/ke;if(this._lastTimeSeconds==0){this._lastTimeSeconds=this._userTimeSeconds;return}const i=(this._userTimeSeconds-this._lastTimeSeconds)*ke;this._lastTimeSeconds=this._userTimeSeconds;const r=.15*ke,a=i*e/r,l=this._faceTargetX-this._faceX,o=this._faceTargetY-this._faceY;if(P.abs(l)<=Yi&&P.abs(o)<=Yi)return;const h=P.sqrt(l*l+o*o),u=e*l/h,g=e*o/h;let m=u-this._faceVX,p=g-this._faceVY;const c=P.sqrt(m*m+p*p);(c<-a||c>a)&&(m*=a/c,p*=a/c),this._faceVX+=m,this._faceVY+=p;{const d=.5*(P.sqrt(a*a+16*a*h-8*a*h)-a),_=P.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);_>d&&(this._faceVX*=d/_,this._faceVY*=d/_)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(t,e){this._faceTargetX=t,this._faceTargetY=e}}var Xi;(s=>{s.CubismTargetPoint=Zs})(Xi||(Xi={}));class Ut{constructor(){n(this,"setFinishedMotionHandler",t=>this._onFinishedMotion=t);n(this,"getFinishedMotionHandler",()=>this._onFinishedMotion);n(this,"_fadeInSeconds");n(this,"_fadeOutSeconds");n(this,"_weight");n(this,"_offsetSeconds");n(this,"_firedEventValues");n(this,"_onFinishedMotion");this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=new v}static delete(t){t.release(),t=null}release(){this._weight=0}updateParameters(t,e,i){if(!e.isAvailable()||e.isFinished())return;if(!e.isStarted()){e.setIsStarted(!0),e.setStartTime(i-this._offsetSeconds),e.setFadeInStartTime(i);const o=this.getDuration();e.getEndTime()<0&&e.setEndTime(o<=0?-1:e.getStartTime()+o)}let r=this._weight;const a=this._fadeInSeconds==0?1:P.getEasingSine((i-e.getFadeInStartTime())/this._fadeInSeconds),l=this._fadeOutSeconds==0||e.getEndTime()<0?1:P.getEasingSine((e.getEndTime()-i)/this._fadeOutSeconds);r=r*a*l,e.setState(i,r),et(0<=r&&r<=1),this.doUpdateParameters(t,i,r,e),e.getEndTime()>0&&e.getEndTime()<i&&e.setIsFinished(!0)}setFadeInTime(t){this._fadeInSeconds=t}setFadeOutTime(t){this._fadeOutSeconds=t}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(t){this._weight=t}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(t){this._offsetSeconds=t}getFiredEvent(t,e){return this._firedEventValues}}var Hi;(s=>{s.ACubismMotion=Ut})(Hi||(Hi={}));const Ha="FadeInTime",Ga="FadeOutTime",Gi="Parameters",Wa="Id",qa="Value",le="Blend",$a="Add",Za="Multiply",Ja="Overwrite",Wi=1;class Te extends Ut{constructor(){super();n(this,"_parameters");this._parameters=new v}static create(e,i){const r=new Te,a=z.create(e,i),l=a.getRoot();r.setFadeInTime(l.getValueByString(Ha).toFloat(Wi)),r.setFadeOutTime(l.getValueByString(Ga).toFloat(Wi));const o=l.getValueByString(Gi).getSize();r._parameters.prepareCapacity(o);for(let h=0;h<o;++h){const u=l.getValueByString(Gi).getValueByIndex(h),g=L.getIdManager().getId(u.getValueByString(Wa).getRawString()),m=u.getValueByString(qa).toFloat();let p;u.getValueByString(le).isNull()||u.getValueByString(le).getString()==$a?p=0:u.getValueByString(le).getString()==Za?p=1:u.getValueByString(le).getString()==Ja?p=2:p=0;const c=new Qs;c.parameterId=g,c.blendType=p,c.value=m,r._parameters.pushBack(c)}return z.delete(a),r}doUpdateParameters(e,i,r,a){for(let l=0;l<this._parameters.getSize();++l){const o=this._parameters.at(l);switch(o.blendType){case 0:{e.addParameterValueById(o.parameterId,o.value,r);break}case 1:{e.multiplyParameterValueById(o.parameterId,o.value,r);break}case 2:{e.setParameterValueById(o.parameterId,o.value,r);break}}}}}var Js=(s=>(s[s.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",s[s.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",s[s.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite",s))(Js||{});class Qs{constructor(){n(this,"parameterId");n(this,"blendType");n(this,"value")}}var qi;(s=>{s.CubismExpressionMotion=Te,s.ExpressionBlendType=Js,s.ExpressionParameter=Qs})(qi||(qi={}));var pt=(s=>(s[s.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",s[s.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",s[s.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity",s))(pt||{}),J=(s=>(s[s.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",s[s.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",s[s.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",s[s.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",s))(J||{});class ri{constructor(){n(this,"time",0);n(this,"value",0)}}class Ks{constructor(){n(this,"evaluate");n(this,"basePointIndex");n(this,"segmentType");this.evaluate=null,this.basePointIndex=0,this.segmentType=0}}class tr{constructor(){n(this,"type");n(this,"id");n(this,"segmentCount");n(this,"baseSegmentIndex");n(this,"fadeInTime");n(this,"fadeOutTime");this.type=0,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}}class er{constructor(){n(this,"fireTime",0);n(this,"value")}}class ir{constructor(){n(this,"duration");n(this,"loop");n(this,"curveCount");n(this,"eventCount");n(this,"fps");n(this,"curves");n(this,"segments");n(this,"points");n(this,"events");this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new v,this.segments=new v,this.points=new v,this.events=new v}}var $i;(s=>{s.CubismMotionCurve=tr,s.CubismMotionCurveTarget=pt,s.CubismMotionData=ir,s.CubismMotionEvent=er,s.CubismMotionPoint=ri,s.CubismMotionSegment=Ks,s.CubismMotionSegmentType=J})($i||($i={}));const G="Meta",Qa="Duration",Ka="Loop",tn="AreBeziersRestricted",en="CurveCount",sn="Fps",rn="TotalSegmentCount",an="TotalPointCount",_t="Curves",nn="Target",on="Id",he="FadeInTime",ue="FadeOutTime",Zi="Segments",Ji="UserData",ln="UserDataCount",hn="TotalUserDataSize",un="Time",gn="Value";class sr{constructor(t,e){n(this,"_json");this._json=z.create(t,e)}release(){z.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(G).getValueByString(Qa).toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(G).getValueByString(Ka).toBoolean()}getEvaluationOptionFlag(t){return t==0?this._json.getRoot().getValueByString(G).getValueByString(tn).toBoolean():!1}getMotionCurveCount(){return this._json.getRoot().getValueByString(G).getValueByString(en).toInt()}getMotionFps(){return this._json.getRoot().getValueByString(G).getValueByString(sn).toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(G).getValueByString(rn).toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(G).getValueByString(an).toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(G).getValueByString(he).isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(G).getValueByString(ue).isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(G).getValueByString(he).toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(G).getValueByString(ue).toFloat()}getMotionCurveTarget(t){return this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(nn).getRawString()}getMotionCurveId(t){return L.getIdManager().getId(this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(on).getRawString())}isExistMotionCurveFadeInTime(t){return!this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(he).isNull()}isExistMotionCurveFadeOutTime(t){return!this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(ue).isNull()}getMotionCurveFadeInTime(t){return this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(he).toFloat()}getMotionCurveFadeOutTime(t){return this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(ue).toFloat()}getMotionCurveSegmentCount(t){return this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(Zi).getVector().getSize()}getMotionCurveSegment(t,e){return this._json.getRoot().getValueByString(_t).getValueByIndex(t).getValueByString(Zi).getValueByIndex(e).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(G).getValueByString(ln).toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(G).getValueByString(hn).toInt()}getEventTime(t){return this._json.getRoot().getValueByString(Ji).getValueByIndex(t).getValueByString(un).toFloat()}getEventValue(t){return new $(this._json.getRoot().getValueByString(Ji).getValueByIndex(t).getValueByString(gn).getRawString())}}var rr=(s=>(s[s.EvaluationOptionFlag_AreBeziersRistricted=0]="EvaluationOptionFlag_AreBeziersRistricted",s))(rr||{}),Qi;(s=>{s.CubismMotionJson=sr})(Qi||(Qi={}));const cn="EyeBlink",dn="LipSync",mn="Model",_n="Parameter",pn="PartOpacity",fn=!1;function q(s,t,e){const i=new ri;return i.time=s.time+(t.time-s.time)*e,i.value=s.value+(t.value-s.value)*e,i}function yn(s,t){let e=(t-s[0].time)/(s[1].time-s[0].time);return e<0&&(e=0),s[0].value+(s[1].value-s[0].value)*e}function xn(s,t){let e=(t-s[0].time)/(s[3].time-s[0].time);e<0&&(e=0);const i=q(s[0],s[1],e),r=q(s[1],s[2],e),a=q(s[2],s[3],e),l=q(i,r,e),o=q(r,a,e);return q(l,o,e).value}function Sn(s,t){const e=t,i=s[0].time,r=s[3].time,a=s[1].time,l=s[2].time,o=r-3*l+3*a-i,h=3*l-6*a+3*i,u=3*a-3*i,g=i-e,m=P.cardanoAlgorithmForBezier(o,h,u,g),p=q(s[0],s[1],m),c=q(s[1],s[2],m),d=q(s[2],s[3],m),_=q(p,c,m),f=q(c,d,m);return q(_,f,m).value}function Cn(s,t){return s[0].value}function Mn(s,t){return s[1].value}function ze(s,t,e){const i=s.curves.at(t);let r=-1;const a=i.baseSegmentIndex+i.segmentCount;let l=0;for(let h=i.baseSegmentIndex;h<a;++h)if(l=s.segments.at(h).basePointIndex+(s.segments.at(h).segmentType==J.CubismMotionSegmentType_Bezier?3:1),s.points.at(l).time>e){r=h;break}if(r==-1)return s.points.at(l).value;const o=s.segments.at(r);return o.evaluate(s.points.get(o.basePointIndex),e)}class Ie extends Ut{constructor(){super();n(this,"_sourceFrameRate");n(this,"_loopDurationSeconds");n(this,"_isLoop");n(this,"_isLoopFadeIn");n(this,"_lastWeight");n(this,"_motionData");n(this,"_eyeBlinkParameterIds");n(this,"_lipSyncParameterIds");n(this,"_modelCurveIdEyeBlink");n(this,"_modelCurveIdLipSync");this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null}static create(e,i,r){const a=new Ie;return a.parse(e,i),a._sourceFrameRate=a._motionData.fps,a._loopDurationSeconds=a._motionData.duration,a._onFinishedMotion=r,a}doUpdateParameters(e,i,r,a){this._modelCurveIdEyeBlink==null&&(this._modelCurveIdEyeBlink=L.getIdManager().getId(cn)),this._modelCurveIdLipSync==null&&(this._modelCurveIdLipSync=L.getIdManager().getId(dn));let l=i-a.getStartTime();l<0&&(l=0);let o=Number.MAX_VALUE,h=Number.MAX_VALUE;const u=64;let g=0,m=0;this._eyeBlinkParameterIds.getSize()>u&&$t("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>u&&$t("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const p=this._fadeInSeconds<=0?1:P.getEasingSine((i-a.getFadeInStartTime())/this._fadeInSeconds),c=this._fadeOutSeconds<=0||a.getEndTime()<0?1:P.getEasingSine((a.getEndTime()-i)/this._fadeOutSeconds);let d,_,f,b=l;if(this._isLoop)for(;b>this._motionData.duration;)b-=this._motionData.duration;const y=this._motionData.curves;for(_=0;_<this._motionData.curveCount&&y.at(_).type==pt.CubismMotionCurveTarget_Model;++_)d=ze(this._motionData,_,b),y.at(_).id==this._modelCurveIdEyeBlink?h=d:y.at(_).id==this._modelCurveIdLipSync&&(o=d);for(;_<this._motionData.curveCount&&y.at(_).type==pt.CubismMotionCurveTarget_Parameter;++_){if(f=e.getParameterIndex(y.at(_).id),f==-1)continue;const B=e.getParameterValueByIndex(f);if(d=ze(this._motionData,_,b),h!=Number.MAX_VALUE){for(let S=0;S<this._eyeBlinkParameterIds.getSize()&&S<u;++S)if(this._eyeBlinkParameterIds.at(S)==y.at(_).id){d*=h,m|=1<<S;break}}if(o!=Number.MAX_VALUE){for(let S=0;S<this._lipSyncParameterIds.getSize()&&S<u;++S)if(this._lipSyncParameterIds.at(S)==y.at(_).id){d+=o,g|=1<<S;break}}let T;if(y.at(_).fadeInTime<0&&y.at(_).fadeOutTime<0)T=B+(d-B)*r;else{let S,x;y.at(_).fadeInTime<0?S=p:S=y.at(_).fadeInTime==0?1:P.getEasingSine((i-a.getFadeInStartTime())/y.at(_).fadeInTime),y.at(_).fadeOutTime<0?x=c:x=y.at(_).fadeOutTime==0||a.getEndTime()<0?1:P.getEasingSine((a.getEndTime()-i)/y.at(_).fadeOutTime);const V=this._weight*S*x;T=B+(d-B)*V}e.setParameterValueByIndex(f,T,1)}{if(h!=Number.MAX_VALUE)for(let B=0;B<this._eyeBlinkParameterIds.getSize()&&B<u;++B){const T=e.getParameterValueById(this._eyeBlinkParameterIds.at(B));if(m>>B&1)continue;const S=T+(h-T)*r;e.setParameterValueById(this._eyeBlinkParameterIds.at(B),S)}if(o!=Number.MAX_VALUE)for(let B=0;B<this._lipSyncParameterIds.getSize()&&B<u;++B){const T=e.getParameterValueById(this._lipSyncParameterIds.at(B));if(g>>B&1)continue;const S=T+(o-T)*r;e.setParameterValueById(this._lipSyncParameterIds.at(B),S)}}for(;_<this._motionData.curveCount&&y.at(_).type==pt.CubismMotionCurveTarget_PartOpacity;++_)f=e.getParameterIndex(y.at(_).id),f!=-1&&(d=ze(this._motionData,_,b),e.setParameterValueByIndex(f,d));l>=this._motionData.duration&&(this._isLoop?(a.setStartTime(i),this._isLoopFadeIn&&a.setFadeInStartTime(i)):(this._onFinishedMotion&&this._onFinishedMotion(this),a.setIsFinished(!0))),this._lastWeight=r}setIsLoop(e){this._isLoop=e}isLoop(){return this._isLoop}setIsLoopFadeIn(e){this._isLoopFadeIn=e}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(e,i){const r=this._motionData.curves;for(let a=0;a<this._motionData.curveCount;++a)if(e==r.at(a).id){r.at(a).fadeInTime=i;return}}setParameterFadeOutTime(e,i){const r=this._motionData.curves;for(let a=0;a<this._motionData.curveCount;++a)if(e==r.at(a).id){r.at(a).fadeOutTime=i;return}}getParameterFadeInTime(e){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i.at(r).id)return i.at(r).fadeInTime;return-1}getParameterFadeOutTime(e){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i.at(r).id)return i.at(r).fadeOutTime;return-1}setEffectIds(e,i){this._eyeBlinkParameterIds=e,this._lipSyncParameterIds=i}release(){this._motionData=void 0,this._motionData=null}parse(e,i){this._motionData=new ir;let r=new sr(e,i);this._motionData.duration=r.getMotionDuration(),this._motionData.loop=r.isMotionLoop(),this._motionData.curveCount=r.getMotionCurveCount(),this._motionData.fps=r.getMotionFps(),this._motionData.eventCount=r.getEventCount();const a=r.getEvaluationOptionFlag(rr.EvaluationOptionFlag_AreBeziersRistricted);r.isExistMotionFadeInTime()?this._fadeInSeconds=r.getMotionFadeInTime()<0?1:r.getMotionFadeInTime():this._fadeInSeconds=1,r.isExistMotionFadeOutTime()?this._fadeOutSeconds=r.getMotionFadeOutTime()<0?1:r.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,tr,!0),this._motionData.segments.updateSize(r.getMotionTotalSegmentCount(),Ks,!0),this._motionData.points.updateSize(r.getMotionTotalPointCount(),ri,!0),this._motionData.events.updateSize(this._motionData.eventCount,er,!0);let l=0,o=0;for(let h=0;h<this._motionData.curveCount;++h){r.getMotionCurveTarget(h)==mn?this._motionData.curves.at(h).type=pt.CubismMotionCurveTarget_Model:r.getMotionCurveTarget(h)==_n?this._motionData.curves.at(h).type=pt.CubismMotionCurveTarget_Parameter:r.getMotionCurveTarget(h)==pn?this._motionData.curves.at(h).type=pt.CubismMotionCurveTarget_PartOpacity:yt('Warning : Unable to get segment type from Curve! The number of "CurveCount" may be incorrect!'),this._motionData.curves.at(h).id=r.getMotionCurveId(h),this._motionData.curves.at(h).baseSegmentIndex=o,this._motionData.curves.at(h).fadeInTime=r.isExistMotionCurveFadeInTime(h)?r.getMotionCurveFadeInTime(h):-1,this._motionData.curves.at(h).fadeOutTime=r.isExistMotionCurveFadeOutTime(h)?r.getMotionCurveFadeOutTime(h):-1;for(let u=0;u<r.getMotionCurveSegmentCount(h);){switch(u==0?(this._motionData.segments.at(o).basePointIndex=l,this._motionData.points.at(l).time=r.getMotionCurveSegment(h,u),this._motionData.points.at(l).value=r.getMotionCurveSegment(h,u+1),l+=1,u+=2):this._motionData.segments.at(o).basePointIndex=l-1,r.getMotionCurveSegment(h,u)){case J.CubismMotionSegmentType_Linear:{this._motionData.segments.at(o).segmentType=J.CubismMotionSegmentType_Linear,this._motionData.segments.at(o).evaluate=yn,this._motionData.points.at(l).time=r.getMotionCurveSegment(h,u+1),this._motionData.points.at(l).value=r.getMotionCurveSegment(h,u+2),l+=1,u+=3;break}case J.CubismMotionSegmentType_Bezier:{this._motionData.segments.at(o).segmentType=J.CubismMotionSegmentType_Bezier,a||fn?this._motionData.segments.at(o).evaluate=xn:this._motionData.segments.at(o).evaluate=Sn,this._motionData.points.at(l).time=r.getMotionCurveSegment(h,u+1),this._motionData.points.at(l).value=r.getMotionCurveSegment(h,u+2),this._motionData.points.at(l+1).time=r.getMotionCurveSegment(h,u+3),this._motionData.points.at(l+1).value=r.getMotionCurveSegment(h,u+4),this._motionData.points.at(l+2).time=r.getMotionCurveSegment(h,u+5),this._motionData.points.at(l+2).value=r.getMotionCurveSegment(h,u+6),l+=3,u+=7;break}case J.CubismMotionSegmentType_Stepped:{this._motionData.segments.at(o).segmentType=J.CubismMotionSegmentType_Stepped,this._motionData.segments.at(o).evaluate=Cn,this._motionData.points.at(l).time=r.getMotionCurveSegment(h,u+1),this._motionData.points.at(l).value=r.getMotionCurveSegment(h,u+2),l+=1,u+=3;break}case J.CubismMotionSegmentType_InverseStepped:{this._motionData.segments.at(o).segmentType=J.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(o).evaluate=Mn,this._motionData.points.at(l).time=r.getMotionCurveSegment(h,u+1),this._motionData.points.at(l).value=r.getMotionCurveSegment(h,u+2),l+=1,u+=3;break}default:{et(0);break}}++this._motionData.curves.at(h).segmentCount,++o}}for(let h=0;h<r.getEventCount();++h)this._motionData.events.at(h).fireTime=r.getEventTime(h),this._motionData.events.at(h).value=r.getEventValue(h);r.release(),r=void 0,r=null}getFiredEvent(e,i){this._firedEventValues.updateSize(0);for(let r=0;r<this._motionData.eventCount;++r)this._motionData.events.at(r).fireTime>e&&this._motionData.events.at(r).fireTime<=i&&this._firedEventValues.pushBack(new $(this._motionData.events.at(r).value.s));return this._firedEventValues}}var Ki;(s=>{s.CubismMotion=Ie})(Ki||(Ki={}));class ar{constructor(){n(this,"_autoDelete");n(this,"_motion");n(this,"_available");n(this,"_finished");n(this,"_started");n(this,"_startTimeSeconds");n(this,"_fadeInStartTimeSeconds");n(this,"_endTimeSeconds");n(this,"_stateTimeSeconds");n(this,"_stateWeight");n(this,"_lastEventCheckSeconds");n(this,"_fadeOutSeconds");n(this,"_isTriggeredFadeOut");n(this,"_motionQueueEntryHandle");this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&Ut.delete(this._motion)}setFadeOut(t){this._fadeOutSeconds=t,this._isTriggeredFadeOut=!0}startFadeOut(t,e){const i=e+t;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(t){this._startTimeSeconds=t}setFadeInStartTime(t){this._fadeInStartTimeSeconds=t}setEndTime(t){this._endTimeSeconds=t}setIsFinished(t){this._finished=t}setIsStarted(t){this._started=t}isAvailable(){return this._available}setIsAvailable(t){this._available=t}setState(t,e){this._stateTimeSeconds=t,this._stateWeight=e}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(t){this._lastEventCheckSeconds=t}isTriggeredFadeOut(){return this._isTriggeredFadeOut}getFadeOutSeconds(){return this._fadeOutSeconds}}var ts;(s=>{s.CubismMotionQueueEntry=ar})(ts||(ts={}));class nr{constructor(){n(this,"_userTimeSeconds");n(this,"_motions");n(this,"_eventCallBack");n(this,"_eventCustomData");this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new v}release(){for(let t=0;t<this._motions.getSize();++t)this._motions.at(t)&&(this._motions.at(t).release(),this._motions.set(t,null));this._motions=null}startMotion(t,e,i){if(t==null)return vt;let r=null;for(let a=0;a<this._motions.getSize();++a)r=this._motions.at(a),r==null||r.setFadeOut(r._motion.getFadeOutTime());return r=new ar,r._autoDelete=e,r._motion=t,this._motions.pushBack(r),r._motionQueueEntryHandle}isFinished(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let e=t.ptr();if(e==null){t=this._motions.erase(t);continue}if(e._motion==null){e.release(),e=null,t=this._motions.erase(t);continue}if(e.isFinished())t.preIncrement();else return!1}return!0}isFinishedByHandle(t){for(let e=this._motions.begin();e.notEqual(this._motions.end());e.increment()){const i=e.ptr();if(i!=null&&i._motionQueueEntryHandle==t&&!i.isFinished())return!1}return!0}stopAllMotions(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let e=t.ptr();if(e==null){t=this._motions.erase(t);continue}e.release(),e=null,t=this._motions.erase(t)}}getCubismMotionQueueEntry(t){for(let e=this._motions.begin();e.notEqual(this._motions.end());e.preIncrement()){const i=e.ptr();if(i!=null&&i._motionQueueEntryHandle==t)return i}return null}setEventCallback(t,e=null){this._eventCallBack=t,this._eventCustomData=e}doUpdateMotion(t,e){let i=!1;for(let r=this._motions.begin();r.notEqual(this._motions.end());){let a=r.ptr();if(a==null){r=this._motions.erase(r);continue}const l=a._motion;if(l==null){a.release(),a=null,r=this._motions.erase(r);continue}l.updateParameters(t,a,e),i=!0;const o=l.getFiredEvent(a.getLastCheckEventSeconds()-a.getStartTime(),e-a.getStartTime());for(let h=0;h<o.getSize();++h)this._eventCallBack(this,o.at(h),this._eventCustomData);a.setLastCheckEventSeconds(e),a.isFinished()?(a.release(),a=null,r=this._motions.erase(r)):(a.isTriggeredFadeOut()&&a.startFadeOut(a.getFadeOutSeconds(),e),r.preIncrement())}return i}}const vt=-1;var es;(s=>{s.CubismMotionQueueManager=nr,s.InvalidMotionQueueEntryHandleValue=vt})(es||(es={}));class Kt extends nr{constructor(){super();n(this,"_currentPriority");n(this,"_reservePriority");this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(e){this._reservePriority=e}startMotionPriority(e,i,r){return r==this._reservePriority&&(this._reservePriority=0),this._currentPriority=r,super.startMotion(e,i,this._userTimeSeconds)}updateMotion(e,i){this._userTimeSeconds+=i;const r=super.doUpdateMotion(e,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),r}reserveMotion(e){return e<=this._reservePriority||e<=this._currentPriority?!1:(this._reservePriority=e,!0)}}var is;(s=>{s.CubismMotionManager=Kt})(is||(is={}));var Se=(s=>(s[s.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",s))(Se||{}),ft=(s=>(s[s.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",s[s.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",s[s.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",s))(ft||{});class vn{constructor(){n(this,"gravity");n(this,"wind");this.gravity=new M(0,0),this.wind=new M(0,0)}}class ai{constructor(){n(this,"id");n(this,"targetType")}}class $e{constructor(){n(this,"minimum");n(this,"maximum");n(this,"defalut")}}class or{constructor(){n(this,"initialPosition");n(this,"mobility");n(this,"delay");n(this,"acceleration");n(this,"radius");n(this,"position");n(this,"lastPosition");n(this,"lastGravity");n(this,"force");n(this,"velocity");this.initialPosition=new M(0,0),this.position=new M(0,0),this.lastPosition=new M(0,0),this.lastGravity=new M(0,0),this.force=new M(0,0),this.velocity=new M(0,0)}}class lr{constructor(){n(this,"inputCount");n(this,"outputCount");n(this,"particleCount");n(this,"baseInputIndex");n(this,"baseOutputIndex");n(this,"baseParticleIndex");n(this,"normalizationPosition");n(this,"normalizationAngle");this.normalizationPosition=new $e,this.normalizationAngle=new $e}}class hr{constructor(){n(this,"source");n(this,"sourceParameterIndex");n(this,"weight");n(this,"type");n(this,"reflect");n(this,"getNormalizedParameterValue");this.source=new ai}}class ur{constructor(){n(this,"destination");n(this,"destinationParameterIndex");n(this,"vertexIndex");n(this,"translationScale");n(this,"angleScale");n(this,"weight");n(this,"type");n(this,"reflect");n(this,"valueBelowMinimum");n(this,"valueExceededMaximum");n(this,"getValue");n(this,"getScale");this.destination=new ai,this.translationScale=new M(0,0)}}class gr{constructor(){n(this,"subRigCount");n(this,"settings");n(this,"inputs");n(this,"outputs");n(this,"particles");n(this,"gravity");n(this,"wind");n(this,"fps");this.settings=new v,this.inputs=new v,this.outputs=new v,this.particles=new v,this.gravity=new M(0,0),this.wind=new M(0,0),this.fps=0}}var ss;(s=>{s.CubismPhysicsInput=hr,s.CubismPhysicsNormalization=$e,s.CubismPhysicsOutput=ur,s.CubismPhysicsParameter=ai,s.CubismPhysicsParticle=or,s.CubismPhysicsRig=gr,s.CubismPhysicsSource=ft,s.CubismPhysicsSubRig=lr,s.CubismPhysicsTargetType=Se,s.PhysicsJsonEffectiveForces=vn})(ss||(ss={}));const Yt="Position",Ne="X",Oe="Y",Ue="Angle",rs="Type",as="Id",at="Meta",ge="EffectiveForces",Bn="TotalInputCount",bn="TotalOutputCount",Pn="PhysicsSettingCount",ns="Gravity",os="Wind",wn="VertexCount",Tn="Fps",E="PhysicsSettings",It="Normalization",ls="Minimum",hs="Maximum",us="Default",gs="Reflect",cs="Weight",Xt="Input",In="Source",Ct="Output",Vn="Scale",Rn="VertexIndex",Ln="Destination",Mt="Vertices",En="Mobility",An="Delay",Fn="Radius",Dn="Acceleration";class cr{constructor(t,e){n(this,"_json");this._json=z.create(t,e)}release(){z.delete(this._json)}getGravity(){const t=new M(0,0);return t.x=this._json.getRoot().getValueByString(at).getValueByString(ge).getValueByString(ns).getValueByString(Ne).toFloat(),t.y=this._json.getRoot().getValueByString(at).getValueByString(ge).getValueByString(ns).getValueByString(Oe).toFloat(),t}getWind(){const t=new M(0,0);return t.x=this._json.getRoot().getValueByString(at).getValueByString(ge).getValueByString(os).getValueByString(Ne).toFloat(),t.y=this._json.getRoot().getValueByString(at).getValueByString(ge).getValueByString(os).getValueByString(Oe).toFloat(),t}getFps(){return this._json.getRoot().getValueByString(at).getValueByString(Tn).toFloat(0)}getSubRigCount(){return this._json.getRoot().getValueByString(at).getValueByString(Pn).toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString(at).getValueByString(Bn).toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString(at).getValueByString(bn).toInt()}getVertexCount(){return this._json.getRoot().getValueByString(at).getValueByString(wn).toInt()}getNormalizationPositionMinimumValue(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(It).getValueByString(Yt).getValueByString(ls).toFloat()}getNormalizationPositionMaximumValue(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(It).getValueByString(Yt).getValueByString(hs).toFloat()}getNormalizationPositionDefaultValue(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(It).getValueByString(Yt).getValueByString(us).toFloat()}getNormalizationAngleMinimumValue(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(It).getValueByString(Ue).getValueByString(ls).toFloat()}getNormalizationAngleMaximumValue(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(It).getValueByString(Ue).getValueByString(hs).toFloat()}getNormalizationAngleDefaultValue(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(It).getValueByString(Ue).getValueByString(us).toFloat()}getInputCount(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Xt).getVector().getSize()}getInputWeight(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Xt).getValueByIndex(e).getValueByString(cs).toFloat()}getInputReflect(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Xt).getValueByIndex(e).getValueByString(gs).toBoolean()}getInputType(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Xt).getValueByIndex(e).getValueByString(rs).getRawString()}getInputSourceId(t,e){return L.getIdManager().getId(this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Xt).getValueByIndex(e).getValueByString(In).getValueByString(as).getRawString())}getOutputCount(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getVector().getSize()}getOutputVertexIndex(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getValueByIndex(e).getValueByString(Rn).toInt()}getOutputAngleScale(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getValueByIndex(e).getValueByString(Vn).toFloat()}getOutputWeight(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getValueByIndex(e).getValueByString(cs).toFloat()}getOutputDestinationId(t,e){return L.getIdManager().getId(this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getValueByIndex(e).getValueByString(Ln).getValueByString(as).getRawString())}getOutputType(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getValueByIndex(e).getValueByString(rs).getRawString()}getOutputReflect(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Ct).getValueByIndex(e).getValueByString(gs).toBoolean()}getParticleCount(t){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getVector().getSize()}getParticleMobility(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getValueByIndex(e).getValueByString(En).toFloat()}getParticleDelay(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getValueByIndex(e).getValueByString(An).toFloat()}getParticleAcceleration(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getValueByIndex(e).getValueByString(Dn).toFloat()}getParticleRadius(t,e){return this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getValueByIndex(e).getValueByString(Fn).toFloat()}getParticlePosition(t,e){const i=new M(0,0);return i.x=this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getValueByIndex(e).getValueByString(Yt).getValueByString(Ne).toFloat(),i.y=this._json.getRoot().getValueByString(E).getValueByIndex(t).getValueByString(Mt).getValueByIndex(e).getValueByString(Yt).getValueByString(Oe).toFloat(),i}}var ds;(s=>{s.CubismPhysicsJson=cr})(ds||(ds={}));const ms="X",_s="Y",ps="Angle",kn=5,Ze=100,fs=.001,zn=5;class te{constructor(){n(this,"_physicsRig");n(this,"_options");n(this,"_currentRigOutputs");n(this,"_previousRigOutputs");n(this,"_currentRemainTime");n(this,"_parameterCaches");n(this,"_parameterInputCaches");this._physicsRig=null,this._options=new dr,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0,this._currentRigOutputs=new v,this._previousRigOutputs=new v,this._currentRemainTime=0,this._parameterCaches=null,this._parameterInputCaches=null}static create(t,e){const i=new te;return i.parse(t,e),i._physicsRig.gravity.y=0,i}static delete(t){t!=null&&(t.release(),t=null)}parse(t,e){this._physicsRig=new gr;let i=new cr(t,e);this._physicsRig.gravity=i.getGravity(),this._physicsRig.wind=i.getWind(),this._physicsRig.subRigCount=i.getSubRigCount(),this._physicsRig.fps=i.getFps(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,lr,!0),this._physicsRig.inputs.updateSize(i.getTotalInputCount(),hr,!0),this._physicsRig.outputs.updateSize(i.getTotalOutputCount(),ur,!0),this._physicsRig.particles.updateSize(i.getVertexCount(),or,!0),this._currentRigOutputs.clear(),this._previousRigOutputs.clear();let r=0,a=0,l=0;for(let o=0;o<this._physicsRig.settings.getSize();++o){this._physicsRig.settings.at(o).normalizationPosition.minimum=i.getNormalizationPositionMinimumValue(o),this._physicsRig.settings.at(o).normalizationPosition.maximum=i.getNormalizationPositionMaximumValue(o),this._physicsRig.settings.at(o).normalizationPosition.defalut=i.getNormalizationPositionDefaultValue(o),this._physicsRig.settings.at(o).normalizationAngle.minimum=i.getNormalizationAngleMinimumValue(o),this._physicsRig.settings.at(o).normalizationAngle.maximum=i.getNormalizationAngleMaximumValue(o),this._physicsRig.settings.at(o).normalizationAngle.defalut=i.getNormalizationAngleDefaultValue(o),this._physicsRig.settings.at(o).inputCount=i.getInputCount(o),this._physicsRig.settings.at(o).baseInputIndex=r;for(let g=0;g<this._physicsRig.settings.at(o).inputCount;++g)this._physicsRig.inputs.at(r+g).sourceParameterIndex=-1,this._physicsRig.inputs.at(r+g).weight=i.getInputWeight(o,g),this._physicsRig.inputs.at(r+g).reflect=i.getInputReflect(o,g),i.getInputType(o,g)==ms?(this._physicsRig.inputs.at(r+g).type=ft.CubismPhysicsSource_X,this._physicsRig.inputs.at(r+g).getNormalizedParameterValue=On):i.getInputType(o,g)==_s?(this._physicsRig.inputs.at(r+g).type=ft.CubismPhysicsSource_Y,this._physicsRig.inputs.at(r+g).getNormalizedParameterValue=Un):i.getInputType(o,g)==ps&&(this._physicsRig.inputs.at(r+g).type=ft.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(r+g).getNormalizedParameterValue=jn),this._physicsRig.inputs.at(r+g).source.targetType=Se.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(r+g).source.id=i.getInputSourceId(o,g);r+=this._physicsRig.settings.at(o).inputCount,this._physicsRig.settings.at(o).outputCount=i.getOutputCount(o),this._physicsRig.settings.at(o).baseOutputIndex=a;const h=new ys;h.outputs.resize(this._physicsRig.settings.at(o).outputCount);const u=new ys;u.outputs.resize(this._physicsRig.settings.at(o).outputCount);for(let g=0;g<this._physicsRig.settings.at(o).outputCount;++g)h.outputs[g]=0,u.outputs[g]=0,this._physicsRig.outputs.at(a+g).destinationParameterIndex=-1,this._physicsRig.outputs.at(a+g).vertexIndex=i.getOutputVertexIndex(o,g),this._physicsRig.outputs.at(a+g).angleScale=i.getOutputAngleScale(o,g),this._physicsRig.outputs.at(a+g).weight=i.getOutputWeight(o,g),this._physicsRig.outputs.at(a+g).destination.targetType=Se.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(a+g).destination.id=i.getOutputDestinationId(o,g),i.getOutputType(o,g)==ms?(this._physicsRig.outputs.at(a+g).type=ft.CubismPhysicsSource_X,this._physicsRig.outputs.at(a+g).getValue=Yn,this._physicsRig.outputs.at(a+g).getScale=qn):i.getOutputType(o,g)==_s?(this._physicsRig.outputs.at(a+g).type=ft.CubismPhysicsSource_Y,this._physicsRig.outputs.at(a+g).getValue=Xn,this._physicsRig.outputs.at(a+g).getScale=$n):i.getOutputType(o,g)==ps&&(this._physicsRig.outputs.at(a+g).type=ft.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(a+g).getValue=Hn,this._physicsRig.outputs.at(a+g).getScale=Zn),this._physicsRig.outputs.at(a+g).reflect=i.getOutputReflect(o,g);this._currentRigOutputs.pushBack(h),this._previousRigOutputs.pushBack(u),a+=this._physicsRig.settings.at(o).outputCount,this._physicsRig.settings.at(o).particleCount=i.getParticleCount(o),this._physicsRig.settings.at(o).baseParticleIndex=l;for(let g=0;g<this._physicsRig.settings.at(o).particleCount;++g)this._physicsRig.particles.at(l+g).mobility=i.getParticleMobility(o,g),this._physicsRig.particles.at(l+g).delay=i.getParticleDelay(o,g),this._physicsRig.particles.at(l+g).acceleration=i.getParticleAcceleration(o,g),this._physicsRig.particles.at(l+g).radius=i.getParticleRadius(o,g),this._physicsRig.particles.at(l+g).position=i.getParticlePosition(o,g);l+=this._physicsRig.settings.at(o).particleCount}this.initialize(),i.release(),i=void 0,i=null}stabilization(t){var _,f;let e,i,r,a;const l=new M;let o,h,u,g,m,p,c,d;m=t.getModel().parameters.values,p=t.getModel().parameters.maximumValues,c=t.getModel().parameters.minimumValues,d=t.getModel().parameters.defaultValues,(((_=this._parameterCaches)==null?void 0:_.length)??0)<t.getParameterCount()&&(this._parameterCaches=new Float32Array(t.getParameterCount())),(((f=this._parameterInputCaches)==null?void 0:f.length)??0)<t.getParameterCount()&&(this._parameterInputCaches=new Float32Array(t.getParameterCount()));for(let b=0;b<t.getParameterCount();++b)this._parameterCaches[b]=m[b],this._parameterInputCaches[b]=m[b];for(let b=0;b<this._physicsRig.subRigCount;++b){e={angle:0},l.x=0,l.y=0,o=this._physicsRig.settings.at(b),h=this._physicsRig.inputs.get(o.baseInputIndex),u=this._physicsRig.outputs.get(o.baseOutputIndex),g=this._physicsRig.particles.get(o.baseParticleIndex);for(let y=0;y<o.inputCount;++y)i=h[y].weight/Ze,h[y].sourceParameterIndex==-1&&(h[y].sourceParameterIndex=t.getParameterIndex(h[y].source.id)),h[y].getNormalizedParameterValue(l,e,m[h[y].sourceParameterIndex],c[h[y].sourceParameterIndex],p[h[y].sourceParameterIndex],d[h[y].sourceParameterIndex],o.normalizationPosition,o.normalizationAngle,h[y].reflect,i),this._parameterCaches[h[y].sourceParameterIndex]=m[h[y].sourceParameterIndex];r=P.degreesToRadian(-e.angle),l.x=l.x*P.cos(r)-l.y*P.sin(r),l.y=l.x*P.sin(r)+l.y*P.cos(r),Qn(g,o.particleCount,l,e.angle,this._options.wind,fs*o.normalizationPosition.maximum);for(let y=0;y<o.outputCount;++y){const B=u[y].vertexIndex;if(u[y].destinationParameterIndex==-1&&(u[y].destinationParameterIndex=t.getParameterIndex(u[y].destination.id)),B<1||B>=o.particleCount)continue;let T=new M;T=g[B].position.substract(g[B-1].position),a=u[y].getValue(T,g,B,u[y].reflect,this._options.gravity),this._currentRigOutputs.at(b).outputs[y]=a,this._previousRigOutputs.at(b).outputs[y]=a;const S=u[y].destinationParameterIndex,x=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(m.subarray(S))):m.slice(S);je(x,c[S],p[S],a,u[y]);for(let V=S,Y=0;V<this._parameterCaches.length;V++,Y++)m[V]=this._parameterCaches[V]=x[Y]}}}evaluate(t,e){var y,B;let i,r,a,l;const o=new M;let h,u,g,m;if(0>=e)return;let p,c,d,_,f;if(this._currentRemainTime+=e,this._currentRemainTime>zn&&(this._currentRemainTime=0),p=t.getModel().parameters.values,c=t.getModel().parameters.maximumValues,d=t.getModel().parameters.minimumValues,_=t.getModel().parameters.defaultValues,(((y=this._parameterCaches)==null?void 0:y.length)??0)<t.getParameterCount()&&(this._parameterCaches=new Float32Array(t.getParameterCount())),(((B=this._parameterInputCaches)==null?void 0:B.length)??0)<t.getParameterCount()){this._parameterInputCaches=new Float32Array(t.getParameterCount());for(let T=0;T<t.getParameterCount();++T)this._parameterInputCaches[T]=p[T]}for(this._physicsRig.fps>0?f=1/this._physicsRig.fps:f=e;this._currentRemainTime>=f;){for(let S=0;S<this._physicsRig.subRigCount;++S){h=this._physicsRig.settings.at(S),g=this._physicsRig.outputs.get(h.baseOutputIndex);for(let x=0;x<h.outputCount;++x)this._previousRigOutputs.at(S).outputs[x]=this._currentRigOutputs.at(S).outputs[x]}const T=f/this._currentRemainTime;for(let S=0;S<t.getParameterCount();++S)this._parameterCaches[S]=this._parameterInputCaches[S]*(1-T)+p[S]*T,this._parameterInputCaches[S]=this._parameterCaches[S];for(let S=0;S<this._physicsRig.subRigCount;++S){i={angle:0},o.x=0,o.y=0,h=this._physicsRig.settings.at(S),u=this._physicsRig.inputs.get(h.baseInputIndex),g=this._physicsRig.outputs.get(h.baseOutputIndex),m=this._physicsRig.particles.get(h.baseParticleIndex);for(let x=0;x<h.inputCount;++x)r=u[x].weight/Ze,u[x].sourceParameterIndex==-1&&(u[x].sourceParameterIndex=t.getParameterIndex(u[x].source.id)),u[x].getNormalizedParameterValue(o,i,this._parameterCaches[u[x].sourceParameterIndex],d[u[x].sourceParameterIndex],c[u[x].sourceParameterIndex],_[u[x].sourceParameterIndex],h.normalizationPosition,h.normalizationAngle,u[x].reflect,r);a=P.degreesToRadian(-i.angle),o.x=o.x*P.cos(a)-o.y*P.sin(a),o.y=o.x*P.sin(a)+o.y*P.cos(a),Jn(m,h.particleCount,o,i.angle,this._options.wind,fs*h.normalizationPosition.maximum,f,kn);for(let x=0;x<h.outputCount;++x){const V=g[x].vertexIndex;if(g[x].destinationParameterIndex==-1&&(g[x].destinationParameterIndex=t.getParameterIndex(g[x].destination.id)),V<1||V>=h.particleCount)continue;const Y=new M;Y.x=m[V].position.x-m[V-1].position.x,Y.y=m[V].position.y-m[V-1].position.y,l=g[x].getValue(Y,m,V,g[x].reflect,this._options.gravity),this._currentRigOutputs.at(S).outputs[x]=l;const R=g[x].destinationParameterIndex,ct=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(this._parameterCaches.subarray(R))):this._parameterCaches.slice(R);je(ct,d[R],c[R],l,g[x]);for(let st=R,St=0;st<this._parameterCaches.length;st++,St++)this._parameterCaches[st]=ct[St]}}this._currentRemainTime-=f}const b=this._currentRemainTime/f;this.interpolate(t,b)}interpolate(t,e){let i,r,a,l,o;a=t.getModel().parameters.values,l=t.getModel().parameters.maximumValues,o=t.getModel().parameters.minimumValues;for(let h=0;h<this._physicsRig.subRigCount;++h){r=this._physicsRig.settings.at(h),i=this._physicsRig.outputs.get(r.baseOutputIndex);for(let u=0;u<r.outputCount;++u){if(i[u].destinationParameterIndex==-1)continue;const g=i[u].destinationParameterIndex,m=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(a.subarray(g))):a.slice(g);je(m,o[g],l[g],this._previousRigOutputs.at(h).outputs[u]*(1-e)+this._currentRigOutputs.at(h).outputs[u]*e,i[u]);for(let p=g,c=0;p<a.length;p++,c++)a[p]=m[c]}}}setOptions(t){this._options=t}getOption(){return this._options}release(){this._physicsRig=void 0,this._physicsRig=null}initialize(){let t,e,i;for(let r=0;r<this._physicsRig.subRigCount;++r){e=this._physicsRig.settings.at(r),t=this._physicsRig.particles.get(e.baseParticleIndex),t[0].initialPosition=new M(0,0),t[0].lastPosition=new M(t[0].initialPosition.x,t[0].initialPosition.y),t[0].lastGravity=new M(0,-1),t[0].lastGravity.y*=-1,t[0].velocity=new M(0,0),t[0].force=new M(0,0);for(let a=1;a<e.particleCount;++a)i=new M(0,0),i.y=t[a].radius,t[a].initialPosition=new M(t[a-1].initialPosition.x+i.x,t[a-1].initialPosition.y+i.y),t[a].position=new M(t[a].initialPosition.x,t[a].initialPosition.y),t[a].lastPosition=new M(t[a].initialPosition.x,t[a].initialPosition.y),t[a].lastGravity=new M(0,-1),t[a].lastGravity.y*=-1,t[a].velocity=new M(0,0),t[a].force=new M(0,0)}}}class dr{constructor(){n(this,"gravity");n(this,"wind");this.gravity=new M(0,0),this.wind=new M(0,0)}}class ys{constructor(){n(this,"outputs");this.outputs=new v(0)}}function Nn(s){let t=0;return s>0?t=1:s<0&&(t=-1),t}function On(s,t,e,i,r,a,l,o,h,u){s.x+=ni(e,i,r,a,l.minimum,l.maximum,l.defalut,h)*u}function Un(s,t,e,i,r,a,l,o,h,u){s.y+=ni(e,i,r,a,l.minimum,l.maximum,l.defalut,h)*u}function jn(s,t,e,i,r,a,l,o,h,u){t.angle+=ni(e,i,r,a,o.minimum,o.maximum,o.defalut,h)*u}function Yn(s,t,e,i,r){let a=s.x;return i&&(a*=-1),a}function Xn(s,t,e,i,r){let a=s.y;return i&&(a*=-1),a}function Hn(s,t,e,i,r){let a;return e>=2?r=t[e-1].position.substract(t[e-2].position):r=r.multiplyByScaler(-1),a=P.directionToRadian(r,s),i&&(a*=-1),a}function Gn(s,t){const e=P.max(s,t),i=P.min(s,t);return P.abs(e-i)}function Wn(s,t){return P.min(s,t)+Gn(s,t)/2}function qn(s,t){return JSON.parse(JSON.stringify(s.x))}function $n(s,t){return JSON.parse(JSON.stringify(s.y))}function Zn(s,t){return JSON.parse(JSON.stringify(t))}function Jn(s,t,e,i,r,a,l,o){let h,u,g,m,p=new M(0,0),c=new M(0,0),d=new M(0,0),_=new M(0,0);s[0].position=new M(e.x,e.y),h=P.degreesToRadian(i),m=P.radianToDirection(h),m.normalize();for(let f=1;f<t;++f)s[f].force=m.multiplyByScaler(s[f].acceleration).add(r),s[f].lastPosition=new M(s[f].position.x,s[f].position.y),u=s[f].delay*l*30,p=s[f].position.substract(s[f-1].position),g=P.directionToRadian(s[f].lastGravity,m)/o,p.x=P.cos(g)*p.x-p.y*P.sin(g),p.y=P.sin(g)*p.x+p.y*P.cos(g),s[f].position=s[f-1].position.add(p),c=s[f].velocity.multiplyByScaler(u),d=s[f].force.multiplyByScaler(u).multiplyByScaler(u),s[f].position=s[f].position.add(c).add(d),_=s[f].position.substract(s[f-1].position),_.normalize(),s[f].position=s[f-1].position.add(_.multiplyByScaler(s[f].radius)),P.abs(s[f].position.x)<a&&(s[f].position.x=0),u!=0&&(s[f].velocity=s[f].position.substract(s[f].lastPosition),s[f].velocity=s[f].velocity.divisionByScalar(u),s[f].velocity=s[f].velocity.multiplyByScaler(s[f].mobility)),s[f].force=new M(0,0),s[f].lastGravity=new M(m.x,m.y)}function Qn(s,t,e,i,r,a){let l,o,h=new M(0,0);s[0].position=new M(e.x,e.y),l=P.degreesToRadian(i),o=P.radianToDirection(l),o.normalize();for(let u=1;u<t;++u)s[u].force=o.multiplyByScaler(s[u].acceleration).add(r),s[u].lastPosition=new M(s[u].position.x,s[u].position.y),s[u].velocity=new M(0,0),h=s[u].force,h.normalize(),h=h.multiplyByScaler(s[u].radius),s[u].position=s[u-1].position.add(h),P.abs(s[u].position.x)<a&&(s[u].position.x=0),s[u].force=new M(0,0),s[u].lastGravity=new M(o.x,o.y)}function je(s,t,e,i,r){let a,l,o;a=r.getScale(r.translationScale,r.angleScale),l=i*a,l<t?(l<r.valueBelowMinimum&&(r.valueBelowMinimum=l),l=t):l>e&&(l>r.valueExceededMaximum&&(r.valueExceededMaximum=l),l=e),o=r.weight/Ze,o>=1||(l=s[0]*(1-o)+l*o),s[0]=l}function ni(s,t,e,i,r,a,l,o){let h=0;const u=P.max(e,t);u<s&&(s=u);const g=P.min(e,t);g>s&&(s=g);const m=P.min(r,a),p=P.max(r,a),c=l,d=Wn(g,u),_=s-d;switch(Nn(_)){case 1:{const f=p-c,b=u-d;b!=0&&(h=_*(f/b),h+=c);break}case-1:{const f=m-c,b=g-d;b!=0&&(h=_*(f/b),h+=c);break}case 0:{h=c;break}}return o?h:h*-1}var xs;(s=>{s.CubismPhysics=te,s.Options=dr})(xs||(xs={}));class Ce{constructor(t,e,i,r){n(this,"x");n(this,"y");n(this,"width");n(this,"height");this.x=t,this.y=e,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}expand(t,e){this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2}}var Ss;(s=>{s.csmRect=Ce})(Ss||(Ss={}));const ce=4,Kn=36,to=32,eo=10;let Vt,ht,Me;class Je{constructor(){n(this,"_currentMaskRenderTexture");n(this,"_maskRenderTextures");n(this,"_maskColorBuffers");n(this,"_currentFrameNo");n(this,"_channelColors");n(this,"_maskTexture");n(this,"_clippingContextListForMask");n(this,"_clippingContextListForDraw");n(this,"_clippingMaskBufferSize");n(this,"_renderTextureCount");n(this,"_tmpMatrix");n(this,"_tmpMatrixForMask");n(this,"_tmpMatrixForDraw");n(this,"_tmpBoundsOnModel");n(this,"_clearedFrameBufferflags");n(this,"gl");this._currentMaskRenderTexture=null,this._maskColorBuffers=null,this._currentFrameNo=0,this._renderTextureCount=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new v,this._clippingContextListForDraw=new v,this._channelColors=new v,this._tmpBoundsOnModel=new Ce,this._tmpMatrix=new k,this._tmpMatrixForMask=new k,this._tmpMatrixForDraw=new k,this._maskTexture=null;let t=new gt;t.R=1,t.G=0,t.B=0,t.A=0,this._channelColors.pushBack(t),t=new gt,t.R=0,t.G=1,t.B=0,t.A=0,this._channelColors.pushBack(t),t=new gt,t.R=0,t.G=0,t.B=1,t.A=0,this._channelColors.pushBack(t),t=new gt,t.R=0,t.G=0,t.B=0,t.A=1,this._channelColors.pushBack(t)}getChannelFlagAsColor(t){return this._channelColors.at(t)}getMaskRenderTexture(){if(this._maskTexture&&this._maskTexture.textures!=null)this._maskTexture.frameNo=this._currentFrameNo;else{this._maskRenderTextures!=null&&this._maskRenderTextures.clear(),this._maskRenderTextures=new v,this._maskColorBuffers!=null&&this._maskColorBuffers.clear(),this._maskColorBuffers=new v;const t=this._clippingMaskBufferSize;for(let e=0;e<this._renderTextureCount;e++)this._maskColorBuffers.pushBack(this.gl.createTexture()),this.gl.bindTexture(this.gl.TEXTURE_2D,this._maskColorBuffers.at(e)),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this._maskRenderTextures.pushBack(this.gl.createFramebuffer()),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTextures.at(e)),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._maskColorBuffers.at(e),0);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Me),this._maskTexture=new mr(this._currentFrameNo,this._maskRenderTextures)}return this._maskTexture.textures}setGL(t){this.gl=t}calcClippedDrawTotalBounds(t,e){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,a=Number.MIN_VALUE,l=Number.MIN_VALUE;const o=e._clippedDrawableIndexList.length;for(let h=0;h<o;h++){const u=e._clippedDrawableIndexList[h],g=t.getDrawableVertexCount(u),m=t.getDrawableVertices(u);let p=Number.MAX_VALUE,c=Number.MAX_VALUE,d=-Number.MAX_VALUE,_=-Number.MAX_VALUE;const f=g*xt.vertexStep;for(let b=xt.vertexOffset;b<f;b+=xt.vertexStep){const y=m[b],B=m[b+1];y<p&&(p=y),y>d&&(d=y),B<c&&(c=B),B>_&&(_=B)}if(p!=Number.MAX_VALUE)if(p<i&&(i=p),c<r&&(r=c),d>a&&(a=d),_>l&&(l=_),i==Number.MAX_VALUE)e._allClippedDrawRect.x=0,e._allClippedDrawRect.y=0,e._allClippedDrawRect.width=0,e._allClippedDrawRect.height=0,e._isUsing=!1;else{e._isUsing=!0;const b=a-i,y=l-r;e._allClippedDrawRect.x=i,e._allClippedDrawRect.y=r,e._allClippedDrawRect.width=b,e._allClippedDrawRect.height=y}}}release(){for(let t=0;t<this._clippingContextListForMask.getSize();t++)this._clippingContextListForMask.at(t)&&(this._clippingContextListForMask.at(t).release(),this._clippingContextListForMask.set(t,void 0)),this._clippingContextListForMask.set(t,null);this._clippingContextListForMask=null;for(let t=0;t<this._clippingContextListForDraw.getSize();t++)this._clippingContextListForDraw.set(t,null);if(this._clippingContextListForDraw=null,this._maskTexture){for(let t=0;t<this._maskTexture.textures.getSize();t++)this.gl.deleteFramebuffer(this._maskTexture.textures.at(t));this._maskTexture.textures.clear(),this._maskTexture.textures=null,this._maskTexture=null}for(let t=0;t<this._channelColors.getSize();t++)this._channelColors.set(t,null);if(this._channelColors=null,this._maskColorBuffers!=null){for(let t=0;t<this._maskColorBuffers.getSize();t++)this.gl.deleteTexture(this._maskColorBuffers.at(t));this._maskColorBuffers.clear()}this._maskColorBuffers=null,this._maskRenderTextures!=null&&this._maskRenderTextures.clear(),this._maskRenderTextures=null,this._clearedFrameBufferflags!=null&&this._clearedFrameBufferflags.clear(),this._clearedFrameBufferflags=null}initialize(t,e,i,r,a){a%1!=0&&(yt("The number of render textures must be specified as an integer. The decimal point is rounded down and corrected to an integer."),a=~~a),a<1&&yt("The number of render textures must be an integer greater than or equal to 1. Set the number of render textures to 1."),this._renderTextureCount=a<1?1:a,this._clearedFrameBufferflags=new v(this._renderTextureCount);for(let l=0;l<e;l++){if(r[l]<=0){this._clippingContextListForDraw.pushBack(null);continue}let o=this.findSameClip(i[l],r[l]);o==null&&(o=new _r(this,i[l],r[l]),this._clippingContextListForMask.pushBack(o)),o.addClippedDrawable(l),this._clippingContextListForDraw.pushBack(o)}}setupClippingContext(t,e){this._currentFrameNo++;let i=0;for(let r=0;r<this._clippingContextListForMask.getSize();r++){const a=this._clippingContextListForMask.at(r);this.calcClippedDrawTotalBounds(t,a),a._isUsing&&i++}if(i>0){this.setupLayoutBounds(e.isUsingHighPrecisionMask()?0:i),e.isUsingHighPrecisionMask()||(this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._currentMaskRenderTexture=this.getMaskRenderTexture().at(0),e.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture)),this._clearedFrameBufferflags.getSize()!=this._renderTextureCount&&(this._clearedFrameBufferflags.clear(),this._clearedFrameBufferflags=new v(this._renderTextureCount));for(let r=0;r<this._clearedFrameBufferflags.getSize();r++)this._clearedFrameBufferflags[r]=!1;for(let r=0;r<this._clippingContextListForMask.getSize();r++){const a=this._clippingContextListForMask.at(r),l=a._allClippedDrawRect,o=a._layoutBounds,h=.05;let u=0,g=0;const m=this.getMaskRenderTexture().at(a._bufferIndex);if(this._currentMaskRenderTexture!=m&&!e.isUsingHighPrecisionMask()&&(this._currentMaskRenderTexture=m,e.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._currentMaskRenderTexture)),e.isUsingHighPrecisionMask()){const p=t.getPixelsPerUnit(),c=a.getClippingManager()._clippingMaskBufferSize,d=o.width*c,_=o.height*c;this._tmpBoundsOnModel.setRect(l),this._tmpBoundsOnModel.width*p>d?(this._tmpBoundsOnModel.expand(l.width*h,0),u=o.width/this._tmpBoundsOnModel.width):u=p/d,this._tmpBoundsOnModel.height*p>_?(this._tmpBoundsOnModel.expand(0,l.height*h),g=o.height/this._tmpBoundsOnModel.height):g=p/_}else this._tmpBoundsOnModel.setRect(l),this._tmpBoundsOnModel.expand(l.width*h,l.height*h),u=o.width/this._tmpBoundsOnModel.width,g=o.height/this._tmpBoundsOnModel.height;if(this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(u,g),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(u,g),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),a._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),a._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray()),!e.isUsingHighPrecisionMask()){const p=a._clippingIdCount;for(let c=0;c<p;c++){const d=a._clippingIdList[c];t.getDrawableDynamicFlagVertexPositionsDidChange(d)&&(e.setIsCulling(t.getDrawableCulling(d)!=!1),this._clearedFrameBufferflags[a._bufferIndex]||(this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this._clearedFrameBufferflags[a._bufferIndex]=!0),e.setClippingContextBufferForMask(a),e.drawMesh(t.getDrawableTextureIndex(d),t.getDrawableVertexIndexCount(d),t.getDrawableVertexCount(d),t.getDrawableVertexIndices(d),t.getDrawableVertices(d),t.getDrawableVertexUvs(d),t.getMultiplyColor(d),t.getScreenColor(d),t.getDrawableOpacity(d),it.CubismBlendMode_Normal,!1))}}}e.isUsingHighPrecisionMask()||(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Me),e.setClippingContextBufferForMask(null),this.gl.viewport(ht[0],ht[1],ht[2],ht[3]))}}findSameClip(t,e){for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),a=r._clippingIdCount;if(a!=e)continue;let l=0;for(let o=0;o<a;o++){const h=r._clippingIdList[o];for(let u=0;u<a;u++)if(t[u]==h){l++;break}}if(l==a)return r}return null}setupLayoutBounds(t){const e=this._renderTextureCount<=1?Kn:to*this._renderTextureCount;if(t<=0||t>e){t>e&&X(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,t-e,this._renderTextureCount,t);for(let u=0;u<this._clippingContextListForMask.getSize();u++){const g=this._clippingContextListForMask.at(u);g._layoutChannelNo=0,g._layoutBounds.x=0,g._layoutBounds.y=0,g._layoutBounds.width=1,g._layoutBounds.height=1,g._bufferIndex=0}return}const i=this._renderTextureCount<=1?9:8;let r=t/this._renderTextureCount,a=t%this._renderTextureCount;r=~~r,a=~~a;let l=r/ce,o=r%ce;l=~~l,o=~~o;let h=0;for(let u=0;u<this._renderTextureCount;u++)for(let g=0;g<ce;g++){let m=l+(g<o?1:0);const p=o+1>=ce?0:o+1;if(m<i&&g==p&&(m+=u<a?1:0),m!=0)if(m==1){const c=this._clippingContextListForMask.at(h++);c._layoutChannelNo=g,c._layoutBounds.x=0,c._layoutBounds.y=0,c._layoutBounds.width=1,c._layoutBounds.height=1,c._bufferIndex=u}else if(m==2)for(let c=0;c<m;c++){let d=c%2;d=~~d;const _=this._clippingContextListForMask.at(h++);_._layoutChannelNo=g,_._layoutBounds.x=d*.5,_._layoutBounds.y=0,_._layoutBounds.width=.5,_._layoutBounds.height=1,_._bufferIndex=u}else if(m<=4)for(let c=0;c<m;c++){let d=c%2,_=c/2;d=~~d,_=~~_;const f=this._clippingContextListForMask.at(h++);f._layoutChannelNo=g,f._layoutBounds.x=d*.5,f._layoutBounds.y=_*.5,f._layoutBounds.width=.5,f._layoutBounds.height=.5,f._bufferIndex=u}else if(m<=i)for(let c=0;c<m;c++){let d=c%3,_=c/3;d=~~d,_=~~_;const f=this._clippingContextListForMask.at(h++);f._layoutChannelNo=g,f._layoutBounds.x=d/3,f._layoutBounds.y=_/3,f._layoutBounds.width=1/3,f._layoutBounds.height=1/3,f._bufferIndex=u}else{X(`not supported mask count : {0}
[Details] render texture count : {1}, mask count : {2}`,t-e,this._renderTextureCount,t);for(let c=0;c<m;c++){const d=this._clippingContextListForMask.at(h++);d._layoutChannelNo=0,d._layoutBounds.x=0,d._layoutBounds.y=0,d._layoutBounds.width=1,d._layoutBounds.height=1,d._bufferIndex=0}}}}getColorBuffer(){return this._maskColorBuffers}getClippingContextListForDraw(){return this._clippingContextListForDraw}getClippingMaskCount(){return this._clippingContextListForMask.getSize()}setClippingMaskBufferSize(t){this._clippingMaskBufferSize=t}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}getRenderTextureCount(){return this._renderTextureCount}}class mr{constructor(t,e){n(this,"frameNo");n(this,"textures");this.frameNo=t,this.textures=e}}class _r{constructor(t,e,i){n(this,"_isUsing");n(this,"_clippingIdList");n(this,"_clippingIdCount");n(this,"_layoutChannelNo");n(this,"_layoutBounds");n(this,"_allClippedDrawRect");n(this,"_matrixForMask");n(this,"_matrixForDraw");n(this,"_clippedDrawableIndexList");n(this,"_bufferIndex");n(this,"_owner");this._owner=t,this._clippingIdList=e,this._clippingIdCount=i,this._allClippedDrawRect=new Ce,this._layoutBounds=new Ce,this._clippedDrawableIndexList=[],this._matrixForMask=new k,this._matrixForDraw=new k,this._bufferIndex=0}release(){this._layoutBounds!=null&&(this._layoutBounds=null),this._allClippedDrawRect!=null&&(this._allClippedDrawRect=null),this._clippedDrawableIndexList!=null&&(this._clippedDrawableIndexList=null)}addClippedDrawable(t){this._clippedDrawableIndexList.push(t)}getClippingManager(){return this._owner}setGl(t){this._owner.setGL(t)}}class io{constructor(){n(this,"_lastArrayBufferBinding");n(this,"_lastElementArrayBufferBinding");n(this,"_lastProgram");n(this,"_lastActiveTexture");n(this,"_lastTexture0Binding2D");n(this,"_lastTexture1Binding2D");n(this,"_lastVertexAttribArrayEnabled");n(this,"_lastScissorTest");n(this,"_lastBlend");n(this,"_lastStencilTest");n(this,"_lastDepthTest");n(this,"_lastCullFace");n(this,"_lastFrontFace");n(this,"_lastColorMask");n(this,"_lastBlending");n(this,"_lastFBO");n(this,"_lastViewport");n(this,"gl");this._lastVertexAttribArrayEnabled=new Array(4),this._lastColorMask=new Array(4),this._lastBlending=new Array(4),this._lastViewport=new Array(4)}setGlEnable(t,e){e?this.gl.enable(t):this.gl.disable(t)}setGlEnableVertexAttribArray(t,e){e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)}save(){if(this.gl==null){X(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this._lastArrayBufferBinding=this.gl.getParameter(this.gl.ARRAY_BUFFER_BINDING),this._lastElementArrayBufferBinding=this.gl.getParameter(this.gl.ELEMENT_ARRAY_BUFFER_BINDING),this._lastProgram=this.gl.getParameter(this.gl.CURRENT_PROGRAM),this._lastActiveTexture=this.gl.getParameter(this.gl.ACTIVE_TEXTURE),this.gl.activeTexture(this.gl.TEXTURE1),this._lastTexture1Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this.gl.activeTexture(this.gl.TEXTURE0),this._lastTexture0Binding2D=this.gl.getParameter(this.gl.TEXTURE_BINDING_2D),this._lastVertexAttribArrayEnabled[0]=this.gl.getVertexAttrib(0,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[1]=this.gl.getVertexAttrib(1,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[2]=this.gl.getVertexAttrib(2,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastVertexAttribArrayEnabled[3]=this.gl.getVertexAttrib(3,this.gl.VERTEX_ATTRIB_ARRAY_ENABLED),this._lastScissorTest=this.gl.isEnabled(this.gl.SCISSOR_TEST),this._lastStencilTest=this.gl.isEnabled(this.gl.STENCIL_TEST),this._lastDepthTest=this.gl.isEnabled(this.gl.DEPTH_TEST),this._lastCullFace=this.gl.isEnabled(this.gl.CULL_FACE),this._lastBlend=this.gl.isEnabled(this.gl.BLEND),this._lastFrontFace=this.gl.getParameter(this.gl.FRONT_FACE),this._lastColorMask=this.gl.getParameter(this.gl.COLOR_WRITEMASK),this._lastBlending[0]=this.gl.getParameter(this.gl.BLEND_SRC_RGB),this._lastBlending[1]=this.gl.getParameter(this.gl.BLEND_DST_RGB),this._lastBlending[2]=this.gl.getParameter(this.gl.BLEND_SRC_ALPHA),this._lastBlending[3]=this.gl.getParameter(this.gl.BLEND_DST_ALPHA),this._lastFBO=this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING),this._lastViewport=this.gl.getParameter(this.gl.VIEWPORT)}restore(){if(this.gl==null){X(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this.gl.useProgram(this._lastProgram),this.setGlEnableVertexAttribArray(0,this._lastVertexAttribArrayEnabled[0]),this.setGlEnableVertexAttribArray(1,this._lastVertexAttribArrayEnabled[1]),this.setGlEnableVertexAttribArray(2,this._lastVertexAttribArrayEnabled[2]),this.setGlEnableVertexAttribArray(3,this._lastVertexAttribArrayEnabled[3]),this.setGlEnable(this.gl.SCISSOR_TEST,this._lastScissorTest),this.setGlEnable(this.gl.STENCIL_TEST,this._lastStencilTest),this.setGlEnable(this.gl.DEPTH_TEST,this._lastDepthTest),this.setGlEnable(this.gl.CULL_FACE,this._lastCullFace),this.setGlEnable(this.gl.BLEND,this._lastBlend),this.gl.frontFace(this._lastFrontFace),this.gl.colorMask(this._lastColorMask[0],this._lastColorMask[1],this._lastColorMask[2],this._lastColorMask[3]),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this._lastArrayBufferBinding),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this._lastElementArrayBufferBinding),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture1Binding2D),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this._lastTexture0Binding2D),this.gl.activeTexture(this._lastActiveTexture),this.gl.blendFuncSeparate(this._lastBlending[0],this._lastBlending[1],this._lastBlending[2],this._lastBlending[3])}setGl(t){this.gl=t}}class zt{constructor(){n(this,"_shaderSets");n(this,"gl");this._shaderSets=new v}static getInstance(){return Vt==null&&(Vt=new zt),Vt}static deleteInstance(){Vt&&(Vt.release(),Vt=null)}release(){this.releaseShaderProgram()}setupShaderProgram(t,e,i,r,a,l,o,h,u,g,m,p,c,d,_){c||X("NoPremultipliedAlpha is not allowed"),this._shaderSets.getSize()==0&&this.generateShaders();let f,b,y,B;if(t.getClippingContextBufferForMask()!=null){const T=this._shaderSets.at(0);this.gl.useProgram(T.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(T.samplerTexture0Location,0),o.vertex==null&&(o.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(T.attributePositionLocation),this.gl.vertexAttribPointer(T.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),o.uv==null&&(o.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,l,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(T.attributeTexCoordLocation),this.gl.vertexAttribPointer(T.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const S=t.getClippingContextBufferForMask()._layoutChannelNo,x=t.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(S);this.gl.uniform4f(T.uniformChannelFlagLocation,x.R,x.G,x.B,x.A),this.gl.uniformMatrix4fv(T.uniformClipMatrixLocation,!1,t.getClippingContextBufferForMask()._matrixForMask.getArray());const V=t.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(T.uniformBaseColorLocation,V.x*2-1,V.y*2-1,V.getRight()*2-1,V.getBottom()*2-1),this.gl.uniform4f(T.uniformMultiplyColorLocation,m.R,m.G,m.B,m.A),this.gl.uniform4f(T.uniformScreenColorLocation,p.R,p.G,p.B,p.A),f=this.gl.ZERO,b=this.gl.ONE_MINUS_SRC_COLOR,y=this.gl.ZERO,B=this.gl.ONE_MINUS_SRC_ALPHA}else{const T=t.getClippingContextBufferForDraw()!=null,S=T?_?2:1:0;let x=new Qe;switch(u){case it.CubismBlendMode_Normal:default:x=this._shaderSets.at(1+S),f=this.gl.ONE,b=this.gl.ONE_MINUS_SRC_ALPHA,y=this.gl.ONE,B=this.gl.ONE_MINUS_SRC_ALPHA;break;case it.CubismBlendMode_Additive:x=this._shaderSets.at(4+S),f=this.gl.ONE,b=this.gl.ONE,y=this.gl.ZERO,B=this.gl.ONE;break;case it.CubismBlendMode_Multiplicative:x=this._shaderSets.at(7+S),f=this.gl.DST_COLOR,b=this.gl.ONE_MINUS_SRC_ALPHA,y=this.gl.ZERO,B=this.gl.ONE;break}if(this.gl.useProgram(x.shaderProgram),o.vertex==null&&(o.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(x.attributePositionLocation),this.gl.vertexAttribPointer(x.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),o.uv==null&&(o.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,l,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(x.attributeTexCoordLocation),this.gl.vertexAttribPointer(x.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),T){this.gl.activeTexture(this.gl.TEXTURE1);const V=t.getClippingContextBufferForDraw().getClippingManager().getColorBuffer().at(t.getClippingContextBufferForDraw()._bufferIndex);this.gl.bindTexture(this.gl.TEXTURE_2D,V),this.gl.uniform1i(x.samplerTexture1Location,1),this.gl.uniformMatrix4fv(x.uniformClipMatrixLocation,!1,t.getClippingContextBufferForDraw()._matrixForDraw.getArray());const Y=t.getClippingContextBufferForDraw()._layoutChannelNo,R=t.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(Y);this.gl.uniform4f(x.uniformChannelFlagLocation,R.R,R.G,R.B,R.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(x.samplerTexture0Location,0),this.gl.uniformMatrix4fv(x.uniformMatrixLocation,!1,d.getArray()),this.gl.uniform4f(x.uniformBaseColorLocation,g.R,g.G,g.B,g.A),this.gl.uniform4f(x.uniformMultiplyColorLocation,m.R,m.G,m.B,m.A),this.gl.uniform4f(x.uniformScreenColorLocation,p.R,p.G,p.B,p.A)}o.index==null&&(o.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,o.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,a,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(f,b,y,B)}releaseShaderProgram(){for(let t=0;t<this._shaderSets.getSize();t++)this.gl.deleteProgram(this._shaderSets.at(t).shaderProgram),this._shaderSets.at(t).shaderProgram=0,this._shaderSets.set(t,void 0),this._shaderSets.set(t,null)}generateShaders(){for(let t=0;t<eo;t++)this._shaderSets.pushBack(new Qe);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(so,ro),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(ao,no),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(Cs,oo),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(Cs,lo),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(0).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_multiplyColor"),this._shaderSets.at(0).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_screenColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(1).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_multiplyColor"),this._shaderSets.at(1).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_screenColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(2).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_multiplyColor"),this._shaderSets.at(2).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_screenColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(3).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_multiplyColor"),this._shaderSets.at(3).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_screenColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(4).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_multiplyColor"),this._shaderSets.at(4).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_screenColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(5).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_multiplyColor"),this._shaderSets.at(5).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_screenColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(6).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_multiplyColor"),this._shaderSets.at(6).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_screenColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(7).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_multiplyColor"),this._shaderSets.at(7).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_screenColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(8).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_multiplyColor"),this._shaderSets.at(8).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_screenColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor"),this._shaderSets.at(9).uniformMultiplyColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_multiplyColor"),this._shaderSets.at(9).uniformScreenColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_screenColor")}loadShaderProgram(t,e){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,t);if(!r)return X("Vertex shader compile error!"),0;let a=this.compileShaderSource(this.gl.FRAGMENT_SHADER,e);return a?(this.gl.attachShader(i,r),this.gl.attachShader(i,a),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(a),i):(X("Failed to link program: {0}",i),this.gl.deleteShader(r),r=0,this.gl.deleteShader(a),a=0,i&&(this.gl.deleteProgram(i),i=0),0)):(X("Vertex shader compile error!"),0)}compileShaderSource(t,e){const i=e,r=this.gl.createShader(t);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const a=this.gl.getShaderInfoLog(r);X("Shader compile log: {0} ",a)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(t){this.gl=t}}class Qe{constructor(){n(this,"shaderProgram");n(this,"attributePositionLocation");n(this,"attributeTexCoordLocation");n(this,"uniformMatrixLocation");n(this,"uniformClipMatrixLocation");n(this,"samplerTexture0Location");n(this,"samplerTexture1Location");n(this,"uniformBaseColorLocation");n(this,"uniformChannelFlagLocation");n(this,"uniformMultiplyColorLocation");n(this,"uniformScreenColorLocation")}}var pr=(s=>(s[s.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",s[s.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",s[s.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",s[s.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",s[s.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",s[s.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",s[s.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",s[s.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",s[s.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",s[s.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted",s))(pr||{});const so="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",ro="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",ao="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",Cs="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",no="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 color = texColor * u_baseColor;   gl_FragColor = vec4(color.rgb, color.a);}",oo="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;uniform vec4       u_multiplyColor;uniform vec4       u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",lo="precision mediump float;varying vec2      v_texCoord;varying vec4      v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4      u_channelFlag;uniform vec4      u_baseColor;uniform vec4      u_multiplyColor;uniform vec4      u_screenColor;void main(){   vec4 texColor = texture2D(s_texture0, v_texCoord);   texColor.rgb = texColor.rgb * u_multiplyColor.rgb;   texColor.rgb = (texColor.rgb + u_screenColor.rgb * texColor.a) - (texColor.rgb * u_screenColor.rgb);   vec4 col_formask = texColor * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * (1.0 - maskVal);   gl_FragColor = col_formask;}";class oi extends se{constructor(){super();n(this,"_textures");n(this,"_sortedDrawableIndexList");n(this,"_clippingManager");n(this,"_clippingContextBufferForMask");n(this,"_clippingContextBufferForDraw");n(this,"_rendererProfile");n(this,"firstDraw");n(this,"_bufferData");n(this,"_extension");n(this,"gl");this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._rendererProfile=new io,this.firstDraw=!0,this._textures=new H,this._sortedDrawableIndexList=new v,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}initialize(e,i=1){e.isUsingMasking()&&(this._clippingManager=new Je,this._clippingManager.initialize(e,e.getDrawableCount(),e.getDrawableMasks(),e.getDrawableMaskCounts(),i)),this._sortedDrawableIndexList.resize(e.getDrawableCount(),0),super.initialize(e)}bindTexture(e,i){this._textures.setValue(e,i)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(e){if(!this._model.isUsingMasking())return;const i=this._clippingManager.getRenderTextureCount();this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new Je,this._clippingManager.setClippingMaskBufferSize(e),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts(),i)}getClippingMaskBufferSize(){return this._model.isUsingMasking()?this._clippingManager.getClippingMaskBufferSize():-1}getRenderTextureCount(){return this._model.isUsingMasking()?this._clippingManager.getRenderTextureCount():-1}release(){this._clippingManager&&(this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null),this.gl!=null&&(this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null)}doDrawModel(){if(this.gl==null){X(`'gl' is null. WebGLRenderingContext is required.
Please call 'CubimRenderer_WebGL.startUp' function.`);return}this._clippingManager!=null&&(this.preDraw(),this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const e=this.getModel().getDrawableCount(),i=this.getModel().getDrawableRenderOrders();for(let r=0;r<e;++r){const a=i[r];this._sortedDrawableIndexList.set(a,r)}for(let r=0;r<e;++r){const a=this._sortedDrawableIndexList.at(r);if(!this.getModel().getDrawableDynamicFlagIsVisible(a))continue;const l=this._clippingManager!=null?this._clippingManager.getClippingContextListForDraw().at(a):null;if(l!=null&&this.isUsingHighPrecisionMask()){l._isUsing&&(this.gl.viewport(0,0,this._clippingManager.getClippingMaskBufferSize(),this._clippingManager.getClippingMaskBufferSize()),this.preDraw(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,l.getClippingManager().getMaskRenderTexture().at(l._bufferIndex)),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));{const o=l._clippingIdCount;for(let h=0;h<o;h++){const u=l._clippingIdList[h];this._model.getDrawableDynamicFlagVertexPositionsDidChange(u)&&(this.setIsCulling(this._model.getDrawableCulling(u)!=!1),this.setClippingContextBufferForMask(l),this.drawMesh(this.getModel().getDrawableTextureIndex(u),this.getModel().getDrawableVertexIndexCount(u),this.getModel().getDrawableVertexCount(u),this.getModel().getDrawableVertexIndices(u),this.getModel().getDrawableVertices(u),this.getModel().getDrawableVertexUvs(u),this.getModel().getMultiplyColor(u),this.getModel().getScreenColor(u),this.getModel().getDrawableOpacity(u),it.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,Me),this.setClippingContextBufferForMask(null),this.gl.viewport(ht[0],ht[1],ht[2],ht[3]),this.preDraw()}this.setClippingContextBufferForDraw(l),this.setIsCulling(this.getModel().getDrawableCulling(a)),this.drawMesh(this.getModel().getDrawableTextureIndex(a),this.getModel().getDrawableVertexIndexCount(a),this.getModel().getDrawableVertexCount(a),this.getModel().getDrawableVertexIndices(a),this.getModel().getDrawableVertices(a),this.getModel().getDrawableVertexUvs(a),this.getModel().getMultiplyColor(a),this.getModel().getScreenColor(a),this.getModel().getDrawableOpacity(a),this.getModel().getDrawableBlendMode(a),this.getModel().getDrawableInvertedMaskBit(a))}}drawMesh(e,i,r,a,l,o,h,u,g,m,p){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const c=this.getModelColor();this.getClippingContextBufferForMask()==null&&(c.A*=g,this.isPremultipliedAlpha()&&(c.R*=c.A,c.G*=c.A,c.B*=c.A));let d;this._textures.getValue(e)!=null?d=this._textures.getValue(e):d=null,zt.getInstance().setupShaderProgram(this,d,r,l,a,o,this._bufferData,g,m,c,h,u,this.isPremultipliedAlpha(),this.getMvpMatrix(),p),this.gl.drawElements(this.gl.TRIANGLES,i,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}saveProfile(){this._rendererProfile.save()}restoreProfile(){this._rendererProfile.restore()}static doStaticRelease(){zt.deleteInstance()}setRenderState(e,i){Me=e,ht=i}preDraw(){if(this.firstDraw&&(this.firstDraw=!1),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.getAnisotropy()>0&&this._extension)for(let e=0;e<this._textures.getSize();++e)this.gl.bindTexture(this.gl.TEXTURE_2D,this._textures.getValue(e)),this.gl.texParameterf(this.gl.TEXTURE_2D,this._extension.TEXTURE_MAX_ANISOTROPY_EXT,this.getAnisotropy())}setClippingContextBufferForMask(e){this._clippingContextBufferForMask=e}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(e){this._clippingContextBufferForDraw=e}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(e){this.gl=e,this._clippingManager&&this._clippingManager.setGL(e),zt.getInstance().setGl(e),this._rendererProfile.setGl(e),this._extension=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")}}se.staticRelease=()=>{oi.doStaticRelease()};var Ms;(s=>{s.CubismClippingContext=_r,s.CubismClippingManager_WebGL=Je,s.CubismRenderTextureResource=mr,s.CubismRenderer_WebGL=oi,s.CubismShaderSet=Qe,s.CubismShader_WebGL=zt,s.ShaderNames=pr})(Ms||(Ms={}));class vs{constructor(){n(this,"isOverwritten",!1);n(this,"Color",new gt)}}class Bs{constructor(t=!1,e=!1){n(this,"isOverwritten");n(this,"isCulling");t=this.isOverwritten,e=this.isCulling}}class fr{constructor(t){n(this,"_notExistPartOpacities");n(this,"_notExistPartId");n(this,"_notExistParameterValues");n(this,"_notExistParameterId");n(this,"_savedParameters");n(this,"_isOverwrittenModelMultiplyColors");n(this,"_isOverwrittenModelScreenColors");n(this,"_userMultiplyColors");n(this,"_userScreenColors");n(this,"_model");n(this,"_parameterValues");n(this,"_parameterMaximumValues");n(this,"_parameterMinimumValues");n(this,"_partOpacities");n(this,"_parameterIds");n(this,"_partIds");n(this,"_drawableIds");n(this,"_isOverwrittenCullings");n(this,"_userCullings");this._model=t,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new v,this._parameterIds=new v,this._drawableIds=new v,this._partIds=new v,this._isOverwrittenModelMultiplyColors=!1,this._isOverwrittenModelScreenColors=!1,this._isOverwrittenCullings=!1,this._userMultiplyColors=null,this._userScreenColors=null,this._notExistPartId=new H,this._notExistParameterId=new H,this._notExistParameterValues=new H,this._notExistPartOpacities=new H}update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getPixelsPerUnit(){return this._model==null?0:this._model.canvasinfo.PixelsPerUnit}getCanvasWidth(){return this._model==null?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return this._model==null?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const t=this._model.parameters.count,e=this._savedParameters.getSize();for(let i=0;i<t;++i)i<e?this._savedParameters.set(i,this._parameterValues[i]):this._savedParameters.pushBack(this._parameterValues[i])}getMultiplyColor(t){return this.getOverwriteFlagForModelMultiplyColors()||this.getOverwriteFlagForDrawableMultiplyColors(t)?this._userMultiplyColors.at(t).Color:this.getDrawableMultiplyColor(t)}getScreenColor(t){return this.getOverwriteFlagForModelScreenColors()||this.getOverwriteFlagForDrawableScreenColors(t)?this._userScreenColors.at(t).Color:this.getDrawableScreenColor(t)}setMultiplyColorByTextureColor(t,e){this.setMultiplyColorByRGBA(t,e.R,e.G,e.B,e.A)}setMultiplyColorByRGBA(t,e,i,r,a=1){this._userMultiplyColors.at(t).Color.R=e,this._userMultiplyColors.at(t).Color.G=i,this._userMultiplyColors.at(t).Color.B=r,this._userMultiplyColors.at(t).Color.A=a}setScreenColorByTextureColor(t,e){this.setScreenColorByRGBA(t,e.R,e.G,e.B,e.A)}setScreenColorByRGBA(t,e,i,r,a=1){this._userScreenColors.at(t).Color.R=e,this._userScreenColors.at(t).Color.G=i,this._userScreenColors.at(t).Color.B=r,this._userScreenColors.at(t).Color.A=a}getOverwriteFlagForModelMultiplyColors(){return this._isOverwrittenModelMultiplyColors}getOverwriteFlagForModelScreenColors(){return this._isOverwrittenModelScreenColors}setOverwriteFlagForModelMultiplyColors(t){this._isOverwrittenModelMultiplyColors=t}setOverwriteFlagForModelScreenColors(t){this._isOverwrittenModelScreenColors=t}getOverwriteFlagForDrawableMultiplyColors(t){return this._userMultiplyColors.at(t).isOverwritten}getOverwriteFlagForDrawableScreenColors(t){return this._userMultiplyColors.at(t).isOverwritten}setOverwriteFlagForDrawableMultiplyColors(t,e){this._userMultiplyColors.at(t).isOverwritten=e}setOverwriteFlagForDrawableScreenColors(t,e){this._userScreenColors.at(t).isOverwritten=e}getDrawableCulling(t){if(this.getOverwriteFlagForModelCullings()||this.getOverwriteFlagForDrawableCullings(t))return this._userCullings.at(t).isCulling;const e=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(e[t])}setDrawableCulling(t,e){this._userCullings.at(t).isCulling=e}getOverwriteFlagForModelCullings(){return this._isOverwrittenCullings}setOverwriteFlagForModelCullings(t){this._isOverwrittenCullings=t}getOverwriteFlagForDrawableCullings(t){return this._userCullings.at(t).isOverwritten}setOverwriteFlagForDrawableCullings(t,e){this._userCullings.at(t).isOverwritten=e}getModel(){return this._model}getPartIndex(t){let e;const i=this._model.parts.count;for(e=0;e<i;++e)if(t==this._partIds.at(e))return e;return this._notExistPartId.isExist(t)?this._notExistPartId.getValue(t):(e=i+this._notExistPartId.getSize(),this._notExistPartId.setValue(t,e),this._notExistPartOpacities.appendKey(e),e)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(t,e){if(this._notExistPartOpacities.isExist(t)){this._notExistPartOpacities.setValue(t,e);return}et(0<=t&&t<this.getPartCount()),this._partOpacities[t]=e}setPartOpacityById(t,e){const i=this.getPartIndex(t);i<0||this.setPartOpacityByIndex(i,e)}getPartOpacityByIndex(t){return this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.getValue(t):(et(0<=t&&t<this.getPartCount()),this._partOpacities[t])}getPartOpacityById(t){const e=this.getPartIndex(t);return e<0?0:this.getPartOpacityByIndex(e)}getParameterIndex(t){let e;const i=this._model.parameters.count;for(e=0;e<i;++e)if(t==this._parameterIds.at(e))return e;return this._notExistParameterId.isExist(t)?this._notExistParameterId.getValue(t):(e=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(t,e),this._notExistParameterValues.appendKey(e),e)}getParameterCount(){return this._model.parameters.count}getParameterType(t){return this._model.parameters.types[t]}getParameterMaximumValue(t){return this._model.parameters.maximumValues[t]}getParameterMinimumValue(t){return this._model.parameters.minimumValues[t]}getParameterDefaultValue(t){return this._model.parameters.defaultValues[t]}getParameterValueByIndex(t){return this._notExistParameterValues.isExist(t)?this._notExistParameterValues.getValue(t):(et(0<=t&&t<this.getParameterCount()),this._parameterValues[t])}getParameterValueById(t){const e=this.getParameterIndex(t);return this.getParameterValueByIndex(e)}setParameterValueByIndex(t,e,i=1){if(this._notExistParameterValues.isExist(t)){this._notExistParameterValues.setValue(t,i==1?e:this._notExistParameterValues.getValue(t)*(1-i)+e*i);return}et(0<=t&&t<this.getParameterCount()),this._model.parameters.maximumValues[t]<e&&(e=this._model.parameters.maximumValues[t]),this._model.parameters.minimumValues[t]>e&&(e=this._model.parameters.minimumValues[t]),this._parameterValues[t]=i==1?e:this._parameterValues[t]=this._parameterValues[t]*(1-i)+e*i}setParameterValueById(t,e,i=1){const r=this.getParameterIndex(t);this.setParameterValueByIndex(r,e,i)}addParameterValueByIndex(t,e,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)+e*i)}addParameterValueById(t,e,i=1){const r=this.getParameterIndex(t);this.addParameterValueByIndex(r,e,i)}multiplyParameterValueById(t,e,i=1){const r=this.getParameterIndex(t);this.multiplyParameterValueByIndex(r,e,i)}multiplyParameterValueByIndex(t,e,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)*(1+(e-1)*i))}getDrawableIndex(t){const e=this._model.drawables.count;for(let i=0;i<e;++i)if(this._drawableIds.at(i)==t)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(t){const e=this._model.drawables.ids;return L.getIdManager().getId(e[t])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(t){return this.getDrawableTextureIndex(t)}getDrawableTextureIndex(t){return this._model.drawables.textureIndices[t]}getDrawableDynamicFlagVertexPositionsDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(e[t])}getDrawableVertexIndexCount(t){return this._model.drawables.indexCounts[t]}getDrawableVertexCount(t){return this._model.drawables.vertexCounts[t]}getDrawableVertices(t){return this.getDrawableVertexPositions(t)}getDrawableVertexIndices(t){return this._model.drawables.indices[t]}getDrawableVertexPositions(t){return this._model.drawables.vertexPositions[t]}getDrawableVertexUvs(t){return this._model.drawables.vertexUvs[t]}getDrawableOpacity(t){return this._model.drawables.opacities[t]}getDrawableMultiplyColor(t){const e=this._model.drawables.multiplyColors,i=t*4,r=new gt;return r.R=e[i],r.G=e[i+1],r.B=e[i+2],r.A=e[i+3],r}getDrawableScreenColor(t){const e=this._model.drawables.screenColors,i=t*4,r=new gt;return r.R=e[i],r.G=e[i+1],r.B=e[i+2],r.A=e[i+3],r}getDrawableParentPartIndex(t){return this._model.drawables.parentPartIndices[t]}getDrawableBlendMode(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(e[t])?it.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(e[t])?it.CubismBlendMode_Multiplicative:it.CubismBlendMode_Normal}getDrawableInvertedMaskBit(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(e[t])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let t=0;t<this._model.drawables.count;++t)if(!(this._model.drawables.maskCounts[t]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(e[t])}getDrawableDynamicFlagVisibilityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(e[t])}getDrawableDynamicFlagOpacityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(e[t])}getDrawableDynamicFlagRenderOrderDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(e[t])}getDrawableDynamicFlagBlendColorDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasBlendColorDidChangeBit(e[t])}loadParameters(){let t=this._model.parameters.count;const e=this._savedParameters.getSize();t>e&&(t=e);for(let i=0;i<t;++i)this._parameterValues[i]=this._savedParameters.at(i)}initialize(){et(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const t=this._model.parameters.ids,e=this._model.parameters.count;this._parameterIds.prepareCapacity(e);for(let i=0;i<e;++i)this._parameterIds.pushBack(L.getIdManager().getId(t[i]))}{const t=this._model.parts.ids,e=this._model.parts.count;this._partIds.prepareCapacity(e);for(let i=0;i<e;++i)this._partIds.pushBack(L.getIdManager().getId(t[i]))}{const t=this._model.drawables.ids,e=this._model.drawables.count;this._userMultiplyColors=new v,this._userMultiplyColors.updateSize(e,vs,!0),this._userScreenColors=new v,this._userScreenColors.updateSize(e,vs,!0),this._userCullings=new v,this._userCullings.updateSize(e,Bs,!0);const i=new Bs(!1,!1);this._drawableIds.prepareCapacity(e);for(let r=0;r<e;++r)this._drawableIds.pushBack(L.getIdManager().getId(t[r])),this.setMultiplyColorByRGBA(r,1,1,1,1),this.setScreenColorByRGBA(r,0,0,0,1),this._userCullings.pushBack(i)}}release(){this._model.release(),this._model=null}}var bs;(s=>{s.CubismModel=fr})(bs||(bs={}));class Ve{constructor(t){n(this,"_moc");n(this,"_modelCount");n(this,"_mocVersion");this._moc=t,this._modelCount=0,this._mocVersion=0}static create(t){let e=null;const i=Live2DCubismCore.Moc.fromArrayBuffer(t);return i&&(e=new Ve(i),e._mocVersion=Live2DCubismCore.Version.csmGetMocVersion(i,t)),e}static delete(t){t._moc._release(),t._moc=null,t=null}createModel(){let t=null;const e=Live2DCubismCore.Model.fromMoc(this._moc);return e&&(t=new fr(e),t.initialize(),++this._modelCount),t}deleteModel(t){t!=null&&(t.release(),t=null,--this._modelCount)}release(){et(this._modelCount==0),this._moc._release(),this._moc=null}getLatestMocVersion(){return Live2DCubismCore.Version.csmGetLatestMocVersion()}getMocVersion(){return this._mocVersion}static hasMocConsistency(t){return Live2DCubismCore.Moc.prototype.hasMocConsistency(t)===1}}var Ps;(s=>{s.CubismMoc=Ve})(Ps||(Ps={}));const ws="Meta",ho="UserDataCount",uo="TotalUserDataSize",Ye="UserData",go="Target",co="Id",mo="Value";class yr{constructor(t,e){n(this,"_json");this._json=z.create(t,e)}release(){z.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString(ws).getValueByString(ho).toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString(ws).getValueByString(uo).toInt()}getUserDataTargetType(t){return this._json.getRoot().getValueByString(Ye).getValueByIndex(t).getValueByString(go).getRawString()}getUserDataId(t){return L.getIdManager().getId(this._json.getRoot().getValueByString(Ye).getValueByIndex(t).getValueByString(co).getRawString())}getUserDataValue(t){return this._json.getRoot().getValueByString(Ye).getValueByIndex(t).getValueByString(mo).getRawString()}}var Ts;(s=>{s.CubismModelUserDataJson=yr})(Ts||(Ts={}));const _o="ArtMesh";class xr{constructor(){n(this,"targetType");n(this,"targetId");n(this,"value")}}class ee{constructor(){n(this,"_userDataNodes");n(this,"_artMeshUserDataNode");this._userDataNodes=new v,this._artMeshUserDataNode=new v}static create(t,e){const i=new ee;return i.parseUserData(t,e),i}static delete(t){t!=null&&(t.release(),t=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(t,e){let i=new yr(t,e);const r=L.getIdManager().getId(_o),a=i.getUserDataCount();for(let l=0;l<a;l++){const o=new xr;o.targetId=i.getUserDataId(l),o.targetType=L.getIdManager().getId(i.getUserDataTargetType(l)),o.value=new $(i.getUserDataValue(l)),this._userDataNodes.pushBack(o),o.targetType==r&&this._artMeshUserDataNode.pushBack(o)}i.release(),i=void 0}release(){for(let t=0;t<this._userDataNodes.getSize();++t)this._userDataNodes.set(t,null);this._userDataNodes=null}}var Is;(s=>{s.CubismModelUserData=ee,s.CubismModelUserDataNode=xr})(Is||(Is={}));class Re{constructor(){n(this,"loadMotion",(t,e,i,r)=>Ie.create(t,e,r));n(this,"_moc");n(this,"_model");n(this,"_motionManager");n(this,"_expressionManager");n(this,"_eyeBlink");n(this,"_breath");n(this,"_modelMatrix");n(this,"_pose");n(this,"_dragManager");n(this,"_physics");n(this,"_modelUserData");n(this,"_initialized");n(this,"_updating");n(this,"_opacity");n(this,"_lipsync");n(this,"_lastLipSyncValue");n(this,"_dragX");n(this,"_dragY");n(this,"_accelerationX");n(this,"_accelerationY");n(this,"_accelerationZ");n(this,"_debugMode");n(this,"_renderer");this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._debugMode=!1,this._renderer=null,this._motionManager=new Kt,this._motionManager.setEventCallback(Re.cubismDefaultMotionEventCallback,this),this._expressionManager=new Kt,this._dragManager=new Zs}isInitialized(){return this._initialized}setInitialized(t){this._initialized=t}isUpdating(){return this._updating}setUpdating(t){this._updating=t}setDragging(t,e){this._dragManager.set(t,e)}setAcceleration(t,e,i){this._accelerationX=t,this._accelerationY=e,this._accelerationZ=i}getModelMatrix(){return this._modelMatrix}setOpacity(t){this._opacity=t}getOpacity(){return this._opacity}loadModel(t){if(this._moc=Ve.create(t),this._moc==null){X("Failed to CubismMoc.create().");return}if(this._model=this._moc.createModel(),this._model==null){X("Failed to CreateModel().");return}this._model.saveParameters(),this._modelMatrix=new $s(this._model.getCanvasWidth(),this._model.getCanvasHeight())}loadExpression(t,e,i){return Te.create(t,e)}loadPose(t,e){this._pose=Jt.create(t,e)}loadUserData(t,e){this._modelUserData=ee.create(t,e)}loadPhysics(t,e){this._physics=te.create(t,e)}isHit(t,e,i){const r=this._model.getDrawableIndex(t);if(r<0)return!1;const a=this._model.getDrawableVertexCount(r),l=this._model.getDrawableVertices(r);let o=l[0],h=l[0],u=l[1],g=l[1];for(let c=1;c<a;++c){const d=l[xt.vertexOffset+c*xt.vertexStep],_=l[xt.vertexOffset+c*xt.vertexStep+1];d<o&&(o=d),d>h&&(h=d),_<u&&(u=_),_>g&&(g=_)}const m=this._modelMatrix.invertTransformX(e),p=this._modelMatrix.invertTransformY(i);return o<=m&&m<=h&&u<=p&&p<=g}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(t=1){this._renderer&&this.deleteRenderer(),this._renderer=new oi,this._renderer.initialize(this._model,t)}deleteRenderer(){this._renderer!=null&&(this._renderer.release(),this._renderer=null)}motionEventFired(t){lt("{0}",t.s)}static cubismDefaultMotionEventCallback(t,e,i){const r=i;r==null||r.motionEventFired(e)}release(){this._motionManager!=null&&(this._motionManager.release(),this._motionManager=null),this._expressionManager!=null&&(this._expressionManager.release(),this._expressionManager=null),this._moc!=null&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,Jt.delete(this._pose),kt.delete(this._eyeBlink),re.delete(this._breath),this._dragManager=null,te.delete(this._physics),ee.delete(this._modelUserData),this.deleteRenderer()}}var Vs;(s=>{s.CubismUserModel=Re})(Vs||(Vs={}));class I{static loadFileAsBytes(t,e){fetch(t).then(i=>i.arrayBuffer()).then(i=>e(i,i.byteLength))}static getDeltaTime(){return this._deltaTime}static updateTime(){this._currentFrame=Date.now(),this._deltaTime=(this._currentFrame-this._lastFrame)/1e3,this._lastFrame=this._currentFrame}static printMessage(t){j.debug&&console.log(t)}}n(I,"_currentFrame",0),n(I,"_lastFrame",0),n(I,"_deltaTime",0);const li=class{constructor(){n(this,"pcmData");n(this,"userTimeSeconds");n(this,"lastRms");n(this,"sampleOffset");n(this,"wavFileInfo");n(this,"byteReader");n(this,"audio");n(this,"audioPlayPromise");n(this,"loadFileToBytes",t=>{this.byteReader._fileByte=t,this.byteReader._fileDataView=new DataView(this.byteReader._fileByte),this.byteReader._fileSize=this.byteReader._fileByte.byteLength,this.byteReader._readOffset=0});this.pcmData=null,this.userTimeSeconds=0,this.lastRms=0,this.sampleOffset=0,this.wavFileInfo=new po,this.byteReader=new fo,this.audio=new Audio}static getInstance(){return this._instance==null&&(this._instance=new li),this._instance}static releaseInstance(){this._instance!=null&&(this._instance=void 0),this._instance=null}update(t){let e,i;if(this.pcmData==null||this.sampleOffset>=this.wavFileInfo._samplesPerChannel)return this.lastRms=0,!1;this.userTimeSeconds+=t,e=Math.floor(this.userTimeSeconds*this.wavFileInfo._samplingRate),e>this.wavFileInfo._samplesPerChannel&&(e=this.wavFileInfo._samplesPerChannel),i=0;for(let r=0;r<this.wavFileInfo._numberOfChannels;r++)for(let a=this.sampleOffset;a<e;a++){const l=this.pcmData[r][a];i+=l*l}return i=Math.sqrt(i/(this.wavFileInfo._numberOfChannels*(e-this.sampleOffset))),this.lastRms=i,this.sampleOffset=e,!0}async start(t){return this.sampleOffset=0,this.userTimeSeconds=0,this.lastRms=0,this.playWavFile(t),await this.loadWavFile(t)}getRms(){return this.lastRms}async loadWavFile(t){let e=!1;this.pcmData!=null&&this.releasePcmData();const i=async()=>fetch(t).then(r=>r.arrayBuffer());if(this.loadFileToBytes(await i()),this.byteReader._fileSize<4)return!1;this.wavFileInfo._fileName=t;try{if(!this.byteReader.getCheckSignature("RIFF"))throw e=!1,new Error('Cannot find Signeture "RIFF".');if(this.byteReader.get32LittleEndian(),!this.byteReader.getCheckSignature("WAVE"))throw e=!1,new Error('Cannot find Signeture "WAVE".');if(!this.byteReader.getCheckSignature("fmt "))throw e=!1,new Error('Cannot find Signeture "fmt".');const r=this.byteReader.get32LittleEndian();if(this.byteReader.get16LittleEndian()!=1)throw e=!1,new Error("File is not linear PCM.");for(this.wavFileInfo._numberOfChannels=this.byteReader.get16LittleEndian(),this.wavFileInfo._samplingRate=this.byteReader.get32LittleEndian(),this.byteReader.get32LittleEndian(),this.byteReader.get16LittleEndian(),this.wavFileInfo._bitsPerSample=this.byteReader.get16LittleEndian(),r>16&&(this.byteReader._readOffset+=r-16);!this.byteReader.getCheckSignature("data")&&this.byteReader._readOffset<this.byteReader._fileSize;)this.byteReader._readOffset+=this.byteReader.get32LittleEndian()+4;if(this.byteReader._readOffset>=this.byteReader._fileSize)throw e=!1,new Error('Cannot find "data" Chunk.');{const a=this.byteReader.get32LittleEndian();this.wavFileInfo._samplesPerChannel=a*8/(this.wavFileInfo._bitsPerSample*this.wavFileInfo._numberOfChannels)}this.pcmData=new Array(this.wavFileInfo._numberOfChannels);for(let a=0;a<this.wavFileInfo._numberOfChannels;a++)this.pcmData[a]=new Float32Array(this.wavFileInfo._samplesPerChannel);for(let a=0;a<this.wavFileInfo._samplesPerChannel;a++)for(let l=0;l<this.wavFileInfo._numberOfChannels;l++)this.pcmData[l][a]=this.getPcmSample();e=!0}catch(r){console.error(r)}return e}playWavFile(t){this.audio.src=t,this.audioPlayPromise=this.audio.play()}getPcmSample(){let t;switch(this.wavFileInfo._bitsPerSample){case 8:t=this.byteReader.get8()-128,t<<=24;break;case 16:t=this.byteReader.get16LittleEndian()<<16;break;case 24:t=this.byteReader.get24LittleEndian()<<8;break;default:t=0;break}return t/2147483647}releasePcmData(){for(let t=0;t<this.wavFileInfo._numberOfChannels;t++)delete this.pcmData[t];delete this.pcmData,this.pcmData=null}release(){var t;(t=this.audioPlayPromise)==null||t.then(()=>this.audio.pause())}};let pe=li;n(pe,"_instance",null);class po{constructor(){n(this,"_fileName");n(this,"_numberOfChannels");n(this,"_bitsPerSample");n(this,"_samplingRate");n(this,"_samplesPerChannel");this._fileName="",this._numberOfChannels=0,this._bitsPerSample=0,this._samplingRate=0,this._samplesPerChannel=0}}class fo{constructor(){n(this,"_fileByte");n(this,"_fileDataView");n(this,"_fileSize");n(this,"_readOffset");this._fileByte=null,this._fileDataView=null,this._fileSize=0,this._readOffset=0}get8(){const t=this._fileDataView.getUint8(this._readOffset);return this._readOffset++,t}get16LittleEndian(){const t=this._fileDataView.getUint8(this._readOffset+1)<<8|this._fileDataView.getUint8(this._readOffset);return this._readOffset+=2,t}get24LittleEndian(){const t=this._fileDataView.getUint8(this._readOffset+2)<<16|this._fileDataView.getUint8(this._readOffset+1)<<8|this._fileDataView.getUint8(this._readOffset);return this._readOffset+=3,t}get32LittleEndian(){const t=this._fileDataView.getUint8(this._readOffset+3)<<24|this._fileDataView.getUint8(this._readOffset+2)<<16|this._fileDataView.getUint8(this._readOffset+1)<<8|this._fileDataView.getUint8(this._readOffset);return this._readOffset+=4,t}getCheckSignature(t){const e=new Uint8Array(4),i=new TextEncoder().encode(t);if(t.length!=4)return!1;for(let r=0;r<4;r++)e[r]=this.get8();return e[0]==i[0]&&e[1]==i[1]&&e[2]==i[2]&&e[3]==i[3]}}class yo extends Re{constructor(){super();n(this,"modelSetting");n(this,"modelHomeDir");n(this,"userTimeSeconds");n(this,"eyeBlinkIds");n(this,"lipSyncIds");n(this,"motions");n(this,"expressions");n(this,"_hitArea");n(this,"_userArea");n(this,"idParamAngleX");n(this,"idParamAngleY");n(this,"idParamAngleZ");n(this,"idParamEyeBallX");n(this,"idParamEyeBallY");n(this,"idParamBodyAngleX");n(this,"state");n(this,"expressionCount");n(this,"textureCount");n(this,"motionCount");n(this,"allMotionCount");n(this,"wavFileHandler");n(this,"_rightArmMotionManager");n(this,"_leftArmMotionManager");this.modelSetting=null,this.modelHomeDir=null,this.userTimeSeconds=0,this.eyeBlinkIds=new v,this.lipSyncIds=new v,this.motions=new H,this.expressions=new H,this._hitArea=new v,this._userArea=new v,this.getParameterId(),this.state=0,this.expressionCount=0,this.textureCount=0,this.motionCount=0,this.allMotionCount=0,this.wavFileHandler=new pe,this._rightArmMotionManager=new Kt,this._leftArmMotionManager=new Kt}get model(){return this._model}getParameterId(){const e=L.getIdManager();this.idParamAngleX=e.getId(C.ParamAngleX),this.idParamAngleY=e.getId(C.ParamAngleY),this.idParamAngleZ=e.getId(C.ParamAngleZ),this.idParamEyeBallX=e.getId(C.ParamEyeBallX),this.idParamEyeBallY=e.getId(C.ParamEyeBallY),this.idParamBodyAngleX=e.getId(C.ParamBodyAngleX)}loadAssets(e,i){this.modelHomeDir=e,fetch(tt.join(e,i),{cache:"no-cache"}).then(r=>r.arrayBuffer()).then(r=>{const a=new Ws(r,r.byteLength);this.state=1,this.setupModel(a)})}setupModel(e){if(this._updating=!0,this._initialized=!1,this.modelSetting=e,this.modelSetting.getModelFileName()!=""){const c=this.modelSetting.getModelFileName();fetch(tt.join(this.modelHomeDir,c)).then(d=>d.arrayBuffer()).then(d=>{this.loadModel(d),this.state=3,i()}),this.state=2}else I.printMessage("Model data does not exist.");const i=()=>{if(this.modelSetting.getExpressionCount()>0){const c=this.modelSetting.getExpressionCount();for(let d=0;d<c;d++){const _=this.modelSetting.getExpressionName(d),f=this.modelSetting.getExpressionFileName(d);fetch(tt.join(this.modelHomeDir,f)).then(b=>b.arrayBuffer()).then(b=>{const y=this.loadExpression(b,b.byteLength,_);this.expressions.getValue(_)!=null&&(Ut.delete(this.expressions.getValue(_)),this.expressions.setValue(_,null)),this.expressions.setValue(_,y),this.expressionCount++,this.expressionCount>=c&&(this.state=5,r())})}this.state=4}else this.state=5,r()},r=()=>{if(this.modelSetting.getPhysicsFileName()!=""){const c=this.modelSetting.getPhysicsFileName();fetch(tt.join(this.modelHomeDir,c)).then(d=>d.arrayBuffer()).then(d=>{this.loadPhysics(d,d.byteLength),this.state=7,a()}),this.state=6}else this.state=7,a()},a=()=>{if(this.modelSetting.getPoseFileName()!=""){const c=this.modelSetting.getPoseFileName();fetch(tt.join(this.modelHomeDir,c)).then(d=>d.arrayBuffer()).then(d=>{this.loadPose(d,d.byteLength),this.state=9,l()}),this.state=8}else this.state=9,l()},l=()=>{this.modelSetting.getEyeBlinkParameterCount()>0&&(this._eyeBlink=kt.create(this.modelSetting),this.state=10),o()},o=()=>{this._breath=re.create();const c=new v;c.pushBack(new Rt(this.idParamAngleX,0,15,6.5345,.5)),c.pushBack(new Rt(this.idParamAngleY,0,8,3.5345,.5)),c.pushBack(new Rt(this.idParamAngleZ,0,10,5.5345,.5)),c.pushBack(new Rt(this.idParamBodyAngleX,0,4,15.5345,.5)),c.pushBack(new Rt(L.getIdManager().getId(C.ParamBreath),.5,.5,3.2345,1)),this._breath.setParameters(c),this.state=11,h()},h=()=>{if(this.modelSetting.getUserDataFile()!==""){const c=this.modelSetting.getUserDataFile();fetch(tt.join(this.modelHomeDir,c)).then(d=>d.arrayBuffer()).then(d=>{this.loadUserData(d,d.byteLength),this.state=13,u()}),this.state=12}else this.state=13,u()},u=()=>{const c=this.modelSetting.getEyeBlinkParameterCount();for(let d=0;d<c;++d)this.eyeBlinkIds.pushBack(this.modelSetting.getEyeBlinkParameterId(d));this.state=14,g()},g=()=>{const c=this.modelSetting.getLipSyncParameterCount();for(let d=0;d<c;++d)this.lipSyncIds.pushBack(this.modelSetting.getLipSyncParameterId(d));this.state=15,m()},m=()=>{const c=new H;if(this.modelSetting===null||this._modelMatrix===null){X("Failed to setupLayout().");return}this.modelSetting.getLayoutMap(c),this._modelMatrix.setupFromLayout(c),this.state=16,p()},p=()=>{this.state=17,this.model.saveParameters(),this.allMotionCount=0,this.motionCount=0;const c=[],d=this.modelSetting.getMotionGroupCount();for(let _=0;_<d;_++)c[_]=this.modelSetting.getMotionGroupName(_),this.allMotionCount+=this.modelSetting.getMotionCount(c[_]);for(let _=0;_<d;_++)this.preLoadMotionGroup(c[_]);d==0&&this.reloadTextures()}}setupTextures(){var e;if(this.state===20){const i=this.modelSetting.getTextureCount();for(let r=0;r<i;r++){if(this.modelSetting.getTextureFileName(r)===""){I.printMessage("getTextureFileName null");continue}const a=this.modelSetting.getTextureFileName(r),l=tt.join(this.modelHomeDir,a),o=h=>{var u;(u=this.getRenderer())==null||u.bindTexture(r,h.id),this.textureCount++,this.textureCount>=i&&(this.state=22)};w.instance.textureManager.createTextureFromPngFile(l,!0,o),(e=this.getRenderer())==null||e.setIsPremultipliedAlpha(!0)}this.state=21}}reloadRenderer(){this.deleteRenderer(),this.createRenderer(),this.setupTextures()}update(){var r,a,l,o,h,u;if(this.state!=22)return;const e=I.getDeltaTime();this.userTimeSeconds+=e,this._dragManager.update(e),this._dragX=this._dragManager.getX(),this._dragY=this._dragManager.getY();let i=!1;if(this.model.loadParameters(),this._motionManager.isFinished())this.startRandomMotion(Et.Idle,ut.Idle);else{const g=this._motionManager.updateMotion(this.model,e),m=this._rightArmMotionManager.updateMotion(this.model,e),p=this._leftArmMotionManager.updateMotion(this.model,e);i=[g,m,p].some(c=>c)}if(this.model.saveParameters(),i||((r=this._eyeBlink)==null||r.updateParameters(this.model,e)),(a=this._expressionManager)==null||a.updateMotion(this.model,e),this.model.addParameterValueById(this.idParamAngleX,this._dragX*30),this.model.addParameterValueById(this.idParamAngleY,this._dragY*30),this.model.addParameterValueById(this.idParamAngleZ,this._dragX*this._dragY*-30),this.model.addParameterValueById(this.idParamBodyAngleX,this._dragX*10),this.model.addParameterValueById(this.idParamEyeBallX,this._dragX),this.model.addParameterValueById(this.idParamEyeBallY,this._dragY),(l=this._breath)==null||l.updateParameters(this.model,e),(o=this._physics)==null||o.evaluate(this.model,e),this._lipsync){(h=this.wavFileHandler)==null||h.update(e);const g=this.wavFileHandler.getRms();for(let m=0;m<this.lipSyncIds.getSize();++m)this.model.addParameterValueById(this.lipSyncIds.at(m),g,.8)}(u=this._pose)==null||u.updateParameters(this.model,e),this.model.update()}startMotion(e,i,r,a){if(r==ut.Force)this._motionManager.setReservePriority(r);else if(!this._motionManager.reserveMotion(r))return this._debugMode&&I.printMessage("[APP]can't start motion."),vt;const{motion:l,autoDelete:o}=this.getMotion(e,i,a),h=this.modelSetting.getMotionSoundFileName(e,i);if(h.localeCompare("")!=0){let u=this.modelHomeDir+h;this.wavFileHandler.start(u).catch()}return this._debugMode&&I.printMessage(`[APP]start motion: [${e}_${i}`),this._motionManager.startMotionPriority(l,o,r)}startRandomMotion(e,i,r){if(this.modelSetting.getMotionCount(e)==0)return vt;const a=Math.floor(Math.random()*this.modelSetting.getMotionCount(e));return this.startMotion(e,a,i,r)}getMotion(e,i,r){const a=this.modelSetting.getMotionFileName(e,i),l=`${e}_${i}`;let o=this.motions.getValue(l),h=!1;const u=tt.join(this.modelHomeDir,a);return o==null?fetch(u).then(g=>g.arrayBuffer()).then(g=>{o=this.loadMotion(g,g.byteLength,null,r);let m=this.modelSetting.getMotionFadeInTimeValue(e,i);m>=0&&o.setFadeInTime(m),m=this.modelSetting.getMotionFadeOutTimeValue(e,i),m>=0&&o.setFadeOutTime(m),o.setEffectIds(this.eyeBlinkIds,this.lipSyncIds),h=!0}):o.setFinishedMotionHandler(r),{motion:o,autoDelete:h}}startHandMotion(e,i,r,a,l){if(a==ut.Force)e.setReservePriority(a);else if(!e.reserveMotion(a))return this._debugMode&&I.printMessage("[APP]can't start motion."),vt;const{motion:o,autoDelete:h}=this.getMotion(i,r,l),u=this.modelSetting.getMotionSoundFileName(i,r);if(u.localeCompare("")!=0){let g=this.modelHomeDir+u;this.wavFileHandler.start(g).catch()}return this._debugMode&&I.printMessage(`[APP]start motion: ${name}`),e.startMotionPriority(o,h,a)}startRandomRightHandMotion(e,i,r){if(this.modelSetting.getMotionCount(e)==0)return vt;let a=Math.floor(Math.random()*this.modelSetting.getMotionCount(e));return this.startHandMotion(this._rightArmMotionManager,e,a,i,r)}startRandomLeftHandMotion(e,i,r){if(this.modelSetting.getMotionCount(e)==0)return vt;let a=Math.floor(Math.random()*this.modelSetting.getMotionCount(e));return this.startHandMotion(this._leftArmMotionManager,e,a,i,r)}setExpression(e){const i=this.expressions.getValue(e);this._debugMode&&I.printMessage(`[APP]expression: [${e}]`),i!=null?this._expressionManager.startMotionPriority(i,!1,ut.Force):this._debugMode&&I.printMessage(`[APP]expression[${e}] is null`)}setRandomExpression(){if(this.expressions.getSize()==0)return;const e=Math.floor(Math.random()*this.expressions.getSize());for(let i=0;i<this.expressions.getSize();i++)if(i==e){const r=this.expressions._keyValues[i].first;this.setExpression(r);return}}motionEventFired(e){lt("{0} is fired on LAppModel!!",e.s)}hitOpacity(){return this._opacity<1}hitTest(e,i,r){if(this.hitOpacity())return!1;const a=this.modelSetting.getHitAreasCount();for(let l=0;l<a;l++)if(this.modelSetting.getHitAreaName(l)==e){const o=this.modelSetting.getHitAreaId(l);return this.isHit(o,i,r)}return!1}preLoadMotionGroup(e){for(let i=0;i<this.modelSetting.getMotionCount(e);i++){const r=this.modelSetting.getMotionFileName(e,i),a=`${e}_${i}`;this._debugMode&&I.printMessage(`[APP]load motion: ${r} => [${a}]`),fetch(tt.join(this.modelHomeDir,r)).then(l=>l.arrayBuffer()).then(l=>{const o=this.loadMotion(l,l.byteLength,a);let h=this.modelSetting.getMotionFadeInTimeValue(e,i);h>=0&&o.setFadeInTime(h),h=this.modelSetting.getMotionFadeOutTimeValue(e,i),h>=0&&o.setFadeOutTime(h),o.setEffectIds(this.eyeBlinkIds,this.lipSyncIds),this.motions.getValue(a)!=null&&Ut.delete(this.motions.getValue(a)),this.motions.setValue(a,o),this.motionCount++,this.motionCount>=this.allMotionCount&&this.reloadTextures()})}}reloadTextures(){var e;this.state=20,(e=this._motionManager)==null||e.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(w.gl)}releaseMotions(){this.motions.clear()}releaseExpressions(){this.expressions.clear()}doDraw(){if(this.model==null)return;const e=[0,0,w.canvas.width,w.canvas.height];this.getRenderer().setRenderState(w.frameBuffer,e),this.getRenderer().drawModel()}draw(e){this.model!==null&&this.state==22&&(e.multiplyByMatrix(this._modelMatrix),this.getRenderer().setMvpMatrix(e),this.doDraw())}release(){this._leftArmMotionManager.release(),this._rightArmMotionManager.release(),this.wavFileHandler.release(),super.release()}}const hi=class{constructor(){n(this,"viewMatrix");n(this,"models");n(this,"sceneIndex");n(this,"_finishedMotion",t=>{I.printMessage("Motion Finished: OK")});this.viewMatrix=new k,this.models=new v,this.sceneIndex=0,this.changeScene(0)}static get instance(){return this.initialize()}static initialize(){return this._instance==null&&(this._instance=new hi),this._instance}static releaseInstance(){this._instance!=null&&(this._instance=void 0),this._instance=null}getModel(t){return t<this.models.getSize()?this.models.at(t):null}releaseAllModel(){for(let t=0;t<this.models.getSize();t++)this.models.at(t).release(),this.models.set(t,null);this.models.clear()}onDrag(t,e){for(let i=0;i<this.models.getSize();i++){const r=this.getModel(i);r&&r.setDragging(t,e)}}onTap(t,e){I.printMessage(`[APP]tap point: {x: ${t.toFixed(2)} y: ${e.toFixed(2)}}`);for(let i=0;i<this.models.getSize();i++){const r=this.models.at(i);if(r.modelSetting.getHitAreasCount()===0){I.printMessage(`[APP]hit area: [${D.Other}]`),r.startRandomMotion(Et.Tap,ut.Normal,this._finishedMotion),Lt.emit(D.Other);return}r.hitTest(D.Head,t,e)?(I.printMessage(`[APP]hit area: [${D.Head}]`),r.setRandomExpression(),Lt.emit(D.Head)):r.hitTest(D.Left,t,e)?(I.printMessage(`[APP]hit area: [${D.Body+D.Left}]`),r.startRandomLeftHandMotion(Et.TapLeft,ut.Normal,this._finishedMotion),Lt.emit(D.Left)):r.hitTest(D.Right,t,e)?(I.printMessage(`[APP]hit area: [${D.Body+D.Right}]`),r.startRandomRightHandMotion(Et.TapRight,ut.Normal,this._finishedMotion),Lt.emit(D.Right)):r.hitTest(D.Body,t,e)&&(I.printMessage(`[APP]hit area: [${D.Body}]`),r.startRandomMotion(Et.TapBody,ut.Normal,this._finishedMotion),Lt.emit(D.Body))}}onUpdate(){const{width:t,height:e}=w.canvas,i=this.models.getSize();for(let r=0;r<i;++r){const a=new k,l=this.getModel(r);l.getModel()&&(l.getModel().getCanvasWidth()>1&&t<e?(l.getModelMatrix().setWidth(2),a.scale(1,t/e)):a.scale(e/t,1),a.multiplyByMatrix(this.viewMatrix)),l.update(),l.draw(a)}}prevScene(){const t=(this.sceneIndex-1)%j.source.models.length;this.changeScene(t)}nextScene(){const t=(this.sceneIndex+1)%j.source.models.length;this.changeScene(t)}changeScene(t){this.sceneIndex=t,I.printMessage(`[APP]model index: ${this.sceneIndex}`);const e=j.source.models.at(t),i=tt.join(j.source.path,e);let r=`${e}.model3.json`;this.releaseAllModel(),this.models.pushBack(new yo),this.models.at(0).loadAssets(i,r)}setViewMatrix(t){for(let e=0;e<16;e++)this.viewMatrix.getArray()[e]=t.getArray()[e]}};let Q=hi;n(Q,"_instance",null);class xo{constructor(){n(this,"textures");this.textures=new v}release(){for(let t=this.textures.begin();t.notEqual(this.textures.end());t.preIncrement())w.gl.deleteTexture(t.ptr().id);this.textures=new v}createTextureFromPngFile(t,e,i){for(let a=this.textures.begin();a.notEqual(this.textures.end());a.preIncrement())if(a.ptr().fileName==t&&a.ptr().usePremultply==e){a.ptr().img=new Image,a.ptr().img.onload=()=>i(a.ptr()),a.ptr().img.src=t;return}const r=new Image;r.onload=()=>{const a=w.gl,l=a.createTexture();a.bindTexture(a.TEXTURE_2D,l),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),e&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,r),a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null);const o=new So;o!=null&&(o.fileName=t,o.width=r.width,o.height=r.height,o.id=l,o.img=r,o.usePremultply=e,this.textures.pushBack(o)),i(o)},r.src=t}releaseTextures(){for(let t=0;t<this.textures.getSize();t++)this.textures.set(t,null);this.textures.clear()}releaseTextureByTexture(t){for(let e=0;e<this.textures.getSize();e++)if(this.textures.at(e).id==t){this.textures.set(e,null),this.textures.remove(e);break}}releaseTextureByFilePath(t){for(let e=0;e<this.textures.getSize();e++)if(this.textures.at(e).fileName==t){this.textures.set(e,null),this.textures.remove(e);break}}}class So{constructor(){n(this,"img");n(this,"id",null);n(this,"width",0);n(this,"height",0);n(this,"usePremultply");n(this,"fileName")}}class Sr extends k{constructor(){super();n(this,"_screenLeft");n(this,"_screenRight");n(this,"_screenTop");n(this,"_screenBottom");n(this,"_maxLeft");n(this,"_maxRight");n(this,"_maxTop");n(this,"_maxBottom");n(this,"_maxScale");n(this,"_minScale");this._screenLeft=0,this._screenRight=0,this._screenTop=0,this._screenBottom=0,this._maxLeft=0,this._maxRight=0,this._maxTop=0,this._maxBottom=0,this._maxScale=0,this._minScale=0}adjustTranslate(e,i){this._tr[0]*this._maxLeft+(this._tr[12]+e)>this._screenLeft&&(e=this._screenLeft-this._tr[0]*this._maxLeft-this._tr[12]),this._tr[0]*this._maxRight+(this._tr[12]+e)<this._screenRight&&(e=this._screenRight-this._tr[0]*this._maxRight-this._tr[12]),this._tr[5]*this._maxTop+(this._tr[13]+i)<this._screenTop&&(i=this._screenTop-this._tr[5]*this._maxTop-this._tr[13]),this._tr[5]*this._maxBottom+(this._tr[13]+i)>this._screenBottom&&(i=this._screenBottom-this._tr[5]*this._maxBottom-this._tr[13]);const r=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,i,0,1]);k.multiply(r,this._tr,this._tr)}adjustScale(e,i,r){const a=this.getMaxScale(),l=this.getMinScale(),o=r*this._tr[0];o<l?this._tr[0]>0&&(r=l/this._tr[0]):o>a&&this._tr[0]>0&&(r=a/this._tr[0]);const h=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,i,0,1]),u=new Float32Array([r,0,0,0,0,r,0,0,0,0,1,0,0,0,0,1]),g=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,-e,-i,0,1]);k.multiply(g,this._tr,this._tr),k.multiply(u,this._tr,this._tr),k.multiply(h,this._tr,this._tr)}setScreenRect(e,i,r,a){this._screenLeft=e,this._screenRight=i,this._screenBottom=r,this._screenTop=a}setMaxScreenRect(e,i,r,a){this._maxLeft=e,this._maxRight=i,this._maxTop=a,this._maxBottom=r}setMaxScale(e){this._maxScale=e}setMinScale(e){this._minScale=e}getMaxScale(){return this._maxScale}getMinScale(){return this._minScale}isMaxScale(){return this.getScaleX()>=this._maxScale}isMinScale(){return this.getScaleX()<=this._minScale}getScreenLeft(){return this._screenLeft}getScreenRight(){return this._screenRight}getScreenBottom(){return this._screenBottom}getScreenTop(){return this._screenTop}getMaxLeft(){return this._maxLeft}getMaxRight(){return this._maxRight}getMaxBottom(){return this._maxBottom}getMaxTop(){return this._maxTop}}var Rs;(s=>{s.CubismViewMatrix=Sr})(Rs||(Rs={}));class Co{constructor(t,e,i,r,a,l){n(this,"texture");n(this,"vertexBuffer");n(this,"uvBuffer");n(this,"indexBuffer");n(this,"rect");n(this,"positionLocation");n(this,"uvLocation");n(this,"textureLocation");n(this,"positionArray");n(this,"uvArray");n(this,"indexArray");n(this,"firstDraw");n(this,"hitCallback");this.rect=new Mo,this.rect.left=t-i*.5,this.rect.right=t+i*.5,this.rect.up=e+r*.5,this.rect.down=e-r*.5,this.texture=a,this.vertexBuffer=null,this.uvBuffer=null,this.indexBuffer=null,this.positionLocation=null,this.uvLocation=null,this.textureLocation=null,this.positionArray=null,this.uvArray=null,this.indexArray=null,this.firstDraw=!0,this.hitCallback=l}release(){this.rect=null;const t=w.gl;t.deleteTexture(this.texture),this.texture=null,t.deleteBuffer(this.uvBuffer),this.uvBuffer=null,t.deleteBuffer(this.vertexBuffer),this.vertexBuffer=null,t.deleteBuffer(this.indexBuffer),this.indexBuffer=null}getTexture(){return this.texture}render(t){if(this.texture==null)return;const e=w.gl;if(this.firstDraw){this.positionLocation=e.getAttribLocation(t,"position"),e.enableVertexAttribArray(this.positionLocation),this.uvLocation=e.getAttribLocation(t,"uv"),e.enableVertexAttribArray(this.uvLocation),this.textureLocation=e.getUniformLocation(t,"texture"),e.uniform1i(this.textureLocation,0),this.uvArray=new Float32Array([1,0,0,0,0,1,1,1]),this.uvBuffer=e.createBuffer();{const i=w.canvas.width,r=w.canvas.height;this.positionArray=new Float32Array([(this.rect.right-i*.5)/(i*.5),(this.rect.up-r*.5)/(r*.5),(this.rect.left-i*.5)/(i*.5),(this.rect.up-r*.5)/(r*.5),(this.rect.left-i*.5)/(i*.5),(this.rect.down-r*.5)/(r*.5),(this.rect.right-i*.5)/(i*.5),(this.rect.down-r*.5)/(r*.5)]),this.vertexBuffer=e.createBuffer()}this.indexArray=new Uint16Array([0,1,2,3,2,0]),this.indexBuffer=e.createBuffer(),this.firstDraw=!1}e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvArray,e.STATIC_DRAW),e.vertexAttribPointer(this.uvLocation,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.positionArray,e.STATIC_DRAW),e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indexArray,e.DYNAMIC_DRAW),e.bindTexture(e.TEXTURE_2D,this.texture),e.drawElements(e.TRIANGLES,this.indexArray.length,e.UNSIGNED_SHORT,0)}isHit(t,e){const{height:i}=w.canvas,r=i-e;return t>=this.rect.left&&t<=this.rect.right&&r<=this.rect.up&&r>=this.rect.down}}class Mo{constructor(){n(this,"left");n(this,"right");n(this,"up");n(this,"down")}}class vo{constructor(){n(this,"startY");n(this,"startX");n(this,"lastX");n(this,"lastY");n(this,"lastX1");n(this,"lastY1");n(this,"lastX2");n(this,"lastY2");n(this,"lastTouchDistance");n(this,"deltaX");n(this,"deltaY");n(this,"scale");n(this,"touchSingle");n(this,"flipAvailable");this.startX=0,this.startY=0,this.lastX=0,this.lastY=0,this.lastX1=0,this.lastY1=0,this.lastX2=0,this.lastY2=0,this.lastTouchDistance=0,this.deltaX=0,this.deltaY=0,this.scale=1,this.touchSingle=!1,this.flipAvailable=!1}getCenterX(){return this.lastX}getCenterY(){return this.lastY}getDeltaX(){return this.deltaX}getDeltaY(){return this.deltaY}getStartX(){return this.startX}getStartY(){return this.startY}getScale(){return this.scale}getX(){return this.lastX}getY(){return this.lastY}getX1(){return this.lastX1}getY1(){return this.lastY1}getX2(){return this.lastX2}getY2(){return this.lastY2}isSingleTouch(){return this.touchSingle}isFlickAvailable(){return this.flipAvailable}disableFlick(){this.flipAvailable=!1}touchesBegan(t,e){this.lastX=t,this.lastY=e,this.startX=t,this.startY=e,this.lastTouchDistance=-1,this.flipAvailable=!0,this.touchSingle=!0}touchesMoved(t,e){this.lastX=t,this.lastY=e,this.lastTouchDistance=-1,this.touchSingle=!0}getFlickDistance(){return this.calculateDistance(this.startX,this.startY,this.lastX,this.lastY)}calculateDistance(t,e,i,r){return Math.sqrt((t-i)*(t-i)+(e-r)*(e-r))}calculateMovingAmount(t,e){if(t>0!=e>0)return 0;const i=t>0?1:-1,r=Math.abs(t),a=Math.abs(e);return i*(r<a?r:a)}}class Bo{constructor(){n(this,"touchManager");n(this,"deviceToScreen");n(this,"viewMatrix");n(this,"sprites",[]);n(this,"programId");n(this,"released",!1);this.programId=null,this.released=!1,this.touchManager=new vo,this.deviceToScreen=new k,this.viewMatrix=new Sr}initialize(){const{width:t,height:e}=w.canvas,i=t/e,r=-i,a=i??me.Right,l=me.Bottom,o=me.Top;if(this.viewMatrix.setScreenRect(r,a,l,o),this.viewMatrix.scale(j.scale,j.scale),this.deviceToScreen.loadIdentity(),t>e){const h=Math.abs(a-r);this.deviceToScreen.scaleRelative(h/t,-h/t)}else{const h=Math.abs(o-l);this.deviceToScreen.scaleRelative(h/e,-h/e)}this.deviceToScreen.translateRelative(-t*.5,-e*.5),this.viewMatrix.setMaxScale(Ge.Max),this.viewMatrix.setMinScale(Ge.Min),this.viewMatrix.setMaxScreenRect(Ht.Left,Ht.Right,Ht.Bottom,Ht.Top)}release(){this.sprites.forEach(t=>t.release()),this.sprites.length=0,w.gl.deleteProgram(this.programId),this.released=!0}render(){const t=w.gl;t.useProgram(this.programId),this.sprites.forEach(e=>e.render(this.programId)),t.flush(),Q.instance.setViewMatrix(this.viewMatrix),Q.instance.onUpdate()}addSprite(t,e,i,r){w.instance.textureManager.createTextureFromPngFile(t,!1,a=>{const{width:l,height:o}=w.canvas,h=e?e.x:l-a.width*.5,u=e?e.y:o-a.height*.5,g=i?i.width:a.width,m=i?i.height:a.height,p=new Co(h,u,g,m,a.id,r);this.sprites.push(p)})}initializeSprite(){this.programId=w.instance.createShader()}onTouchesBegan(t,e){this.touchManager.touchesBegan(t,e)}onTouchesMoved(t,e){const i=this.transformViewX(this.touchManager.getX()),r=this.transformViewY(this.touchManager.getY());this.touchManager.touchesMoved(t,e),Q.instance.onDrag(i,r)}onTouchesEnded(t,e){Q.instance.onDrag(0,0);{const i=this.deviceToScreen.transformX(this.touchManager.getX()),r=this.deviceToScreen.transformY(this.touchManager.getY());"ontouchend"in w.canvas&&I.printMessage(`[APP]touchesEnded x: ${i} y: ${r}`),Q.instance.onTap(i,r),this.sprites.forEach(a=>{a.isHit(t,e)&&a.hitCallback()})}}transformViewX(t){const e=this.deviceToScreen.transformX(t);return this.viewMatrix.invertTransformX(e)}transformViewY(t){const e=this.deviceToScreen.transformY(t);return this.viewMatrix.invertTransformY(e)}transformScreenX(t){return this.deviceToScreen.transformX(t)}transformScreenY(t){return this.deviceToScreen.transformY(t)}}const N=class{constructor(){n(this,"cubismOption");n(this,"view");n(this,"captured");n(this,"textureManager");n(this,"canvasId","live2d-canvas");n(this,"loopId",0);this.captured=!1,this.cubismOption=new Ma,this.view=new Bo,this.textureManager=new xo}static get instance(){return this._instance==null&&(this._instance=new N),this._instance}static releaseInstance(){this._instance!=null&&this._instance.release(),this._instance=null}initialize(){const t=N.canvas=this.getCanvas(),e=N.gl=t.getContext("webgl")||t.getContext("experimental-webgl");return e?(N.frameBuffer||(N.frameBuffer=e.getParameter(e.FRAMEBUFFER_BINDING)),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.onEvent(),this.view.initialize(),this.initializeCubism(),!0):(alert("Cannot initialize WebGL. This browser does not support."),N.gl=null,bt.body.innerHTML="This browser does not support the <code>&lt;canvas&gt;</code> element.",!1)}getCanvas(){let t=bt.querySelector(`#${this.canvasId}`);return t?this.release():(t=bt.createElement("canvas"),t.setAttribute("id",this.canvasId)),j.canvas==="auto"?this._resizeCanvas():(t.width=j.canvas.width||t.width,t.height=j.canvas.height||t.height),j.target.appendChild(t),t}onEvent(){const t=N.canvas;"ontouchend"in t?(t.ontouchstart=To,t.ontouchmove=Io,t.ontouchend=Ls,t.ontouchcancel=Ls):(t.onmousedown=bo,t.onmousemove=Po,t.onmouseup=wo)}onResize(){this._resizeCanvas(),this.view.initialize(),this.view.initializeSprite();const{width:t,height:e}=N.canvas;N.gl.viewport(0,0,t,e)}release(){this.textureManager.release(),this.view.release(),cancelAnimationFrame(this.loopId),Q.releaseInstance(),L.dispose()}run(){const t=()=>{if(!N.instance)return;I.updateTime();const e=N.gl;e.clearColor(0,0,0,0),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.clearDepth(1),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.view.render(),this.loopId=requestAnimationFrame(t)};t()}createShader(){const t=N.gl,e=t.createShader(t.VERTEX_SHADER);if(e===null)return I.printMessage("failed to create vertexShader"),null;const i=`
        precision mediump float;
        attribute vec3 position;
        attribute vec2 uv;
        varying vec2 vuv;
        void main(void)
        {
           gl_Position = vec4(position, 1.0);
           vuv = uv;
        }
      `;t.shaderSource(e,i),t.compileShader(e);const r=t.createShader(t.FRAGMENT_SHADER);if(r==null)return I.printMessage("failed to create fragmentShader"),null;const a=`
        precision mediump float;
        varying vec2 vuv;
        uniform sampler2D texture;
        void main(void)
        {
           gl_FragColor = texture2D(texture, vuv);
        }
      `;t.shaderSource(r,a),t.compileShader(r);const l=t.createProgram();return t.attachShader(l,e),t.attachShader(l,r),t.deleteShader(e),t.deleteShader(r),t.linkProgram(l),t.useProgram(l),l}initializeCubism(){this.cubismOption.logFunction=I.printMessage,this.cubismOption.loggingLevel=At.LogLevel_Error,L.startUp(this.cubismOption),L.initialize(),Q.initialize(),I.updateTime(),this.view.initializeSprite()}_resizeCanvas(){N.canvas.width=window.innerWidth,N.canvas.height=window.innerHeight}};let w=N;n(w,"_instance",null),n(w,"frameBuffer",null),n(w,"canvas",null),n(w,"gl",null);function bo(s){if(w.instance.captured=!0,w.instance.view.released){I.printMessage("view released");return}const t=s.target.getBoundingClientRect(),e=s.pageX-t.left,i=s.pageY-t.top;w.instance.view.onTouchesBegan(e,i)}function Po(s){if(!w.instance.captured)return;if(w.instance.view.released){I.printMessage("view released");return}const t=s.target.getBoundingClientRect(),e=s.clientX-t.left,i=s.clientY-t.top;w.instance.view.onTouchesMoved(e,i)}function wo(s){if(w.instance.captured=!1,w.instance.view.released){I.printMessage("view released");return}const t=s.target.getBoundingClientRect(),e=s.clientX-t.left,i=s.clientY-t.top;w.instance.view.onTouchesEnded(e,i)}function To(s){if(w.instance.captured=!0,w.instance.view.released){I.printMessage("view released");return}const t=s.target.getBoundingClientRect(),e=s.changedTouches[0].clientX-t.left,i=s.changedTouches[0].clientY-t.top;w.instance.view.onTouchesBegan(e,i)}function Io(s){if(!w.instance.captured)return;if(w.instance.view.released){I.printMessage("view released");return}const t=s.target.getBoundingClientRect(),e=s.changedTouches[0].clientX-t.left,i=s.changedTouches[0].clientY-t.top;w.instance.view.onTouchesMoved(e,i)}function Ls(s){if(w.instance.captured=!1,w.instance.view.released){I.printMessage("view released");return}const t=s.target.getBoundingClientRect(),e=s.changedTouches[0].clientX-t.left,i=s.changedTouches[0].clientY-t.top;w.instance.view.onTouchesEnded(e,i)}class Cr{static get model(){return w.instance}static get scene(){return Q.instance}static get view(){return this.model.view}static async loadScript(){return new Promise(t=>{globalThis.Live2DCubismCore&&t(globalThis.Live2DCubismCore);const e=bt.createElement("script");e.src=j.cubismCorePath,bt.body.appendChild(e),e.onload=()=>t(globalThis.Live2DCubismCore)})}static async init(t){fa(t),await this.loadScript(),this.model.initialize()&&(this.model.run(),this.listener())}static async release(){return this.model.release()}static listener(){window.addEventListener("beforeunload",()=>this.model.release()),window.addEventListener("resize",()=>j.canvas==="auto"&&this.model.onResize())}static on(t,e){var i;(i=this.eventListener[t])==null||i.push(e)}static emit(t){var e;(e=this.eventListener[t])==null||e.forEach(i=>i())}}n(Cr,"eventListener",{[D.Head]:[],[D.Body]:[],[D.Left]:[],[D.Right]:[],[D.Other]:[]});var Lt=Cr;const Vo=ie({__name:"Live2dWidget",props:{isDark:{type:Boolean}},setup(s){const t=s,e=ti(()=>localStorage.getItem("vitepress-theme-appearance")==="dark"||t.isDark),i=Gt(null);return Ke(()=>{i.value&&Lt.init({canvas:{width:180,height:180},target:i.value,source:{path:mi("/live2d/models"),models:e.value?["hijiki"]:["tororo"]},cubismCorePath:mi("/live2d/core/live2dCubismCore.min.js")})}),(r,a)=>(nt(),ot("div",{id:"models",ref_key:"elRef",ref:i},null,512))}});const Ro=Pe(Vo,[["__scopeId","data-v-1cb62c03"]]);const Lo=["height","width"],Eo=["fill","href"],Ao={__name:"SvgIcon",props:{prefix:{type:String,default:"icon"},name:{type:String,required:!0},color:{type:String,default:"currentColor"},size:{type:String,default:"1em"}},setup(s){const t=s,e=ti(()=>`#${t.prefix}-${t.name}`);return(i,r)=>(nt(),ot("svg",{height:s.size,width:s.size,"aria-hidden":"true",class:"svg-icon"},[F("use",{fill:s.color,href:e.value},null,8,Eo)],8,Lo))}},Fo=Pe(Ao,[["__scopeId","data-v-7f6d403c"]]);if(typeof window<"u"){let s=function(){var t=document.body,e=document.getElementById("__svg__icons__dom__");e||(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.style.position="absolute",e.style.width="0",e.style.height="0",e.id="__svg__icons__dom__",e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:link","http://www.w3.org/1999/xlink")),e.innerHTML='<symbol viewBox="0 0 1024 1024"  id="icon-create"><path d="M531.115 299.008a32.313 32.313 0 0 0-32.313 32.313v161.45H380.416a32.313 32.313 0 0 0 0 64.626h150.699a32.313 32.313 0 0 0 32.313-32.313V331.321a32.313 32.313 0 0 0-32.313-32.313z" /><path d="M490.098 96.597c-210.205 10.98-382.521 183.296-393.5 393.5a416.654 416.654 0 0 0 383.601 437.818 29.98 29.98 0 0 0 32.427-29.81 29.525 29.525 0 0 0-27.25-29.525 357.376 357.376 0 0 1-327.566-396.8c18.204-163.556 150.414-295.823 314.026-314.027a357.433 357.433 0 0 1 396.744 327.68c1.251 15.36 14.108 27.193 29.525 27.193a29.98 29.98 0 0 0 29.81-32.427A416.654 416.654 0 0 0 490.098 96.597z" /><path d="M873.7 714.126h-99.215v-99.214a29.81 29.81 0 1 0-59.505 0v99.214h-99.1a29.81 29.81 0 1 0 0 59.45h99.1v99.213a29.81 29.81 0 0 0 59.505 0v-99.214H873.7a29.81 29.81 0 1 0 0-59.449z" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-tags"><path d="M510.816 971.85c-26.485 0-50.933-9.567-68.501-27.125L166.752 669.163c-20.437-20.438-30.037-50.187-26.357-81.632 3.392-28.96 17.482-57.12 39.658-79.296L568.907 119.38a33.516 33.516 0 0 1 24.138-9.834l372.267 4.224c18.283.202 33.045 14.997 33.216 33.29l3.403 371.446a33.59 33.59 0 0 1-9.846 24.064L603.243 931.424c-22.176 22.176-50.336 36.256-79.296 39.659-4.416.512-8.8.768-13.131.768zm95.616-794.954L227.573 555.755c-11.36 11.36-18.805 25.802-20.426 39.605-.747 6.4-.822 18.336 7.125 26.293l275.563 275.563c7.957 7.957 19.882 7.883 26.293 7.125 13.803-1.621 28.235-9.066 39.605-20.426l378.88-378.88-2.976-324.438-325.205-3.701z" /><path d="M302.72 910.507a33.495 33.495 0 0 1-23.755-9.846L52.31 674.016c-21.29-21.29-32.213-51.744-29.941-83.552 2.165-30.475 15.797-59.69 38.368-82.261l303.616-303.616c13.12-13.12 34.4-13.12 47.52 0 13.12 13.12 13.12 34.4 0 47.52L108.245 555.712c-10.976 10.976-17.845 25.376-18.848 39.51-.896 12.543 2.816 23.647 10.432 31.263l226.656 226.656c13.12 13.12 13.12 34.4 0 47.52-6.57 6.571-15.168 9.846-23.765 9.846zm388.15-368.662c-31.062 0-62.123-11.818-85.771-35.466-22.912-22.912-35.531-53.366-35.531-85.771s12.619-62.859 35.53-85.77c47.297-47.286 124.246-47.297 171.531 0s47.296 124.245 0 171.53c-23.637 23.659-54.698 35.477-85.76 35.477zm62.005-59.221zm-62.006-116.085c-13.856 0-27.701 5.269-38.25 15.818-10.219 10.219-15.84 23.798-15.84 38.251s5.632 28.032 15.84 38.25c21.088 21.089 55.413 21.089 76.501 0 21.088-21.087 21.088-55.413 0-76.5-10.55-10.54-24.405-15.82-38.25-15.82z" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-update"><path d="M694.4 419.2a272 272 0 1 1 0 544 272 272 0 0 1 0-544zM290.56 66.944c5.76 0 10.688 3.84 12.16 8.96l.448 3.264v47.168h416V79.168a12.16 12.16 0 0 1 9.216-11.84l3.392-.384h34.176c5.824 0 10.688 3.84 12.16 8.96l.448 3.264v47.168h59.52c62.464 0 113.664 48.384 118.4 109.504l.384 9.28v118.912h-832v475.52a59.52 59.52 0 0 0 52.48 58.88l6.976.448h239.36v59.392H184.32a118.912 118.912 0 0 1-118.464-109.44l-.384-9.28V245.12c0-62.464 48.192-113.664 109.568-118.4l9.28-.384h59.456V79.168a12.16 12.16 0 0 1 9.152-11.84l3.456-.384h34.176zM694.4 475.776a213.888 213.888 0 0 0-152.192 63.04 214.592 214.592 0 0 0-63.04 152.32 213.888 213.888 0 0 0 63.04 152.192 214.592 214.592 0 0 0 152.256 63.04 213.888 213.888 0 0 0 152.256-63.04 214.592 214.592 0 0 0 63.04-152.256 213.888 213.888 0 0 0-63.04-152.256 214.592 214.592 0 0 0-152.32-63.04zm0 19.008c13.952 0 25.6 10.048 27.968 23.232l.448 5.12-.064 139.584h83.84c12.16 0 22.592 7.68 26.624 18.496l1.28 4.8.448 5.12a28.352 28.352 0 0 1-23.232 27.84l-5.12.448H694.464a28.352 28.352 0 0 1-27.904-23.232l-.448-5.12V523.2c0-15.616 12.672-28.352 28.352-28.352zM243.84 185.856h-59.52a59.328 59.328 0 0 0-58.944 52.352l-.384 6.976v59.52h772.48v-59.52a59.52 59.52 0 0 0-52.48-58.944l-6.912-.384h-59.456v47.168a12.16 12.16 0 0 1-9.152 11.776l-3.456.448H731.84a12.608 12.608 0 0 1-12.16-8.96l-.448-3.264v-47.168h-416v47.168a12.16 12.16 0 0 1-9.152 11.776l-3.456.448h-34.176a12.608 12.608 0 0 1-12.16-8.96l-.448-3.264v-47.168z" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-dog"><path d="m894.814 904.435 83.24-183.135-13.823-13.204c-.485-.458-45.65-47.59-47.94-185.263-.134-7.923-.134-33.954-.134-55.997-30.693 15.306-70.09 19.887-106.092 19.887-92.753 0-163.625-23.983-210.648-71.275a192.512 192.512 0 0 1-27.944-36.514h-194.21v377.263c342.663 0 403.106 51.092 494.592 128.377 7.923 6.683 15.522 13.312 22.96 19.86z" fill="#85C3DE" /><path d="M326.063 282.947c0 34.25-13.231 44.464-29.642 44.464s-29.642-10.214-29.642-44.464c0-34.223 13.231-44.463 29.642-44.463s29.642 10.24 29.642 44.463zm-56.59 147.349v311.646L190.276 916.21h59.204l73.89-162.574V377.263H296.42c-119.404 0-172.733-53.383-185.506-107.79h35.625c51.092 0 68.58-15.764 120.535-62.544 12.773-11.507 28.08-25.277 47.024-41.742l18.35-15.952-69.658-99.14-44.086 30.99 41.768 59.472c-11.183 9.863-20.884 18.594-29.48 26.328-50.257 45.272-54.757 48.694-84.453 48.694H53.895v26.947c0 88.711 66.91 178.15 215.579 187.77zM486.185 268.88c2.29 71.734 28.7 136.327 75.049 182.919 57.479 57.829 141.204 87.147 248.859 87.147 18.593 0 36.19-1.158 52.628-3.449 3.746 111.266 33.63 170.334 51.496 196.015l-38.507 84.723c-93.535-74.186-186.934-115.604-498.446-115.604v53.894c34.277 0 65.698.512 94.64 1.51l-97.308 214.07H433.8l96.013-211.241c66.183 4.338 117.006 11.83 157.912 22.016L626.23 916.21h59.176l54.165-119.135c47.616 18.405 79.737 42.092 113.125 69.74l-46.943 103.29h59.204l113.07-248.779-13.823-13.204c-.485-.458-45.65-47.59-47.94-185.263C985.17 498.553 1024 447.81 1024 377.263c0-95.205-66.506-161.684-161.684-161.684v53.895c65.482 0 107.79 42.307 107.79 107.79 0 89.087-87.014 107.789-160.014 107.789-92.753 0-163.625-23.984-210.648-71.276-30.316-30.505-45.891-65.833-53.356-98.735 11.21 6.952 22.933 13.339 35.275 19.186l23.04-48.72C512.296 241.852 455.41 156.86 385.159 41.525l-46.026 28.052c49.448 81.246 92.968 148.507 147.051 199.303z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-dragon"><path d="m366.376 344.441 152.98-152.98c43.143-43.143 141.205-9.216 270.202 115.739-15.225 9.836-25.115 15.818-44.14 32.256s-38.077 35.49-59.419 56.832c-4.204 4.204-51.173 53.221-78.74 82.028-10.806-12.127-22.744-24.172-34.654-36.083l-79.468-79.44-54.218 54.218-72.543-72.57zM862.316 512c0 46.835-45.353 80.842-107.79 80.842-108.948 0-189.359-28.807-267.129-56.697-73.297-26.274-142.525-51.092-229.214-51.092C80.788 485.053 0 588.126 0 683.897h53.895c19.321-24.118 81.408-37.16 123.446-37.16 77.339 0 223.124 23.282 291.894 47.912 78.228 28.052 146.755 59.877 265.08 59.877 128 0 181.896-84.21 181.896-242.526h-53.895z" fill="#FF8787" /><path d="M552.421 1024c-69.767 0-113.826-13.959-156.402-27.46-54.488-17.273-110.808-35.004-232.422-26.516l-3.826-53.733c131.719-9.458 195.934 10.968 252.524 28.888 42.226 13.366 78.686 24.926 140.126 24.926 92.753 0 148.21-57.937 148.21-113.96 0-16.95-5.524-101.619-114.634-101.619-64.97 0-112.747 23.337-163.328 48.02-57.344 28.026-122.368 59.77-218.381 59.77C85.908 862.316 0 787.294 0 683.897c0-95.77 80.788-198.844 258.183-198.844 86.69 0 155.917 24.818 229.214 51.092 45.81 16.41 92.564 33.172 145.489 44.167 9-7.034 13.85-16.277 13.85-26.76 0-37.187-37.672-74.859-74.131-111.265L569.317 439l38.104-38.104 3.26 3.288c42.173 42.091 89.95 89.842 89.95 149.369 0 12.719-2.802 24.926-7.976 36.11a594.998 594.998 0 0 0 61.871 3.18c62.437 0 107.79-34.008 107.79-80.843 0-58.853-52.87-110.269-108.84-164.702l-8.058-7.842c-19.025 16.438-38.077 35.49-59.419 56.832l-38.103-38.104C722.7 283.352 782.794 223.286 916.21 216.253V55.619c-63.408 7.788-120.994 39.424-121.668 39.802l-15.818 8.811-14.12-11.344c-32.903-26.436-54.892-38.993-90.92-38.993-41.419 0-74.349 25.87-109.192 53.302-26.624 20.91-54.137 42.55-86.85 53.194l-8.3 1.293h-69.094L294.723 267.21l-38.103-38.13 67.395-67.396h-162.33V107.79h303.103c22.232-8.272 43.709-25.168 66.399-42.98C569.829 34.438 613.619 0 673.684 0c48.91 0 81.408 17.947 110.889 40.098C813.703 26.3 877.73 0 943.158 0h26.947v323.368h-53.894v-53.167c-54.165 3.1-92.915 15.845-127.003 36.676l1.832 1.778C852.588 368.505 916.21 430.376 916.21 512c0 60.928-43.708 109.945-107.789 127.623v61.009h53.895v-53.895h53.895v53.895h53.894v53.894h-53.894v53.895h-53.895v-53.895H808.42c-29.723 0-53.895-24.171-53.895-53.894v-53.895c-118.326 0-207.063-31.798-285.318-59.877-68.77-24.63-133.713-47.913-211.025-47.913-141.124 0-204.288 72.785-204.288 144.95 0 73.324 61.844 124.524 150.393 124.524 11.91 0 23.229-.539 34.035-1.536 10.132-10.563 31.15-36.244 31.15-67.719 0-33.118-43.088-70.98-58.152-81.596l30.936-44.14c8.3 5.794 81.111 58.664 81.111 125.736 0 19.43-4.527 37.053-10.994 52.305 30.774-10.051 58.314-23.498 86.663-37.349 53.84-26.274 109.54-53.49 186.96-53.49 116.413 0 168.53 78.093 168.53 155.513 0 82.513-75.615 167.855-202.106 167.855zm-21.18-623.104-38.104-38.104 137.89-137.89 38.103 38.104-137.89 137.89zM404.48 382.545l-38.104-38.104 152.98-152.98 38.104 38.104-152.98 152.98zM686.484 163.92c15.495-9.755 43.332-31.448 43.332-31.448-25.735-27.81-49.557-33.334-67.369-29.076-19.24 4.608-37.753 24.603-37.753 24.603s42.253 22.447 61.79 35.92z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-goat"><path d="M548.379 646.737a952.32 952.32 0 0 1 140.908-161.684H107.789c0 107.6 0 107.6-63.65 169.283L31.07 667.001l35.652 87.525h417.172c20.345-41.472 43.655-77.446 64.485-107.79z" fill="#F7C768" /><path d="M608.256 144.734c-52.493-29.157-102.157-36.945-123.203-36.945V53.895c32.579 0 91.27 11.452 149.369 43.735 75.29 41.823 130.695 94.532 171.385 150.879-49.933 39.504-108.706 74.86-159.07 74.86h-107.79v-53.895h107.79c20.507 0 48.424-11.21 80.438-31.286a471.04 471.04 0 0 0-118.919-93.454zm224.418 197.498c-16.384 0-29.642 10.24-29.642 44.463 0 34.25 13.23 44.463 29.642 44.463s29.642-10.213 29.642-44.463c0-34.223-13.231-44.463-29.642-44.463zM1024 619.789c0-272.68-122.934-497.34-337.246-616.394L660.588 50.5c253.736 140.962 304.1 389.902 309.06 542.343H885.14c-17.92-35.624-45.352-69.12-87.013-101.996l-16.788-13.285-16.734 13.393c-66.13 52.898-134.63 127.084-187.312 209.678H102.966l-8.273-20.319c64.35-63.3 66.991-77.204 66.991-195.26v-53.895h485.053v-53.895H161.684c0-80.384 14.31-110.026 66.587-137.916l-25.384-47.536c-79.522 42.416-95.098 100.11-95.098 185.452v107.79c0 107.6 0 107.6-63.65 169.283L31.07 667.001l79.549 195.315h58.206l-43.897-107.79h103.478l43.897 107.79h58.206l-43.897-107.79h259.476c-37.106 70.414-61.035 144.627-61.035 215.58h53.894c0-68.69 27.271-144.061 68.959-215.58h79.252c7.41 0 13.474 6.063 13.474 13.474v94.316h53.894V768c0-37.16-30.208-67.368-67.368-67.368h-44.652c40.771-58.018 89.438-111.428 138.914-153.627 60.092 53.032 80.896 108.22 80.896 207.521h53.895c0-38.912-2.75-74.482-11.103-107.79H1024V619.79z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-horse"><path d="M776.003 646.737c16.6-99.948 43.44-181.086 83.214-256.54l6.818-12.934H269.474c-36.757 0-53.895 54.946-53.895 92.052 0 46.754 6.656 77.528 70.279 176.074l84.534 128.27 128.485-126.922h277.126z" fill="#FFAF6E" /><path d="M1024 0v404.21c0 33.334 0 134.737-92.08 134.737h-13.823l-78.363-109.056c-22.744 49.907-40.34 103.047-53.49 162.951h115.092c35.974 0 68.77 32.795 68.77 68.797 0 60.631-69.39 154.3-77.313 164.756l-43.008-32.472c25.681-34.061 66.426-100.11 66.426-132.284 0-5.983-8.92-14.902-14.902-14.902H775.976c-14.848 89.384-21.45 193.832-21.45 323.368h-53.894c0-283.971 31.097-453.605 110.888-605.049l20.318-38.535L944.64 483.517c14.444-4.42 25.465-20.938 25.465-79.306V0H1024zM862.316 161.684h53.895V0h-53.895v80.842c-17.381-14.956-38.185-26.947-80.842-26.947H646.737v53.894h134.737c37.672 0 80.842 40.907 80.842 53.895zm-107.79 0H538.947v53.895h161.685l53.894-53.895zm-453.632 604.86 99.786 149.667h64.755l-95.043-142.552 128.485-126.922h167.855a1212.632 1212.632 0 0 1 9.431-53.895H476.78L300.894 766.545zm109.973-184.4-37.862-38.32-132.419 130.803c-66.856-103.531-78.902-144.815-78.902-205.312 0-70.736 37.78-145.947 107.79-145.947h323.368l53.895-53.894H269.474c-6.71 0-13.258.566-19.699 1.482-14.848-21.504-45.137-55.377-89.142-55.377C65.967 215.579 0 349.292 0 469.315c0 70.171 16.141 136.65 49.233 202.672L6.198 723.833l41.472 34.412 66.129-79.737-8.704-16.034c-21.99-40.34-51.2-104.26-51.2-193.159 0-100.864 52.87-199.841 106.738-199.841 13.231 0 25.816 9.89 35.436 20.534-53.194 31.96-88.28 98.492-88.28 179.307 0 78.202 19.699 130.938 93.643 243.982l-55.296 54.622 134.763 202.186h64.755L215.606 775.033l195.26-192.889z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-monkey"><path d="M757.733 485.053H565.895a80.842 80.842 0 0 0-80.842 80.842v215.579c0 40.96 43.547 99.678 77.446 139.21 33.927 39.532 40.556 49.421 40.556 49.421h151.471s15.145-18.674 45.892-58.071 61.898-102.05 61.898-194.426c0-89.573-47.993-166.346-104.583-232.555z" fill="#C3D686" /><path d="M538.947 1024h-53.894c0-32.795 25.87-87.417 77.446-103.316-33.9-39.532-77.446-98.25-77.446-139.21 0-44.571 36.27-80.842 80.842-80.842h80.842v53.894h-80.842a26.947 26.947 0 0 0-26.948 26.948c0 19.725 36.676 77.473 92.133 134.737h88.603c20.21-14.148 88.738-71.465 88.738-198.603 0-108.382-93.238-202.967-168.152-278.986-49.502-50.203-88.576-89.842-98.735-128.62-11.749-44.732-21.585-112.586-26.327-148.318H377.263c-45.137 0-89.519 8.435-121.802 53.895h175.697v53.895c-97.28 0-107.79 113.07-107.79 161.684v53.895h53.895v161.684h-53.895v-107.79h-26.947c-170.253 0-188.632-94.235-188.632-134.736 0-31.044 35.22-72.327 55.728-93.723 2.694-14.687 5.847-28.35 9.431-41.014h-11.264v-53.895h31.529c46.43-94.585 124.011-107.79 184.05-107.79h185.64l2.803 23.795c.135 1.05 12.72 106.658 27.945 164.756 6.494 24.873 44.624 63.515 84.965 104.448 81.866 83.025 183.7 186.341 183.7 316.82 0 92.376-31.124 155.029-61.898 194.426 104.502-19.887 169.687-109.03 169.687-238.35 0-91.405-42.82-154.381-84.237-215.255-38.077-55.97-77.447-113.853-77.447-188.955 0-119.35 87.094-161.685 161.684-161.685v53.895c-32.417 0-107.79 10.51-107.79 107.79 0 58.502 31.556 104.933 68.097 158.639C974.282 492.598 1024 565.679 1024 673.684c0 177.287-108.301 296.421-269.474 296.421H592.842c-37.672 0-53.895 40.906-53.895 53.895zM229.214 269.474a384.808 384.808 0 0 0-14.012 58.34l-1.402 8.49-6.09 6.116c-22.878 22.932-44.813 52.601-46.026 62.276 0 56.805 53.76 75.264 107.79 79.387v-52.925c0-58.691 13.473-119.62 46.51-161.684h-86.77zM323.368 1024h-53.894c0-32.795 25.87-87.417 77.446-103.316-33.9-39.532-77.446-98.25-77.446-139.21 0-44.571 36.27-80.842 80.842-80.842h45.164a188.847 188.847 0 0 1 170.415-107.79h134.737v53.895H565.895c-74.294 0-134.737 60.443-134.737 134.737v26.516l-53.895.377v-26.893c0-9.162.647-18.136 1.913-26.948h-28.86c-14.848 0-26.948 12.073-26.948 26.948 0 19.725 36.676 77.473 92.133 134.737h15.657v53.894h-53.895c-37.672 0-53.895 40.906-53.895 53.895z" fill="currentColor" /></symbol><symbol viewBox="0 0 1025 1024"  id="icon-zodiac-ox"><path d="M540.295 754.526h215.579c20.21 0 35.112 1.375 53.894 4.581 91.864 15.657 145.355 67.692 161.685 86.07v71.034h53.894V635.58l-7.895-7.896c-9.27-9.27-36.514-49.233-44.032-196.527H540.295A161.684 161.684 0 0 0 378.61 592.842v131.1c43.304 20.21 97.28 30.584 161.684 30.584z" fill="#FFAF6E" /><path d="M1025.347 635.58v280.63h-53.894v-71.033c-16.33-18.405-69.821-70.413-161.685-86.07v157.104h-53.894V754.526h-107.79v215.58H594.19V700.631h161.685c100.998 0 172.57 38.67 215.579 71.868V656.761c-33.685-43.628-51.712-137.458-53.706-279.498H701.979c-76.935 0-127.219-26.22-175.805-51.55a1556.049 1556.049 0 0 0-26.84-13.743c-26.839 26.004-66.209 44.92-115.738 55.511 24.441 22.986 60.874 52.116 106.469 72.839l-22.313 49.044c-76.584-34.816-129.59-88.926-150.824-113.125-10.644.62-21.477 1.024-32.687 1.024a473.735 473.735 0 0 1-123.365-15.953L67.853 547.624l68.582 53.868c31.447-21.935 101.456-62.545 188.28-62.545v53.895c-95.986 0-170.36 62.491-171.088 63.138l-16.788 14.282L0 562.904l109.73-219.81C46.43 314.449 1.347 267.372 1.347 199.869c0-110.053 120.24-145.974 161.685-145.974v53.894c-14.12 0-107.79 17.166-107.79 92.08 0 90.597 136.947 123.5 228.999 123.5 67.907 0 122.422-12.99 157.696-35.625-42.712-14.336-95.097-23.12-169.337-18.324l-3.504-53.787c95.88-6.117 160.149 8.515 211.43 28.834 3.718-9.028 5.874-18.648 5.874-28.888 0-48.856-57.83-76.288-58.395-76.558l22.393-49.017c3.665 1.644 89.897 41.823 89.897 125.575 0 18.567-3.423 35.84-9.998 51.631 7.06 3.584 13.986 7.168 20.777 10.698 46.78 24.415 87.174 45.46 150.905 45.46h269.474v26.948c0 214.69 35.22 266.59 45.999 277.37l7.895 7.895zm-729.384 25.143-98.79 118.541L283.972 917.1l45.595-28.726-65.913-104.69 37.053-44.437c57.937 45.945 138.374 69.174 239.589 69.174v-53.895c-99.894 0-175.077-24.549-223.475-72.946l-20.857-20.857z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-pig"><path d="M732.08 377.263c-107.79 0-186.423 31.394-281.87 126.841L180.332 773.982c77.393 33.927 168.394 34.44 304.72 34.44h96.014c55.835-34.413 133.551-53.896 227.355-53.896h121.344l40.34-73.97V572.632c0-94.316-130.236-195.369-238.026-195.369z" fill="#FFBDD8" /><path d="M808.421 700.632v53.894c-196.446 0-323.368 84.642-323.368 215.58h-53.895c0-163.706 148.076-269.474 377.263-269.474zm-323.368 107.79v-53.896c-158.343 0-245.599 0-319.65-49.367l-6.79-4.527h-77.77c-21.694 0-26.625-14.821-26.948-26.948v-82.62C138.05 579.88 215.579 516.15 215.579 404.21V215.579h-53.895v161.684h-26.947C67.773 377.263 0 414.29 0 485.053h53.895c0-42.631 52.87-53.895 80.842-53.895h24.63c-12.234 73.755-74.213 107.79-132.42 107.79H0v134.736c0 32.499 21.53 80.842 80.842 80.842h61.683c32.687 20.507 67.126 33.146 105.957 41.014a232.88 232.88 0 0 0-32.903 120.67h53.895c0-41.93 14.012-80.303 39.424-112.505 49.987 4.447 107.062 4.716 176.155 4.716zM412.106 466l-88.738 88.738V431.158h-53.894V684.84L450.21 504.104l-38.104-38.103zm-88.738-304.317h-53.894v190.033a769.536 769.536 0 0 1 53.894-49.098V161.684zm323.369-53.895c-72.623 0-146.81 23.337-215.58 58.638v-58.638h-53.894v154.14c81.57-56.536 178.068-100.245 269.474-100.245 148.588 0 269.474 120.886 269.474 269.474v235.655L809.58 862.316h61.359l99.166-181.76V431.158c0-178.31-145.057-323.369-323.368-323.369z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-rabbit"><path d="M680.96 488.744a1666.668 1666.668 0 0 0-54.434-23.956c-16.006 12.234-33.9 20.265-60.631 20.265h-80.842c-36.81 0-83.645 30.396-104.394 67.772-42.82 77.124-53.41 117.814-11.022 201.701 27.46 54.353 61.52 121.883 61.52 215.58h338.54l68.34-138.86c20.129-40.96 24.252-73.702 24.252-110.35.027-57.398-25.061-159.717-181.329-232.152z" fill="#FFBDD8" /><path d="M862.316 720.896c0 36.621-4.123 69.39-24.253 110.35l-68.365 138.86H485.053V916.21h48.37c-25.546-36.137-48.37-82.702-48.37-134.737 0-59.42 24.171-113.314 63.218-152.36l38.104 38.103a161.091 161.091 0 0 0-47.428 114.257c0 54.784 35.382 104.043 63.515 134.737h133.713l53.49-108.76c15.711-31.852 18.756-55.835 18.756-86.555 0-80.977-63.434-150.097-178.607-195.503-17.543 8.138-38.292 13.554-63.92 13.554h-80.841c-13.96 0-43.925 15.98-57.29 40.017l-47.104-26.166c20.749-37.349 67.584-67.745 104.394-67.745h80.842c37.268 0 57.478-15.441 79.09-36.46-19.617-112.398-95.232-179.12-159.932-179.12h-107.79a21.288 21.288 0 0 0-5.955 2.022 683.763 683.763 0 0 0-69.12-77.474c-35.84-34.223-61.764-58.934-94.909-79.44a42.442 42.442 0 0 0-21.8-6.792 22.824 22.824 0 0 0-17.381 7.195c-10.914 11.426-6.063 28.241 1.428 39.182 21.989 32.121 47.912 56.859 83.752 91.109 20.615 19.672 49.26 43.17 77.393 63.084C281.007 367.4 215.58 484.433 215.58 592.842c0 74.483 24.792 124.066 51.065 176.586 27.89 55.781 56.724 113.476 56.724 200.677h-53.894c0-74.482-24.792-124.065-51.066-176.586-27.89-55.78-56.724-113.475-56.724-200.677 0-90.866 42.227-197.686 93.454-274.486a803.76 803.76 0 0 1-39.047-34.115c-38.238-36.487-65.86-62.841-91.055-99.625-24.441-35.759-22.798-78.686 4.069-106.819 26.3-27.567 70.898-31.043 106.523-9 37.942 23.444 65.563 49.798 103.774 86.258 9.97 9.513 33.038 32.31 56.94 60.55h68.635c-27.621-37.78-60.416-72.73-88.522-99.543-28.834-27.54-54.73-52.116-84.534-74.024L326.306.296c31.232 23.23 57.802 48.533 87.31 76.72 53.84 51.388 94.45 100.594 121.747 146.836 82.837 26.65 150.043 116.87 165.026 230.75l1.725 13.177-9.405 9.405a820.165 820.165 0 0 1-11.803 11.587c156.322 72.408 181.41 174.727 181.41 232.125zm-552.852 33.63c3.934 8.058 7.895 16.088 11.991 24.145 27.433 54.3 55.808 110.457 55.808 191.434h53.895c0-93.696-34.062-161.226-61.52-215.579h-60.174zm597.908 53.895c-3.423 9.405-7.815 19.806-13.77 31.96L829.79 970.105h60.066l52.143-105.957c10.78-21.935 17.516-40.017 21.908-55.727h-56.535zM514.695 390.737c0-34.223-13.231-44.463-29.642-44.463s-29.642 10.24-29.642 44.463c0 34.25 13.23 44.463 29.642 44.463s29.642-10.213 29.642-44.463z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-rat"><path d="M727.66 431.158c-132.581 0-220.349 47.454-285.804 154.354-19.78 32.31-15.845 76.504-9.405 96.58a100.268 100.268 0 0 0 12.423 25.546c19.887 29.373 55.054 46.888 94.073 46.888h66.83c1.159 17.893-1.967 34.762-15.145 53.976-12.692 18.54-37.807 40.151-56.32 54.81 25.25-.673 52.71-.996 83.24-.996 259.935 0 352.553-150.393 352.553-291.14C936.421 512 882.365 431.158 727.66 431.158z" fill="#85C3DE" /><path d="m210.432 1012.898-43.574-31.69C273.812 834.156 352.175 810.01 590.686 808.502c21.397-31.26 16.25-56.266 9.378-89.708-3.557-17.138-7.222-34.843-7.222-54.434 0-68.958 25.33-104.636 63.407-136.973l34.897 41.04c-29.453 25.062-44.41 46.781-44.41 95.933 0 14.094 2.938 28.403 6.064 43.547 5.901 28.51 12.8 62.033-1.132 99.463 166.373-10.24 264.543-96.903 264.543-236.194 0-152.845-88.63-247.808-231.29-247.808-83.644 0-153.303 29.696-174.188 39.613a224.876 224.876 0 0 1-20.533 31.34l-41.742-34.116 20.884 17.058-20.91-16.977c.35-.458 36.62-45.999 36.62-97.55 0-34.815-8.946-60.765-26.57-77.069-17.515-16.249-44.786-24.603-81.219-24.953v162.654h-53.895V109.784l24.873-1.914c64.7-4.931 114.095 7.896 146.863 38.239 29.103 26.947 43.843 66.182 43.843 116.628 0 11.102-1.131 21.908-3.072 32.202 37.269-12.584 89.843-25.465 149.046-25.465 173.245 0 285.184 118.433 285.184 301.702 0 140.747-92.618 291.14-352.552 291.14-258.668 0-311.943 19.698-407.121 150.582zm19.106-256.836c-12.046 0-24.388-.566-37.026-1.643l-22.097-1.86-2.425-22.016c-.243-2.398-6.306-58.098-6.306-99.516 0-103.586 21.45-178.904 53.895-259.046V107.79h53.895v274.783l-2.021 4.904c-32.014 78.282-51.874 146.324-51.874 243.55 0 22.879 2.102 51.443 3.826 70.98 99.679 2.802 172.814-35.409 222.451-116.494l48.02 24.091c-11.237 28.133-11.372 51.578-.377 67.854 9.701 14.282 28.645 23.175 49.448 23.175v53.894c-39.02 0-74.186-17.515-94.073-46.888a100.244 100.244 0 0 1-12.423-25.546c-53.22 49.179-121.128 73.943-202.913 73.97zm150.42-230.588c0-34.223-13.231-44.463-29.642-44.463s-29.642 10.24-29.642 44.463c0 34.25 13.23 44.463 29.642 44.463s29.642-10.213 29.642-44.463z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-rooster"><path d="M891.688 506.422c-14.443-51.389-29.372-104.529-29.372-183.054V116.224L538.947 311.97v11.398c0 78.525 14.93 131.665 29.373 183.054 12.611 44.894 24.522 87.282 24.522 140.315 0 101.618-77.932 176.694-168.286 203.991l5.416 11.588h215.58c24.333 0 43.384-.243 58.556-2.13 107.412-13.365 212.103-95.635 212.103-213.45 0-53.032-11.911-95.42-24.523-140.314z" fill="#FF8787" /><path d="M673.684 354.358c-16.384 0-29.642-10.213-29.642-44.463 0-34.223 13.231-44.463 29.642-44.463s29.642 10.24 29.642 44.463c0 34.25-13.258 44.463-29.642 44.463zM540.106 970.105l-50.58-107.79h156.052l50.607 107.79h59.554l-51.604-109.918C811.52 846.82 916.21 764.55 916.21 646.737c0-53.033-11.911-95.42-24.523-140.315-14.443-51.389-29.372-104.529-29.372-183.054V107.79C862.316 48.344 813.972 0 754.526 0a107.924 107.924 0 0 0-107.79 106.173 100.89 100.89 0 0 0-24.117-3.315 88.71 88.71 0 0 0-88.603 88.603c0 20.669 5.228 39.72 10.671 53.922l-99.49 59.688 93.75 14.47v57.722c0 14.417-5.901 21.693-33.36 49.152l-11.13 11.13C398.228 326.52 324.985 269.473 215.741 269.473 96.768 269.474 0 366.242 0 485.214v161.523h53.895V485.214A162.008 162.008 0 0 1 215.74 323.368c82.081 0 140.422 36.245 240.64 152.253l-38.616 38.616c-49.96-52.952-94.666-83.08-158.181-83.08a151.983 151.983 0 0 0-151.795 151.795v171.574h53.895V582.952a98.008 98.008 0 0 1 97.9-97.9c46.323 0 79.63 20.912 137.027 86.017l18.971 21.53 128.081-128.08c28.537-28.538 49.18-49.152 49.18-87.256v-97.927l23.309-14.12-13.663-23.04c-.161-.243-14.578-24.9-14.578-50.688 0-19.133 15.575-34.708 34.708-34.708 5.093 0 26.786 3.18 39.559 18.647l26.327 46.026 39.775-24.09-20.373-49.368c-3.152-7.545-7.275-30.478-7.275-40.206 0-29.722 24.171-53.894 53.894-53.894s53.895 24.172 53.895 53.894v215.58c0 85.935 16.68 145.3 31.367 197.631 12.1 43.008 22.528 80.142 22.528 125.737 0 95.286-99.41 161.684-188.632 161.684H464.222l-68.42-145.704c-20.56-43.763-57.693-69.875-99.354-69.875a80.977 80.977 0 0 0-80.87 80.87v188.604h53.896V673.71c0-14.875 12.1-26.974 26.974-26.974 20.534 0 38.966 14.147 50.553 38.858l133.578 284.51h59.527z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-snake"><path d="M107.79 790.474c0-72.434 67.88-91.513 121.451-91.513 74.402 0 153.816 34.439 237.892 70.925 50.58 21.935 104.61 45.326 162.25 63.084-52.413 44.787-118.784 74.348-195.153 83.079-143.171 16.357-326.44 7.006-326.44-125.575zM377.262 215.58c-15.575 0-30.289 3.45-43.655 9.378a250.691 250.691 0 0 0-10.24 71.464c0 115.55 76.423 169.391 137.836 212.615 8.138 5.713 16.142 11.372 23.849 17.057V323.368a107.79 107.79 0 0 0-107.79-107.79z" fill="#C3D686" /><path d="M671.528 788.857c44.329 11.965 89.627 19.564 136.893 19.564 89.169 0 161.684-60.443 161.684-134.737S897.59 538.947 808.421 538.947c-19.079 0-37.026 1.51-54.218 4.016-.755-101.403-38.211-172.356-79.414-219.648l-1.105.053a1749.962 1749.962 0 0 1-79.036-1.751c45.702 35.867 108.705 107.87 105.984 232.367 0 .431-.081.808-.108 1.24-34.924 10.994-66.156 26.731-95.097 45.19a163.085 163.085 0 0 0-15.846-42.388c-21.557-39.64-60.065-66.775-97.36-93.022C433.098 423.344 377.263 384 377.263 296.42c0-130.29 108.275-188.632 215.58-188.632 64.134 0 132.715 12.046 214.365 37.808-4.877 34.654-27.109 63.784-106.576 69.039v-52.952h-53.895v53.68c-63.273-1.025-104.529-5.201-104.987-5.255l-5.578 53.598c2.236.242 56.185 5.767 137.512 5.767 125.17 0 188.632-48.128 188.632-143.064v-19.429l-18.432-6.144c-96.095-32.013-175.859-46.942-251.042-46.942-158.666 0-269.474 99.732-269.474 242.526 0 115.55 76.423 169.391 137.836 212.615 33.684 23.713 65.51 46.107 81.004 74.698 9.54 17.543 13.285 33.415 12.342 47.75 21.154 9.109 42.119 17.84 62.949 25.978 53.652-37.268 112.478-64.62 190.922-64.62 59.446 0 107.79 36.271 107.79 80.842s-48.344 80.842-107.79 80.842c-105.472 0-203.237-42.388-297.768-83.429-94.801-41.094-184.347-79.953-281.412-79.953-106.523.027-175.346 53.572-175.346 136.435 0 79.064 67.099 136.434 159.555 136.434 142.174 0 230.427-66.883 306.796-129.886 31.42 13.42 62.787 26.058 94.45 37.134-47.077 49.637-110.969 82.566-186.61 91.27l5.066 53.626c93.453-7.007 143.144 9.35 195.719 26.543 46.457 15.225 94.127 30.855 169.822 30.855 19.995 0 41.957-1.078 66.344-3.558l-5.416-53.625c-105.283 10.78-158.1-6.548-213.935-24.872-22.15-7.276-44.625-14.633-70.306-20.345a334.848 334.848 0 0 0 96.148-82.298zM213.45 810.12c-50.877 0-105.66-25.843-105.66-82.54 0-60.847 62.733-82.54 121.451-82.54 77.851 0 154.732 30.289 235.25 64.943-66.263 52.925-139.721 100.137-251.04 100.137z" fill="currentColor" /></symbol><symbol viewBox="0 0 1024 1024"  id="icon-zodiac-tiger"><path d="M431.158 162.25v-27.513c0-41.553-39.29-80.842-80.842-80.842-28.834 0-57.129 4.662-58.314 4.85l-22.528 3.746v83.887C144.788 223.825 89.223 346.84 66.99 431.158h266.052c240.747 0 415.851 107.79 415.851 269.474-14.848-25.115-43.924-53.895-88.683-53.895-67.989 0-121.264 71.033-121.264 161.684 0 66.803 30.478 119.889 60.713 156.16 12.638 15.171 36.055 37.726 59.015 58.88 5.066.108 9.781.539 15.01.539C892.981 1024 1024 832.189 1024 646.737c0-319.192-344.145-473.924-592.842-484.487z" fill="#F7C768" /><path d="M673.684 1024c-114.769 0-188.82-33.334-254.167-62.787-53.626-24.145-99.975-45.002-161.28-45.002-40.448 0-83.591 23.255-103.64 45.163l-39.747-36.433c27.648-30.154 84.318-62.625 143.387-62.625 68.392 0 119.862 21.288 172.92 45.056V673.684c0-35.166-17.542-64.108-30.638-80.815-15.199 9.836-32.068 18.89-50.742 26.947l-21.342-49.475C469.8 509.413 485.053 377.317 485.053 323.368V221.642a597.827 597.827 0 0 0-80.842-6.063h-26.948v-80.842c0-12.1-14.848-26.948-26.947-26.948-9.378 0-18.836.593-26.948 1.348v160.337h-53.894v-57.802c-136.03 102.912-158.45 266.886-161.307 295.882 9.135 9.108 38.993 25.06 71.976 38.67l38.104-59.366 12.45-1.59c90.516-11.614 146.566-93.076 146.566-161.9h53.895c0 88.334-68.797 192.243-180.87 213.343l-48.398 75.398-20.292-7.437C53.895 557.757 53.895 523.318 53.895 512c0-50.041 37.025-254.733 215.579-365.622V62.491l22.528-3.746c1.185-.188 29.48-4.85 58.314-4.85 41.553 0 80.842 39.289 80.842 80.842v27.513C679.855 172.813 1024 327.545 1024 646.737 1024 832.189 892.982 1024 673.684 1024zm-13.473-323.368c-36.514 0-67.369 49.367-67.369 107.79 0 85.746 68.096 145.084 89.465 161.549 91.54-2.534 164.38-45.488 213.828-107.655H700.632V808.42H930.87c8.92-17.273 16.357-35.355 22.285-53.895H713.27l-6.467-17.65c-.512-1.294-14.363-36.244-46.592-36.244zm-175.158 230.48c33.926 14.067 70.52 26.597 114.607 33.47-30.235-36.272-60.713-89.358-60.713-156.16 0-90.652 53.275-161.685 121.264-161.685 44.76 0 73.835 28.78 88.683 53.895h217.007c2.776-17.867 4.204-35.921 4.204-53.895 0-38.94-5.659-74.752-15.926-107.628L827.473 665.79l-38.104-38.104 142.633-142.632a367.94 367.94 0 0 0-57.775-81.597L719.683 557.999l-38.103-38.103 153.573-153.573a537.87 537.87 0 0 0-82.594-56.752L611.894 450.21l-38.104-38.104 128.135-128.135a794.732 794.732 0 0 0-162.978-52.924v92.321c0 50.15-11.102 156.7-95.932 236.329 18.378 23.417 42.038 63.407 42.038 113.987v257.428zM215.579 431.158v-53.895c39.774 0 53.895-29.022 53.895-53.895h53.894c0 53.572-37.025 107.79-107.79 107.79z" fill="currentColor" /></symbol>',t.insertBefore(e,t.lastChild)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s()}const Do=()=>{var s;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test((s=globalThis.navigator)==null?void 0:s.userAgent)},ko={..._i,Layout:()=>{var i;const{frontmatter:s,isDark:t,site:e}=Fs();return Vr(()=>{zo(),Do()||No(t.value)}).catch(r=>console.error(r)),we(_i.Layout,{class:(i=s.value)==null?void 0:i.layoutClass})},enhanceApp(s){s.app.component("svg-icon",Fo)}},zo=()=>{if(!globalThis.document)return;document.querySelectorAll("p > img").forEach(t=>{const e=t.parentElement;if(!e)return;let i=e;e.childNodes.length>1&&(i=document.createElement("div"),e.appendChild(i));const r=we(pa,{src:t.getAttribute("src")});t.remove(),Ds(r,i)})},No=s=>{globalThis.document&&Ds(we(Ro,{isDark:s}),document.body)};function Mr(s){if(s.extends){const t=Mr(s.extends);return{...t,...s,async enhanceApp(e){t.enhanceApp&&await t.enhanceApp(e),s.enhanceApp&&await s.enhanceApp(e)}}}return s}const Nt=Mr(ko),Oo=ie({name:"VitePressApp",setup(){const{site:s}=Fs();return Es(()=>{Ke(()=>{document.documentElement.lang=s.value.lang,document.documentElement.dir=s.value.dir})}),jr(),Yr(),Xr(),Nt.setup&&Nt.setup(),()=>we(Nt.Layout)}});async function Uo(){const s=Yo(),t=jo();t.provide(Lr,s);const e=Er(s.route);return t.provide(Ar,e),t.component("Content",Fr),t.component("ClientOnly",Dr),Object.defineProperties(t.config.globalProperties,{$frontmatter:{get(){return e.frontmatter.value}},$params:{get(){return e.page.value.params}}}),Nt.enhanceApp&&await Nt.enhanceApp({app:t,router:s,siteData:kr}),{app:t,router:s,data:e}}function jo(){return zr(Oo)}function Yo(){let s=Xe,t;return Nr(e=>{let i=Or(e);return s&&(t=i),(s||t===i)&&(i=i.replace(/\.js$/,".lean.js")),Xe&&(s=!1),Ur(()=>import(i),[])},Nt.NotFound)}Xe&&Uo().then(({app:s,router:t,data:e})=>{t.go().then(()=>{Rr(t.route,e.site),s.mount("#app")})});export{Uo as createApp};
